<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Github User Fetcher: duk_js_call.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Github User Fetcher<span id="projectnumber">&#160;1.0.0</span>
   </div>
   <div id="projectbrief">C/C++ Application with Server and GUI</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('duktape-1_85_82_2src-separate_2duk__js__call_8c.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">duk_js_call.c File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="duktape-1_85_82_2src-separate_2duk__internal_8h_source.html">duk_internal.h</a>&quot;</code><br />
</div>
<p><a href="duktape-1_85_82_2src-separate_2duk__js__call_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a6f05358775a8df038c9b0850c9e3f8a9" id="r_a6f05358775a8df038c9b0850c9e3f8a9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a245b431abb36cac1ac8d0eae054ed5c1">DUK_LOCAL</a> void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6f05358775a8df038c9b0850c9e3f8a9">duk__handle_call_inner</a> (<a class="el" href="structduk__hthread.html">duk_hthread</a> *thr, <a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a3e3bb369382aab50155c1d18bdf73923">duk_idx_t</a> num_stack_args, <a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a2b7ba45bf826058a9b7720b5e258efc6">duk_small_uint_t</a> call_flags, <a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a3e3bb369382aab50155c1d18bdf73923">duk_idx_t</a> idx_func)</td></tr>
<tr class="separator:a6f05358775a8df038c9b0850c9e3f8a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a728ed96bb1fd8bfc94187cd3cb49c369" id="r_a728ed96bb1fd8bfc94187cd3cb49c369"><td class="memItemLeft" align="right" valign="top"><a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a245b431abb36cac1ac8d0eae054ed5c1">DUK_LOCAL</a> void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a728ed96bb1fd8bfc94187cd3cb49c369">duk__handle_call_error</a> (<a class="el" href="structduk__hthread.html">duk_hthread</a> *thr, <a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#ab0a71934d59f38f195fea2f353032392">duk_size_t</a> entry_valstack_bottom_index, <a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#ab0a71934d59f38f195fea2f353032392">duk_size_t</a> entry_valstack_end, <a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#ab0a71934d59f38f195fea2f353032392">duk_size_t</a> entry_catchstack_top, <a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#ab0a71934d59f38f195fea2f353032392">duk_size_t</a> entry_callstack_top, <a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a9dbc0fdd27e7326d21cbf56e6d40d8a5">duk_int_t</a> entry_call_recursion_depth, <a class="el" href="structduk__hthread.html">duk_hthread</a> *entry_curr_thread, <a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a7ce35d12b12e3eea5f8d46c6195650d1">duk_uint_fast8_t</a> entry_thread_state, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a9231b6cd154afc387b6282e9bb8e0c6e">duk_instr_t</a> **entry_ptr_curr_pc, <a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a3e3bb369382aab50155c1d18bdf73923">duk_idx_t</a> idx_func, <a class="el" href="structduk__jmpbuf.html">duk_jmpbuf</a> *old_jmpbuf_ptr)</td></tr>
<tr class="separator:a728ed96bb1fd8bfc94187cd3cb49c369"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad89d6a1dfcd3eeaa30276a032d922f93" id="r_ad89d6a1dfcd3eeaa30276a032d922f93"><td class="memItemLeft" align="right" valign="top"><a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a245b431abb36cac1ac8d0eae054ed5c1">DUK_LOCAL</a> void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad89d6a1dfcd3eeaa30276a032d922f93">duk__handle_safe_call_inner</a> (<a class="el" href="structduk__hthread.html">duk_hthread</a> *thr, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8h.html#af73ef474ce4eaa5f69994410c81c33db">duk_safe_call_function</a> func, <a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a3e3bb369382aab50155c1d18bdf73923">duk_idx_t</a> idx_retbase, <a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a3e3bb369382aab50155c1d18bdf73923">duk_idx_t</a> num_stack_rets, <a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#ab0a71934d59f38f195fea2f353032392">duk_size_t</a> entry_valstack_bottom_index, <a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#ab0a71934d59f38f195fea2f353032392">duk_size_t</a> entry_callstack_top, <a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#ab0a71934d59f38f195fea2f353032392">duk_size_t</a> entry_catchstack_top)</td></tr>
<tr class="separator:ad89d6a1dfcd3eeaa30276a032d922f93"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a64be23b7667a71988e004d51b0bc692f" id="r_a64be23b7667a71988e004d51b0bc692f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a245b431abb36cac1ac8d0eae054ed5c1">DUK_LOCAL</a> void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a64be23b7667a71988e004d51b0bc692f">duk__handle_safe_call_error</a> (<a class="el" href="structduk__hthread.html">duk_hthread</a> *thr, <a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a3e3bb369382aab50155c1d18bdf73923">duk_idx_t</a> idx_retbase, <a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a3e3bb369382aab50155c1d18bdf73923">duk_idx_t</a> num_stack_rets, <a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#ab0a71934d59f38f195fea2f353032392">duk_size_t</a> entry_valstack_bottom_index, <a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#ab0a71934d59f38f195fea2f353032392">duk_size_t</a> entry_callstack_top, <a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#ab0a71934d59f38f195fea2f353032392">duk_size_t</a> entry_catchstack_top, <a class="el" href="structduk__jmpbuf.html">duk_jmpbuf</a> *old_jmpbuf_ptr)</td></tr>
<tr class="separator:a64be23b7667a71988e004d51b0bc692f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a76056ac76a6e7dee82dbff39c88a3213" id="r_a76056ac76a6e7dee82dbff39c88a3213"><td class="memItemLeft" align="right" valign="top"><a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a245b431abb36cac1ac8d0eae054ed5c1">DUK_LOCAL</a> void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a76056ac76a6e7dee82dbff39c88a3213">duk__handle_safe_call_shared</a> (<a class="el" href="structduk__hthread.html">duk_hthread</a> *thr, <a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a3e3bb369382aab50155c1d18bdf73923">duk_idx_t</a> idx_retbase, <a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a3e3bb369382aab50155c1d18bdf73923">duk_idx_t</a> num_stack_rets, <a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a9dbc0fdd27e7326d21cbf56e6d40d8a5">duk_int_t</a> entry_call_recursion_depth, <a class="el" href="structduk__hthread.html">duk_hthread</a> *entry_curr_thread, <a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a7ce35d12b12e3eea5f8d46c6195650d1">duk_uint_fast8_t</a> entry_thread_state, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a9231b6cd154afc387b6282e9bb8e0c6e">duk_instr_t</a> **entry_ptr_curr_pc)</td></tr>
<tr class="separator:a76056ac76a6e7dee82dbff39c88a3213"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e907083e0c0fef469fbf2c811353d71" id="r_a0e907083e0c0fef469fbf2c811353d71"><td class="memItemLeft" align="right" valign="top"><a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a245b431abb36cac1ac8d0eae054ed5c1">DUK_LOCAL</a> void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0e907083e0c0fef469fbf2c811353d71">duk__create_arguments_object</a> (<a class="el" href="structduk__hthread.html">duk_hthread</a> *thr, <a class="el" href="structduk__hobject.html">duk_hobject</a> *func, <a class="el" href="structduk__hobject.html">duk_hobject</a> *varenv, <a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a3e3bb369382aab50155c1d18bdf73923">duk_idx_t</a> idx_argbase, <a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a3e3bb369382aab50155c1d18bdf73923">duk_idx_t</a> num_stack_args)</td></tr>
<tr class="separator:a0e907083e0c0fef469fbf2c811353d71"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a988107c9c80890ed0641244b749a1969" id="r_a988107c9c80890ed0641244b749a1969"><td class="memItemLeft" align="right" valign="top"><a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a245b431abb36cac1ac8d0eae054ed5c1">DUK_LOCAL</a> void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a988107c9c80890ed0641244b749a1969">duk__handle_createargs_for_call</a> (<a class="el" href="structduk__hthread.html">duk_hthread</a> *thr, <a class="el" href="structduk__hobject.html">duk_hobject</a> *func, <a class="el" href="structduk__hobject.html">duk_hobject</a> *env, <a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a3e3bb369382aab50155c1d18bdf73923">duk_idx_t</a> num_stack_args)</td></tr>
<tr class="separator:a988107c9c80890ed0641244b749a1969"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a115e6a9a6b1b429b9b2df7e546ba8d9c" id="r_a115e6a9a6b1b429b9b2df7e546ba8d9c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a245b431abb36cac1ac8d0eae054ed5c1">DUK_LOCAL</a> void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a115e6a9a6b1b429b9b2df7e546ba8d9c">duk__handle_bound_chain_for_call</a> (<a class="el" href="structduk__hthread.html">duk_hthread</a> *thr, <a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a3e3bb369382aab50155c1d18bdf73923">duk_idx_t</a> idx_func, <a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a3e3bb369382aab50155c1d18bdf73923">duk_idx_t</a> *p_num_stack_args, <a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#af32ca4c30431e819676401ce2b11c2e7">duk_bool_t</a> is_constructor_call)</td></tr>
<tr class="separator:a115e6a9a6b1b429b9b2df7e546ba8d9c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a208a38260dcc44fddbc4658759b71f08" id="r_a208a38260dcc44fddbc4658759b71f08"><td class="memItemLeft" align="right" valign="top"><a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a245b431abb36cac1ac8d0eae054ed5c1">DUK_LOCAL</a> void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a208a38260dcc44fddbc4658759b71f08">duk__handle_oldenv_for_call</a> (<a class="el" href="structduk__hthread.html">duk_hthread</a> *thr, <a class="el" href="structduk__hobject.html">duk_hobject</a> *func, <a class="el" href="structduk__activation.html">duk_activation</a> *act)</td></tr>
<tr class="separator:a208a38260dcc44fddbc4658759b71f08"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a08825b479944b1b525fe432f83bbe57e" id="r_a08825b479944b1b525fe432f83bbe57e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a245b431abb36cac1ac8d0eae054ed5c1">DUK_LOCAL</a> void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a08825b479944b1b525fe432f83bbe57e">duk__coerce_effective_this_binding</a> (<a class="el" href="structduk__hthread.html">duk_hthread</a> *thr, <a class="el" href="structduk__hobject.html">duk_hobject</a> *func, <a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a3e3bb369382aab50155c1d18bdf73923">duk_idx_t</a> idx_this)</td></tr>
<tr class="separator:a08825b479944b1b525fe432f83bbe57e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0d5042617a44a3204d4839319683aeb2" id="r_a0d5042617a44a3204d4839319683aeb2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a245b431abb36cac1ac8d0eae054ed5c1">DUK_LOCAL</a> <a class="el" href="structduk__hobject.html">duk_hobject</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0d5042617a44a3204d4839319683aeb2">duk__nonbound_func_lookup</a> (<a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#aedf99a449ea72d41f16606f6c8ced70d">duk_context</a> *ctx, <a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a3e3bb369382aab50155c1d18bdf73923">duk_idx_t</a> idx_func, <a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a3e3bb369382aab50155c1d18bdf73923">duk_idx_t</a> *out_num_stack_args, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a9ad3133ae87f4653a6e6183262a5ca3c">duk_tval</a> **out_tv_func, <a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a2b7ba45bf826058a9b7720b5e258efc6">duk_small_uint_t</a> call_flags)</td></tr>
<tr class="separator:a0d5042617a44a3204d4839319683aeb2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a24504a6bbcf7c2ac1bbcf078f0313652" id="r_a24504a6bbcf7c2ac1bbcf078f0313652"><td class="memItemLeft" align="right" valign="top"><a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a245b431abb36cac1ac8d0eae054ed5c1">DUK_LOCAL</a> void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a24504a6bbcf7c2ac1bbcf078f0313652">duk__adjust_valstack_and_top</a> (<a class="el" href="structduk__hthread.html">duk_hthread</a> *thr, <a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a3e3bb369382aab50155c1d18bdf73923">duk_idx_t</a> num_stack_args, <a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a3e3bb369382aab50155c1d18bdf73923">duk_idx_t</a> idx_args, <a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a3e3bb369382aab50155c1d18bdf73923">duk_idx_t</a> nregs, <a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a3e3bb369382aab50155c1d18bdf73923">duk_idx_t</a> nargs, <a class="el" href="structduk__hobject.html">duk_hobject</a> *func)</td></tr>
<tr class="separator:a24504a6bbcf7c2ac1bbcf078f0313652"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a5f9e173b495524116abe7aa167026a" id="r_a0a5f9e173b495524116abe7aa167026a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a245b431abb36cac1ac8d0eae054ed5c1">DUK_LOCAL</a> void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0a5f9e173b495524116abe7aa167026a">duk__safe_call_adjust_valstack</a> (<a class="el" href="structduk__hthread.html">duk_hthread</a> *thr, <a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a3e3bb369382aab50155c1d18bdf73923">duk_idx_t</a> idx_retbase, <a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a3e3bb369382aab50155c1d18bdf73923">duk_idx_t</a> num_stack_rets, <a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a3e3bb369382aab50155c1d18bdf73923">duk_idx_t</a> num_actual_rets)</td></tr>
<tr class="separator:a0a5f9e173b495524116abe7aa167026a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ee6d00b24673db60bd1f2df3700c1e2" id="r_a0ee6d00b24673db60bd1f2df3700c1e2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a245b431abb36cac1ac8d0eae054ed5c1">DUK_LOCAL</a> <a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a3e3bb369382aab50155c1d18bdf73923">duk_idx_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0ee6d00b24673db60bd1f2df3700c1e2">duk__get_idx_func</a> (<a class="el" href="structduk__hthread.html">duk_hthread</a> *thr, <a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a3e3bb369382aab50155c1d18bdf73923">duk_idx_t</a> num_stack_args)</td></tr>
<tr class="separator:a0ee6d00b24673db60bd1f2df3700c1e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac11145b57956e2a80e4d3a816487ecdc" id="r_ac11145b57956e2a80e4d3a816487ecdc"><td class="memItemLeft" align="right" valign="top"><a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a19032f251b36af6bfb17f4450b829521">DUK_INTERNAL</a> <a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a9dbc0fdd27e7326d21cbf56e6d40d8a5">duk_int_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac11145b57956e2a80e4d3a816487ecdc">duk_handle_call_protected</a> (<a class="el" href="structduk__hthread.html">duk_hthread</a> *thr, <a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a3e3bb369382aab50155c1d18bdf73923">duk_idx_t</a> num_stack_args, <a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a2b7ba45bf826058a9b7720b5e258efc6">duk_small_uint_t</a> call_flags)</td></tr>
<tr class="separator:ac11145b57956e2a80e4d3a816487ecdc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a828d82423579a3d373d2154002fee4f2" id="r_a828d82423579a3d373d2154002fee4f2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a19032f251b36af6bfb17f4450b829521">DUK_INTERNAL</a> void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a828d82423579a3d373d2154002fee4f2">duk_handle_call_unprotected</a> (<a class="el" href="structduk__hthread.html">duk_hthread</a> *thr, <a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a3e3bb369382aab50155c1d18bdf73923">duk_idx_t</a> num_stack_args, <a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a2b7ba45bf826058a9b7720b5e258efc6">duk_small_uint_t</a> call_flags)</td></tr>
<tr class="separator:a828d82423579a3d373d2154002fee4f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a242a34ede062c530655f09f768b456b6" id="r_a242a34ede062c530655f09f768b456b6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a19032f251b36af6bfb17f4450b829521">DUK_INTERNAL</a> <a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a9dbc0fdd27e7326d21cbf56e6d40d8a5">duk_int_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a242a34ede062c530655f09f768b456b6">duk_handle_safe_call</a> (<a class="el" href="structduk__hthread.html">duk_hthread</a> *thr, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8h.html#af73ef474ce4eaa5f69994410c81c33db">duk_safe_call_function</a> func, <a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a3e3bb369382aab50155c1d18bdf73923">duk_idx_t</a> num_stack_args, <a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a3e3bb369382aab50155c1d18bdf73923">duk_idx_t</a> num_stack_rets)</td></tr>
<tr class="separator:a242a34ede062c530655f09f768b456b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec1da61a0d8f9fed5d5e08e0e950f69b" id="r_aec1da61a0d8f9fed5d5e08e0e950f69b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a19032f251b36af6bfb17f4450b829521">DUK_INTERNAL</a> <a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#af32ca4c30431e819676401ce2b11c2e7">duk_bool_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aec1da61a0d8f9fed5d5e08e0e950f69b">duk_handle_ecma_call_setup</a> (<a class="el" href="structduk__hthread.html">duk_hthread</a> *thr, <a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a3e3bb369382aab50155c1d18bdf73923">duk_idx_t</a> num_stack_args, <a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a2b7ba45bf826058a9b7720b5e258efc6">duk_small_uint_t</a> call_flags)</td></tr>
<tr class="separator:aec1da61a0d8f9fed5d5e08e0e950f69b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a24504a6bbcf7c2ac1bbcf078f0313652" name="a24504a6bbcf7c2ac1bbcf078f0313652"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a24504a6bbcf7c2ac1bbcf078f0313652">&#9670;&#160;</a></span>duk__adjust_valstack_and_top()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a245b431abb36cac1ac8d0eae054ed5c1">DUK_LOCAL</a> void duk__adjust_valstack_and_top </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structduk__hthread.html">duk_hthread</a> *</td>          <td class="paramname"><span class="paramname"><em>thr</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a3e3bb369382aab50155c1d18bdf73923">duk_idx_t</a></td>          <td class="paramname"><span class="paramname"><em>num_stack_args</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a3e3bb369382aab50155c1d18bdf73923">duk_idx_t</a></td>          <td class="paramname"><span class="paramname"><em>idx_args</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a3e3bb369382aab50155c1d18bdf73923">duk_idx_t</a></td>          <td class="paramname"><span class="paramname"><em>nregs</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a3e3bb369382aab50155c1d18bdf73923">duk_idx_t</a></td>          <td class="paramname"><span class="paramname"><em>nargs</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structduk__hobject.html">duk_hobject</a> *</td>          <td class="paramname"><span class="paramname"><em>func</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="duktape-1_85_82_2src-separate_2duk__js__call_8c_source.html#l00782">782</a> of file <a class="el" href="duktape-1_85_82_2src-separate_2duk__js__call_8c_source.html">duktape-1.5.2/src-separate/duk_js_call.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  787</span>                                                               {</div>
<div class="line"><span class="lineno">  788</span>    <a class="code hl_struct" href="structduk__hthread.html">duk_context</a> *ctx = (<a class="code hl_struct" href="structduk__hthread.html">duk_context</a> *) thr;</div>
<div class="line"><span class="lineno">  789</span>    <a class="code hl_typedef" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#ab0a71934d59f38f195fea2f353032392">duk_size_t</a> vs_min_size;</div>
<div class="line"><span class="lineno">  790</span>    <a class="code hl_typedef" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#af32ca4c30431e819676401ce2b11c2e7">duk_bool_t</a> adjusted_top = 0;</div>
<div class="line"><span class="lineno">  791</span> </div>
<div class="line"><span class="lineno">  792</span>    vs_min_size = (thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#ad39b6c03b81eb0f4d3eefda5083988d3">valstack_bottom</a> - thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#a08f58ff5b9fa5927891c2e08712e3971">valstack</a>) +  <span class="comment">/* bottom of current func */</span></div>
<div class="line"><span class="lineno">  793</span>                  idx_args;                                 <span class="comment">/* bottom of new func */</span></div>
<div class="line"><span class="lineno">  794</span> </div>
<div class="line"><span class="lineno">  795</span>    <span class="keywordflow">if</span> (nregs &gt;= 0) {</div>
<div class="line"><span class="lineno">  796</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(nargs &gt;= 0);</div>
<div class="line"><span class="lineno">  797</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(nregs &gt;= nargs);</div>
<div class="line"><span class="lineno">  798</span>        vs_min_size += nregs;</div>
<div class="line"><span class="lineno">  799</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  800</span>        <span class="comment">/* &#39;func&#39; wants stack &quot;as is&quot; */</span></div>
<div class="line"><span class="lineno">  801</span>        vs_min_size += num_stack_args;  <span class="comment">/* num entries of new func at entry */</span></div>
<div class="line"><span class="lineno">  802</span>    }</div>
<div class="line"><span class="lineno">  803</span>    <span class="keywordflow">if</span> (func == <a class="code hl_define" href="gmacros_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> || <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a70ce6873e608ce9399d8c7e2e45af92f">DUK_HOBJECT_IS_NATIVEFUNCTION</a>(func)) {</div>
<div class="line"><span class="lineno">  804</span>        vs_min_size += <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#abd5e035eeef01a44b7a5ade8a5f50402">DUK_VALSTACK_API_ENTRY_MINIMUM</a>;  <span class="comment">/* Duktape/C API guaranteed entries (on top of args) */</span></div>
<div class="line"><span class="lineno">  805</span>    }</div>
<div class="line"><span class="lineno">  806</span>    vs_min_size += <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#af923b1259313484abe41c4996c8b2dce">DUK_VALSTACK_INTERNAL_EXTRA</a>;             <span class="comment">/* + spare */</span></div>
<div class="line"><span class="lineno">  807</span> </div>
<div class="line"><span class="lineno">  808</span>    <span class="comment">/* XXX: We can&#39;t resize the value stack to a size smaller than the</span></div>
<div class="line"><span class="lineno">  809</span><span class="comment">     * current top, so the order of the resize and adjusting the stack</span></div>
<div class="line"><span class="lineno">  810</span><span class="comment">     * top depends on the current vs. final size of the value stack.</span></div>
<div class="line"><span class="lineno">  811</span><span class="comment">     * The operations could be combined to avoid this, but the proper</span></div>
<div class="line"><span class="lineno">  812</span><span class="comment">     * fix is to only grow the value stack on a function call, and only</span></div>
<div class="line"><span class="lineno">  813</span><span class="comment">     * shrink it (without throwing if the shrink fails) on function</span></div>
<div class="line"><span class="lineno">  814</span><span class="comment">     * return.</span></div>
<div class="line"><span class="lineno">  815</span><span class="comment">     */</span></div>
<div class="line"><span class="lineno">  816</span> </div>
<div class="line"><span class="lineno">  817</span>    <span class="keywordflow">if</span> (vs_min_size &lt; (<a class="code hl_typedef" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#ab0a71934d59f38f195fea2f353032392">duk_size_t</a>) (thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#aec793ffa71623d879a5849bee26687f2">valstack_top</a>  - thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#a08f58ff5b9fa5927891c2e08712e3971">valstack</a>)) {</div>
<div class="line"><span class="lineno">  818</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a2db20d2d3b36d8491ed171cf503488bb">DUK_DDD</a>(<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#aa6e5d41ceaba6832e5ede737f0a35fb9">DUK_DDDPRINT</a>((<span class="stringliteral">&quot;final size smaller, set top before resize&quot;</span>)));</div>
<div class="line"><span class="lineno">  819</span> </div>
<div class="line"><span class="lineno">  820</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(nregs &gt;= 0);  <span class="comment">/* can&#39;t happen when keeping current stack size */</span></div>
<div class="line"><span class="lineno">  821</span>        <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a808471cbdda897175b2e4d50528c430d">duk_set_top</a>(ctx, idx_args + nargs);  <span class="comment">/* clamp anything above nargs */</span></div>
<div class="line"><span class="lineno">  822</span>        <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a808471cbdda897175b2e4d50528c430d">duk_set_top</a>(ctx, idx_args + nregs);  <span class="comment">/* extend with undefined */</span></div>
<div class="line"><span class="lineno">  823</span>        adjusted_top = 1;</div>
<div class="line"><span class="lineno">  824</span>    }</div>
<div class="line"><span class="lineno">  825</span> </div>
<div class="line"><span class="lineno">  826</span>    (void) <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a77c10520e83828337093fb75217c8994">duk_valstack_resize_raw</a>((<a class="code hl_struct" href="structduk__hthread.html">duk_context</a> *) thr,</div>
<div class="line"><span class="lineno">  827</span>                                   vs_min_size,</div>
<div class="line"><span class="lineno">  828</span>                                   <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bb7e485dd3c5ecda5f3b08f5b0fd58">DUK_VSRESIZE_FLAG_SHRINK</a> |      <span class="comment">/* flags */</span></div>
<div class="line"><span class="lineno">  829</span>                                   0 <span class="comment">/* no compact */</span> |</div>
<div class="line"><span class="lineno">  830</span>                                   <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a207c421ba76ecb41b4ae7df1ef829112">DUK_VSRESIZE_FLAG_THROW</a>);</div>
<div class="line"><span class="lineno">  831</span> </div>
<div class="line"><span class="lineno">  832</span>    <span class="keywordflow">if</span> (!adjusted_top) {</div>
<div class="line"><span class="lineno">  833</span>        <span class="keywordflow">if</span> (nregs &gt;= 0) {</div>
<div class="line"><span class="lineno">  834</span>            <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(nregs &gt;= nargs);</div>
<div class="line"><span class="lineno">  835</span>            <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a808471cbdda897175b2e4d50528c430d">duk_set_top</a>(ctx, idx_args + nargs);  <span class="comment">/* clamp anything above nargs */</span></div>
<div class="line"><span class="lineno">  836</span>            <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a808471cbdda897175b2e4d50528c430d">duk_set_top</a>(ctx, idx_args + nregs);  <span class="comment">/* extend with undefined */</span></div>
<div class="line"><span class="lineno">  837</span>        }</div>
<div class="line"><span class="lineno">  838</span>    }</div>
<div class="line"><span class="lineno">  839</span>}</div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duk__config_8h_html_ab0a71934d59f38f195fea2f353032392"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duk__config_8h.html#ab0a71934d59f38f195fea2f353032392">duk_size_t</a></div><div class="ttdeci">size_t duk_size_t</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duk__config_8h_source.html#l01770">duktape-1.5.2/src-noline/duk_config.h:1770</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duk__config_8h_html_af32ca4c30431e819676401ce2b11c2e7"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duk__config_8h.html#af32ca4c30431e819676401ce2b11c2e7">duk_bool_t</a></div><div class="ttdeci">duk_small_int_t duk_bool_t</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duk__config_8h_source.html#l01825">duktape-1.5.2/src-noline/duk_config.h:1825</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_a207c421ba76ecb41b4ae7df1ef829112"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#a207c421ba76ecb41b4ae7df1ef829112">DUK_VSRESIZE_FLAG_THROW</a></div><div class="ttdeci">#define DUK_VSRESIZE_FLAG_THROW</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l04222">duktape-1.5.2/src-noline/duktape.c:4222</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_a2db20d2d3b36d8491ed171cf503488bb"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#a2db20d2d3b36d8491ed171cf503488bb">DUK_DDD</a></div><div class="ttdeci">#define DUK_DDD(x)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07497">duktape-1.5.2/src-noline/duktape.c:7497</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_a52bb7e485dd3c5ecda5f3b08f5b0fd58"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bb7e485dd3c5ecda5f3b08f5b0fd58">DUK_VSRESIZE_FLAG_SHRINK</a></div><div class="ttdeci">#define DUK_VSRESIZE_FLAG_SHRINK</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l04220">duktape-1.5.2/src-noline/duktape.c:4220</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_a52bc112231cf556000de414bca74c712"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a></div><div class="ttdeci">#define DUK_ASSERT(x)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07755">duktape-1.5.2/src-noline/duktape.c:7755</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_a70ce6873e608ce9399d8c7e2e45af92f"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#a70ce6873e608ce9399d8c7e2e45af92f">DUK_HOBJECT_IS_NATIVEFUNCTION</a></div><div class="ttdeci">#define DUK_HOBJECT_IS_NATIVEFUNCTION(h)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l04775">duktape-1.5.2/src-noline/duktape.c:4775</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_a77c10520e83828337093fb75217c8994"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#a77c10520e83828337093fb75217c8994">duk_valstack_resize_raw</a></div><div class="ttdeci">DUK_INTERNAL_DECL duk_bool_t duk_valstack_resize_raw(duk_context *ctx, duk_size_t min_new_size, duk_small_uint_t flags)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l15491">duktape-1.5.2/src-noline/duktape.c:15491</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_a808471cbdda897175b2e4d50528c430d"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#a808471cbdda897175b2e4d50528c430d">duk_set_top</a></div><div class="ttdeci">DUK_EXTERNAL void duk_set_top(duk_context *ctx, duk_idx_t index)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l15216">duktape-1.5.2/src-noline/duktape.c:15216</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_aa6e5d41ceaba6832e5ede737f0a35fb9"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#aa6e5d41ceaba6832e5ede737f0a35fb9">DUK_DDDPRINT</a></div><div class="ttdeci">#define DUK_DDDPRINT</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07509">duktape-1.5.2/src-noline/duktape.c:7509</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_abd5e035eeef01a44b7a5ade8a5f50402"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#abd5e035eeef01a44b7a5ade8a5f50402">DUK_VALSTACK_API_ENTRY_MINIMUM</a></div><div class="ttdeci">#define DUK_VALSTACK_API_ENTRY_MINIMUM</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l05959">duktape-1.5.2/src-noline/duktape.c:5959</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_af923b1259313484abe41c4996c8b2dce"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#af923b1259313484abe41c4996c8b2dce">DUK_VALSTACK_INTERNAL_EXTRA</a></div><div class="ttdeci">#define DUK_VALSTACK_INTERNAL_EXTRA</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l05958">duktape-1.5.2/src-noline/duktape.c:5958</a></div></div>
<div class="ttc" id="agmacros_8h_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="gmacros_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition</b> <a href="gmacros_8h_source.html#l00924">gmacros.h:924</a></div></div>
<div class="ttc" id="astructduk__hthread_html"><div class="ttname"><a href="structduk__hthread.html">duk_hthread</a></div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06190">duktape-1.5.2/src-noline/duktape.c:6190</a></div></div>
<div class="ttc" id="astructduk__hthread_html_a08f58ff5b9fa5927891c2e08712e3971"><div class="ttname"><a href="structduk__hthread.html#a08f58ff5b9fa5927891c2e08712e3971">duk_hthread::valstack</a></div><div class="ttdeci">duk_tval * valstack</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06226">duktape-1.5.2/src-noline/duktape.c:6226</a></div></div>
<div class="ttc" id="astructduk__hthread_html_ad39b6c03b81eb0f4d3eefda5083988d3"><div class="ttname"><a href="structduk__hthread.html#ad39b6c03b81eb0f4d3eefda5083988d3">duk_hthread::valstack_bottom</a></div><div class="ttdeci">duk_tval * valstack_bottom</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06228">duktape-1.5.2/src-noline/duktape.c:6228</a></div></div>
<div class="ttc" id="astructduk__hthread_html_aec793ffa71623d879a5849bee26687f2"><div class="ttname"><a href="structduk__hthread.html#aec793ffa71623d879a5849bee26687f2">duk_hthread::valstack_top</a></div><div class="ttdeci">duk_tval * valstack_top</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06229">duktape-1.5.2/src-noline/duktape.c:6229</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07755">DUK_ASSERT</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07497">DUK_DDD</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07509">DUK_DDDPRINT</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l04775">DUK_HOBJECT_IS_NATIVEFUNCTION</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l15216">duk_set_top()</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l05959">DUK_VALSTACK_API_ENTRY_MINIMUM</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l05958">DUK_VALSTACK_INTERNAL_EXTRA</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l15491">duk_valstack_resize_raw()</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l04220">DUK_VSRESIZE_FLAG_SHRINK</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l04222">DUK_VSRESIZE_FLAG_THROW</a>, <a class="el" href="gmacros_8h_source.html#l00924">NULL</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06226">duk_hthread::valstack</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06228">duk_hthread::valstack_bottom</a>, and <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06229">duk_hthread::valstack_top</a>.</p>

<p class="reference">Referenced by <a class="el" href="duktape-1_85_82_2src-separate_2duk__js__call_8c_source.html#l01158">duk__handle_call_inner()</a>, and <a class="el" href="duktape-1_85_82_2src-separate_2duk__js__call_8c_source.html#l02290">duk_handle_ecma_call_setup()</a>.</p>

</div>
</div>
<a id="a08825b479944b1b525fe432f83bbe57e" name="a08825b479944b1b525fe432f83bbe57e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a08825b479944b1b525fe432f83bbe57e">&#9670;&#160;</a></span>duk__coerce_effective_this_binding()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a245b431abb36cac1ac8d0eae054ed5c1">DUK_LOCAL</a> void duk__coerce_effective_this_binding </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structduk__hthread.html">duk_hthread</a> *</td>          <td class="paramname"><span class="paramname"><em>thr</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structduk__hobject.html">duk_hobject</a> *</td>          <td class="paramname"><span class="paramname"><em>func</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a3e3bb369382aab50155c1d18bdf73923">duk_idx_t</a></td>          <td class="paramname"><span class="paramname"><em>idx_this</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="duktape-1_85_82_2src-separate_2duk__js__call_8c_source.html#l00665">665</a> of file <a class="el" href="duktape-1_85_82_2src-separate_2duk__js__call_8c_source.html">duktape-1.5.2/src-separate/duk_js_call.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  667</span>                                                                      {</div>
<div class="line"><span class="lineno">  668</span>    <a class="code hl_struct" href="structduk__hthread.html">duk_context</a> *ctx = (<a class="code hl_struct" href="structduk__hthread.html">duk_context</a> *) thr;</div>
<div class="line"><span class="lineno">  669</span>    <a class="code hl_struct" href="structduk__tval__struct.html">duk_tval</a> *tv_this;</div>
<div class="line"><span class="lineno">  670</span>    <a class="code hl_struct" href="structduk__hobject.html">duk_hobject</a> *obj_global;</div>
<div class="line"><span class="lineno">  671</span> </div>
<div class="line"><span class="lineno">  672</span>    <span class="keywordflow">if</span> (func == <a class="code hl_define" href="gmacros_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> || <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#ae5226f867ccd5073adc2df9140389ecb">DUK_HOBJECT_HAS_STRICT</a>(func)) {</div>
<div class="line"><span class="lineno">  673</span>        <span class="comment">/* Lightfuncs are always considered strict. */</span></div>
<div class="line"><span class="lineno">  674</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a2db20d2d3b36d8491ed171cf503488bb">DUK_DDD</a>(<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#aa6e5d41ceaba6832e5ede737f0a35fb9">DUK_DDDPRINT</a>(<span class="stringliteral">&quot;this binding: strict -&gt; use directly&quot;</span>));</div>
<div class="line"><span class="lineno">  675</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  676</span>    }</div>
<div class="line"><span class="lineno">  677</span> </div>
<div class="line"><span class="lineno">  678</span>    <span class="comment">/* XXX: byte offset */</span></div>
<div class="line"><span class="lineno">  679</span>    tv_this = thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#ad39b6c03b81eb0f4d3eefda5083988d3">valstack_bottom</a> + idx_this;</div>
<div class="line"><span class="lineno">  680</span>    <span class="keywordflow">switch</span> (<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a51bb9f80806712cd8d73dcebb5e8d7b3">DUK_TVAL_GET_TAG</a>(tv_this)) {</div>
<div class="line"><span class="lineno">  681</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#aadbbb32aa10b98e1f373906d1cef0c57">DUK_TAG_OBJECT</a>:</div>
<div class="line"><span class="lineno">  682</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#afbc705d5de3fe9562cadf9c94bf30066">DUK_TAG_LIGHTFUNC</a>:  <span class="comment">/* lightfuncs are treated like objects and not coerced */</span></div>
<div class="line"><span class="lineno">  683</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a2db20d2d3b36d8491ed171cf503488bb">DUK_DDD</a>(<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#aa6e5d41ceaba6832e5ede737f0a35fb9">DUK_DDDPRINT</a>(<span class="stringliteral">&quot;this binding: non-strict, object -&gt; use directly&quot;</span>));</div>
<div class="line"><span class="lineno">  684</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  685</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#aa372dbdc4b97deff3bab22c5210a8d63">DUK_TAG_UNDEFINED</a>:</div>
<div class="line"><span class="lineno">  686</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a194c60e7c6796a265a150f8fcfb15c1f">DUK_TAG_NULL</a>:</div>
<div class="line"><span class="lineno">  687</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a2db20d2d3b36d8491ed171cf503488bb">DUK_DDD</a>(<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#aa6e5d41ceaba6832e5ede737f0a35fb9">DUK_DDDPRINT</a>(<span class="stringliteral">&quot;this binding: non-strict, undefined/null -&gt; use global object&quot;</span>));</div>
<div class="line"><span class="lineno">  688</span>        obj_global = thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#a2411e86e6389e09885c986c311430c76">builtins</a>[<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a76b26adb27e6c64e13dedde1252492a1">DUK_BIDX_GLOBAL</a>];</div>
<div class="line"><span class="lineno">  689</span>        <span class="comment">/* XXX: avoid this check somehow */</span></div>
<div class="line"><span class="lineno">  690</span>        <span class="keywordflow">if</span> (<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#aff85916aff22bb1c4a5b83e2008cdc30">DUK_LIKELY</a>(obj_global != <a class="code hl_define" href="gmacros_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)) {</div>
<div class="line"><span class="lineno">  691</span>            <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(!<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a9103714e7b378c01009baf55c69bf768">DUK_TVAL_IS_HEAP_ALLOCATED</a>(tv_this));  <span class="comment">/* no need to decref previous value */</span></div>
<div class="line"><span class="lineno">  692</span>            <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a2730ed3b8ede880f25dd33ebb2270d09">DUK_TVAL_SET_OBJECT</a>(tv_this, obj_global);</div>
<div class="line"><span class="lineno">  693</span>            <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#ac6b106695c0dfa435ade88972d1e46b8">DUK_HOBJECT_INCREF</a>(thr, obj_global);</div>
<div class="line"><span class="lineno">  694</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  695</span>            <span class="comment">/* This may only happen if built-ins are being &quot;torn down&quot;.</span></div>
<div class="line"><span class="lineno">  696</span><span class="comment">             * This behavior is out of specification scope.</span></div>
<div class="line"><span class="lineno">  697</span><span class="comment">             */</span></div>
<div class="line"><span class="lineno">  698</span>            <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a9e1528b8eb0a41bc4b37a09a77961e6c">DUK_D</a>(<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a50dbac8614f67a4a6d575791664ebc07">DUK_DPRINT</a>(<span class="stringliteral">&quot;this binding: wanted to use global object, but it is NULL -&gt; using undefined instead&quot;</span>));</div>
<div class="line"><span class="lineno">  699</span>            <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(!<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a9103714e7b378c01009baf55c69bf768">DUK_TVAL_IS_HEAP_ALLOCATED</a>(tv_this));  <span class="comment">/* no need to decref previous value */</span></div>
<div class="line"><span class="lineno">  700</span>            <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#adbeffc949a1d3dc7aae2f1cc1aecda88">DUK_TVAL_SET_UNDEFINED</a>(tv_this);  <span class="comment">/* nothing to incref */</span></div>
<div class="line"><span class="lineno">  701</span>        }</div>
<div class="line"><span class="lineno">  702</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  703</span>    <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno">  704</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(!<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a56ce1ca0ef174e2cce709d285e47f09b">DUK_TVAL_IS_UNUSED</a>(tv_this));</div>
<div class="line"><span class="lineno">  705</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a2db20d2d3b36d8491ed171cf503488bb">DUK_DDD</a>(<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#aa6e5d41ceaba6832e5ede737f0a35fb9">DUK_DDDPRINT</a>(<span class="stringliteral">&quot;this binding: non-strict, not object/undefined/null -&gt; use ToObject(value)&quot;</span>));</div>
<div class="line"><span class="lineno">  706</span>        <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#abedffa4c88f9473587621bf0240ac2e6">duk_to_object</a>(ctx, idx_this);  <span class="comment">/* may have side effects */</span></div>
<div class="line"><span class="lineno">  707</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  708</span>    }</div>
<div class="line"><span class="lineno">  709</span>}</div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duk__config_8h_html_aff85916aff22bb1c4a5b83e2008cdc30"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duk__config_8h.html#aff85916aff22bb1c4a5b83e2008cdc30">DUK_LIKELY</a></div><div class="ttdeci">#define DUK_LIKELY(x)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duk__config_8h_source.html#l02515">duktape-1.5.2/src-noline/duk_config.h:2515</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_a194c60e7c6796a265a150f8fcfb15c1f"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#a194c60e7c6796a265a150f8fcfb15c1f">DUK_TAG_NULL</a></div><div class="ttdeci">#define DUK_TAG_NULL</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l00642">duktape-1.5.2/src-noline/duktape.c:642</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_a2730ed3b8ede880f25dd33ebb2270d09"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#a2730ed3b8ede880f25dd33ebb2270d09">DUK_TVAL_SET_OBJECT</a></div><div class="ttdeci">#define DUK_TVAL_SET_OBJECT(tv, hptr)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l00739">duktape-1.5.2/src-noline/duktape.c:739</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_a50dbac8614f67a4a6d575791664ebc07"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#a50dbac8614f67a4a6d575791664ebc07">DUK_DPRINT</a></div><div class="ttdeci">#define DUK_DPRINT</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07507">duktape-1.5.2/src-noline/duktape.c:7507</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_a51bb9f80806712cd8d73dcebb5e8d7b3"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#a51bb9f80806712cd8d73dcebb5e8d7b3">DUK_TVAL_GET_TAG</a></div><div class="ttdeci">#define DUK_TVAL_GET_TAG(tv)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l00792">duktape-1.5.2/src-noline/duktape.c:792</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_a56ce1ca0ef174e2cce709d285e47f09b"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#a56ce1ca0ef174e2cce709d285e47f09b">DUK_TVAL_IS_UNUSED</a></div><div class="ttdeci">#define DUK_TVAL_IS_UNUSED(tv)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l00794">duktape-1.5.2/src-noline/duktape.c:794</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_a76b26adb27e6c64e13dedde1252492a1"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#a76b26adb27e6c64e13dedde1252492a1">DUK_BIDX_GLOBAL</a></div><div class="ttdeci">#define DUK_BIDX_GLOBAL</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l01629">duktape-1.5.2/src-noline/duktape.c:1629</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_a9103714e7b378c01009baf55c69bf768"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#a9103714e7b378c01009baf55c69bf768">DUK_TVAL_IS_HEAP_ALLOCATED</a></div><div class="ttdeci">#define DUK_TVAL_IS_HEAP_ALLOCATED(tv)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l00822">duktape-1.5.2/src-noline/duktape.c:822</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_a9e1528b8eb0a41bc4b37a09a77961e6c"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#a9e1528b8eb0a41bc4b37a09a77961e6c">DUK_D</a></div><div class="ttdeci">#define DUK_D(x)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07495">duktape-1.5.2/src-noline/duktape.c:7495</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_aa372dbdc4b97deff3bab22c5210a8d63"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#aa372dbdc4b97deff3bab22c5210a8d63">DUK_TAG_UNDEFINED</a></div><div class="ttdeci">#define DUK_TAG_UNDEFINED</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l00641">duktape-1.5.2/src-noline/duktape.c:641</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_aadbbb32aa10b98e1f373906d1cef0c57"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#aadbbb32aa10b98e1f373906d1cef0c57">DUK_TAG_OBJECT</a></div><div class="ttdeci">#define DUK_TAG_OBJECT</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l00648">duktape-1.5.2/src-noline/duktape.c:648</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_abedffa4c88f9473587621bf0240ac2e6"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#abedffa4c88f9473587621bf0240ac2e6">duk_to_object</a></div><div class="ttdeci">DUK_EXTERNAL void duk_to_object(duk_context *ctx, duk_idx_t index)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l17299">duktape-1.5.2/src-noline/duktape.c:17299</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_ac6b106695c0dfa435ade88972d1e46b8"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#ac6b106695c0dfa435ade88972d1e46b8">DUK_HOBJECT_INCREF</a></div><div class="ttdeci">#define DUK_HOBJECT_INCREF(thr, h)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l03822">duktape-1.5.2/src-noline/duktape.c:3822</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_adbeffc949a1d3dc7aae2f1cc1aecda88"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#adbeffc949a1d3dc7aae2f1cc1aecda88">DUK_TVAL_SET_UNDEFINED</a></div><div class="ttdeci">#define DUK_TVAL_SET_UNDEFINED(tv)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l00658">duktape-1.5.2/src-noline/duktape.c:658</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_ae5226f867ccd5073adc2df9140389ecb"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#ae5226f867ccd5073adc2df9140389ecb">DUK_HOBJECT_HAS_STRICT</a></div><div class="ttdeci">#define DUK_HOBJECT_HAS_STRICT(h)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l04811">duktape-1.5.2/src-noline/duktape.c:4811</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_afbc705d5de3fe9562cadf9c94bf30066"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#afbc705d5de3fe9562cadf9c94bf30066">DUK_TAG_LIGHTFUNC</a></div><div class="ttdeci">#define DUK_TAG_LIGHTFUNC</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l00645">duktape-1.5.2/src-noline/duktape.c:645</a></div></div>
<div class="ttc" id="astructduk__hobject_html"><div class="ttname"><a href="structduk__hobject.html">duk_hobject</a></div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l05328">duktape-1.5.2/src-noline/duktape.c:5328</a></div></div>
<div class="ttc" id="astructduk__hthread_html_a2411e86e6389e09885c986c311430c76"><div class="ttname"><a href="structduk__hthread.html#a2411e86e6389e09885c986c311430c76">duk_hthread::builtins</a></div><div class="ttdeci">duk_hobject * builtins[DUK_NUM_BUILTINS]</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06274">duktape-1.5.2/src-noline/duktape.c:6274</a></div></div>
<div class="ttc" id="astructduk__tval__struct_html"><div class="ttname"><a href="structduk__tval__struct.html">duk_tval_struct</a></div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l00616">duktape-1.5.2/src-noline/duktape.c:616</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06274">duk_hthread::builtins</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07755">DUK_ASSERT</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l01629">DUK_BIDX_GLOBAL</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07495">DUK_D</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07497">DUK_DDD</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07509">DUK_DDDPRINT</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07507">DUK_DPRINT</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l04811">DUK_HOBJECT_HAS_STRICT</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l03822">DUK_HOBJECT_INCREF</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h_source.html#l02515">DUK_LIKELY</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l00645">DUK_TAG_LIGHTFUNC</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l00642">DUK_TAG_NULL</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l00648">DUK_TAG_OBJECT</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l00641">DUK_TAG_UNDEFINED</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l17299">duk_to_object()</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l00792">DUK_TVAL_GET_TAG</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l00822">DUK_TVAL_IS_HEAP_ALLOCATED</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l00794">DUK_TVAL_IS_UNUSED</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l00739">DUK_TVAL_SET_OBJECT</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l00658">DUK_TVAL_SET_UNDEFINED</a>, <a class="el" href="gmacros_8h_source.html#l00924">NULL</a>, and <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06228">duk_hthread::valstack_bottom</a>.</p>

<p class="reference">Referenced by <a class="el" href="duktape-1_85_82_2src-separate_2duk__js__call_8c_source.html#l01158">duk__handle_call_inner()</a>, and <a class="el" href="duktape-1_85_82_2src-separate_2duk__js__call_8c_source.html#l02290">duk_handle_ecma_call_setup()</a>.</p>

</div>
</div>
<a id="a0e907083e0c0fef469fbf2c811353d71" name="a0e907083e0c0fef469fbf2c811353d71"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0e907083e0c0fef469fbf2c811353d71">&#9670;&#160;</a></span>duk__create_arguments_object()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a245b431abb36cac1ac8d0eae054ed5c1">DUK_LOCAL</a> void duk__create_arguments_object </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structduk__hthread.html">duk_hthread</a> *</td>          <td class="paramname"><span class="paramname"><em>thr</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structduk__hobject.html">duk_hobject</a> *</td>          <td class="paramname"><span class="paramname"><em>func</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structduk__hobject.html">duk_hobject</a> *</td>          <td class="paramname"><span class="paramname"><em>varenv</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a3e3bb369382aab50155c1d18bdf73923">duk_idx_t</a></td>          <td class="paramname"><span class="paramname"><em>idx_argbase</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a3e3bb369382aab50155c1d18bdf73923">duk_idx_t</a></td>          <td class="paramname"><span class="paramname"><em>num_stack_args</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="duktape-1_85_82_2src-separate_2duk__js__call_8c_source.html#l00109">109</a> of file <a class="el" href="duktape-1_85_82_2src-separate_2duk__js__call_8c_source.html">duktape-1.5.2/src-separate/duk_js_call.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  113</span>                                                                      {   <span class="comment">/* num args starting from idx_argbase */</span></div>
<div class="line"><span class="lineno">  114</span>    <a class="code hl_struct" href="structduk__hthread.html">duk_context</a> *ctx = (<a class="code hl_struct" href="structduk__hthread.html">duk_context</a> *) thr;</div>
<div class="line"><span class="lineno">  115</span>    <a class="code hl_struct" href="structduk__hobject.html">duk_hobject</a> *<a class="code hl_variable" href="curl_8h.html#a7d68018e95e3d4e6b703538ac1c8c411">arg</a>;          <span class="comment">/* &#39;arguments&#39; */</span></div>
<div class="line"><span class="lineno">  116</span>    <a class="code hl_struct" href="structduk__hobject.html">duk_hobject</a> *formals;      <span class="comment">/* formals for &#39;func&#39; (may be NULL if func is a C function) */</span></div>
<div class="line"><span class="lineno">  117</span>    <a class="code hl_typedef" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a3e3bb369382aab50155c1d18bdf73923">duk_idx_t</a> i_arg;</div>
<div class="line"><span class="lineno">  118</span>    <a class="code hl_typedef" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a3e3bb369382aab50155c1d18bdf73923">duk_idx_t</a> i_map;</div>
<div class="line"><span class="lineno">  119</span>    <a class="code hl_typedef" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a3e3bb369382aab50155c1d18bdf73923">duk_idx_t</a> i_mappednames;</div>
<div class="line"><span class="lineno">  120</span>    <a class="code hl_typedef" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a3e3bb369382aab50155c1d18bdf73923">duk_idx_t</a> i_formals;</div>
<div class="line"><span class="lineno">  121</span>    <a class="code hl_typedef" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a3e3bb369382aab50155c1d18bdf73923">duk_idx_t</a> i_argbase;</div>
<div class="line"><span class="lineno">  122</span>    <a class="code hl_typedef" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a3e3bb369382aab50155c1d18bdf73923">duk_idx_t</a> n_formals;</div>
<div class="line"><span class="lineno">  123</span>    <a class="code hl_typedef" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a3e3bb369382aab50155c1d18bdf73923">duk_idx_t</a> idx;</div>
<div class="line"><span class="lineno">  124</span>    <a class="code hl_typedef" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#af32ca4c30431e819676401ce2b11c2e7">duk_bool_t</a> need_map;</div>
<div class="line"><span class="lineno">  125</span> </div>
<div class="line"><span class="lineno">  126</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a2db20d2d3b36d8491ed171cf503488bb">DUK_DDD</a>(<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#aa6e5d41ceaba6832e5ede737f0a35fb9">DUK_DDDPRINT</a>(<span class="stringliteral">&quot;creating arguments object for func=%!iO, varenv=%!iO, &quot;</span></div>
<div class="line"><span class="lineno">  127</span>                         <span class="stringliteral">&quot;idx_argbase=%ld, num_stack_args=%ld&quot;</span>,</div>
<div class="line"><span class="lineno">  128</span>                         (<a class="code hl_struct" href="structduk__heaphdr.html">duk_heaphdr</a> *) func, (<a class="code hl_struct" href="structduk__heaphdr.html">duk_heaphdr</a> *) varenv,</div>
<div class="line"><span class="lineno">  129</span>                         (<span class="keywordtype">long</span>) idx_argbase, (<span class="keywordtype">long</span>) num_stack_args));</div>
<div class="line"><span class="lineno">  130</span> </div>
<div class="line"><span class="lineno">  131</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(thr != <a class="code hl_define" href="gmacros_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><span class="lineno">  132</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(func != <a class="code hl_define" href="gmacros_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><span class="lineno">  133</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52b5d3ca26e6c6391f27c77f23d70d8b">DUK_HOBJECT_IS_NONBOUND_FUNCTION</a>(func));</div>
<div class="line"><span class="lineno">  134</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(varenv != <a class="code hl_define" href="gmacros_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><span class="lineno">  135</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(idx_argbase &gt;= 0);  <span class="comment">/* assumed to bottom relative */</span></div>
<div class="line"><span class="lineno">  136</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(num_stack_args &gt;= 0);</div>
<div class="line"><span class="lineno">  137</span> </div>
<div class="line"><span class="lineno">  138</span>    need_map = 0;</div>
<div class="line"><span class="lineno">  139</span> </div>
<div class="line"><span class="lineno">  140</span>    i_argbase = idx_argbase;</div>
<div class="line"><span class="lineno">  141</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(i_argbase &gt;= 0);</div>
<div class="line"><span class="lineno">  142</span> </div>
<div class="line"><span class="lineno">  143</span>    <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#aca724f007b73483138017f4d32bb6879">duk_push_hobject</a>(ctx, func);</div>
<div class="line"><span class="lineno">  144</span>    <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a1549987aa437dbcc45cfb63722c834d6">duk_get_prop_stridx</a>(ctx, -1, <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a18aadaa0c45d12bd296bb8921e1f71fc">DUK_STRIDX_INT_FORMALS</a>);</div>
<div class="line"><span class="lineno">  145</span>    formals = <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#aca26324ee5830d35a824b1e762ef006c">duk_get_hobject</a>(ctx, -1);</div>
<div class="line"><span class="lineno">  146</span>    n_formals = 0;</div>
<div class="line"><span class="lineno">  147</span>    <span class="keywordflow">if</span> (formals) {</div>
<div class="line"><span class="lineno">  148</span>        <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a1549987aa437dbcc45cfb63722c834d6">duk_get_prop_stridx</a>(ctx, -1, <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a846c7f411a94ad5b75b2f7a50f7abb50">DUK_STRIDX_LENGTH</a>);</div>
<div class="line"><span class="lineno">  149</span>        n_formals = (<a class="code hl_typedef" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a3e3bb369382aab50155c1d18bdf73923">duk_idx_t</a>) <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#adf40b7bab50dd909da79a07c1c2f44c2">duk_require_int</a>(ctx, -1);</div>
<div class="line"><span class="lineno">  150</span>        <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#ac8da334e24a5f42f252271161d2116fb">duk_pop</a>(ctx);</div>
<div class="line"><span class="lineno">  151</span>    }</div>
<div class="line"><span class="lineno">  152</span>    <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52f537d78760f69d0d94d21728279b50">duk_remove</a>(ctx, -2);  <span class="comment">/* leave formals on stack for later use */</span></div>
<div class="line"><span class="lineno">  153</span>    i_formals = <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a3c339091d6e037155144ac525ca3cd02">duk_require_top_index</a>(ctx);</div>
<div class="line"><span class="lineno">  154</span> </div>
<div class="line"><span class="lineno">  155</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(n_formals &gt;= 0);</div>
<div class="line"><span class="lineno">  156</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(formals != <a class="code hl_define" href="gmacros_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> || n_formals == 0);</div>
<div class="line"><span class="lineno">  157</span> </div>
<div class="line"><span class="lineno">  158</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a2db20d2d3b36d8491ed171cf503488bb">DUK_DDD</a>(<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#aa6e5d41ceaba6832e5ede737f0a35fb9">DUK_DDDPRINT</a>(<span class="stringliteral">&quot;func=%!O, formals=%!O, n_formals=%ld&quot;</span>,</div>
<div class="line"><span class="lineno">  159</span>                         (<a class="code hl_struct" href="structduk__heaphdr.html">duk_heaphdr</a> *) func, (<a class="code hl_struct" href="structduk__heaphdr.html">duk_heaphdr</a> *) formals,</div>
<div class="line"><span class="lineno">  160</span>                         (<span class="keywordtype">long</span>) n_formals));</div>
<div class="line"><span class="lineno">  161</span> </div>
<div class="line"><span class="lineno">  162</span>    <span class="comment">/* [ ... formals ] */</span></div>
<div class="line"><span class="lineno">  163</span> </div>
<div class="line"><span class="lineno">  164</span>    <span class="comment">/*</span></div>
<div class="line"><span class="lineno">  165</span><span class="comment">     *  Create required objects:</span></div>
<div class="line"><span class="lineno">  166</span><span class="comment">     *    - &#39;arguments&#39; object: array-like, but not an array</span></div>
<div class="line"><span class="lineno">  167</span><span class="comment">     *    - &#39;map&#39; object: internal object, tied to &#39;arguments&#39;</span></div>
<div class="line"><span class="lineno">  168</span><span class="comment">     *    - &#39;mappedNames&#39; object: temporary value used during construction</span></div>
<div class="line"><span class="lineno">  169</span><span class="comment">     */</span></div>
<div class="line"><span class="lineno">  170</span> </div>
<div class="line"><span class="lineno">  171</span>    i_arg = <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#ab50dbd6676f214ef04cd8a09b66ffa55">duk_push_object_helper</a>(ctx,</div>
<div class="line"><span class="lineno">  172</span>                                   <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#ab3861bb2fd293559d606a43da9dca18c">DUK_HOBJECT_FLAG_EXTENSIBLE</a> |</div>
<div class="line"><span class="lineno">  173</span>                                   <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#af9f46dba0a3b55d3e78a02b0afa40514">DUK_HOBJECT_FLAG_ARRAY_PART</a> |</div>
<div class="line"><span class="lineno">  174</span>                                   <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a5e79d13530031f2f54f993cd89668356">DUK_HOBJECT_CLASS_AS_FLAGS</a>(<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a505c1451b9e64ea640de57365dcf0616">DUK_HOBJECT_CLASS_ARGUMENTS</a>),</div>
<div class="line"><span class="lineno">  175</span>                                   <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a30031b34a632fb96cd7fef08ac81eed1">DUK_BIDX_OBJECT_PROTOTYPE</a>);</div>
<div class="line"><span class="lineno">  176</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(i_arg &gt;= 0);</div>
<div class="line"><span class="lineno">  177</span>    <a class="code hl_variable" href="curl_8h.html#a7d68018e95e3d4e6b703538ac1c8c411">arg</a> = <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a11bee89b8ec58fdddc9de03af4475bdc">duk_require_hobject</a>(ctx, -1);</div>
<div class="line"><span class="lineno">  178</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(<a class="code hl_variable" href="curl_8h.html#a7d68018e95e3d4e6b703538ac1c8c411">arg</a> != <a class="code hl_define" href="gmacros_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><span class="lineno">  179</span> </div>
<div class="line"><span class="lineno">  180</span>    i_map = <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#ab50dbd6676f214ef04cd8a09b66ffa55">duk_push_object_helper</a>(ctx,</div>
<div class="line"><span class="lineno">  181</span>                                   <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#ab3861bb2fd293559d606a43da9dca18c">DUK_HOBJECT_FLAG_EXTENSIBLE</a> |</div>
<div class="line"><span class="lineno">  182</span>                                   <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a5e79d13530031f2f54f993cd89668356">DUK_HOBJECT_CLASS_AS_FLAGS</a>(<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a2ea4dcc6b2f4f5c52f30607f24418b82">DUK_HOBJECT_CLASS_OBJECT</a>),</div>
<div class="line"><span class="lineno">  183</span>                                   -1);  <span class="comment">/* no prototype */</span></div>
<div class="line"><span class="lineno">  184</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(i_map &gt;= 0);</div>
<div class="line"><span class="lineno">  185</span> </div>
<div class="line"><span class="lineno">  186</span>    i_mappednames = <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#ab50dbd6676f214ef04cd8a09b66ffa55">duk_push_object_helper</a>(ctx,</div>
<div class="line"><span class="lineno">  187</span>                                           <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#ab3861bb2fd293559d606a43da9dca18c">DUK_HOBJECT_FLAG_EXTENSIBLE</a> |</div>
<div class="line"><span class="lineno">  188</span>                                           <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a5e79d13530031f2f54f993cd89668356">DUK_HOBJECT_CLASS_AS_FLAGS</a>(<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a2ea4dcc6b2f4f5c52f30607f24418b82">DUK_HOBJECT_CLASS_OBJECT</a>),</div>
<div class="line"><span class="lineno">  189</span>                                           -1);  <span class="comment">/* no prototype */</span></div>
<div class="line"><span class="lineno">  190</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(i_mappednames &gt;= 0);</div>
<div class="line"><span class="lineno">  191</span> </div>
<div class="line"><span class="lineno">  192</span>    <span class="comment">/* [ ... formals arguments map mappedNames ] */</span></div>
<div class="line"><span class="lineno">  193</span> </div>
<div class="line"><span class="lineno">  194</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a2db20d2d3b36d8491ed171cf503488bb">DUK_DDD</a>(<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#aa6e5d41ceaba6832e5ede737f0a35fb9">DUK_DDDPRINT</a>(<span class="stringliteral">&quot;created arguments related objects: &quot;</span></div>
<div class="line"><span class="lineno">  195</span>                         <span class="stringliteral">&quot;arguments at index %ld -&gt; %!O &quot;</span></div>
<div class="line"><span class="lineno">  196</span>                         <span class="stringliteral">&quot;map at index %ld -&gt; %!O &quot;</span></div>
<div class="line"><span class="lineno">  197</span>                         <span class="stringliteral">&quot;mappednames at index %ld -&gt; %!O&quot;</span>,</div>
<div class="line"><span class="lineno">  198</span>                         (<span class="keywordtype">long</span>) i_arg, (<a class="code hl_struct" href="structduk__heaphdr.html">duk_heaphdr</a> *) <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#aca26324ee5830d35a824b1e762ef006c">duk_get_hobject</a>(ctx, i_arg),</div>
<div class="line"><span class="lineno">  199</span>                         (<span class="keywordtype">long</span>) i_map, (<a class="code hl_struct" href="structduk__heaphdr.html">duk_heaphdr</a> *) <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#aca26324ee5830d35a824b1e762ef006c">duk_get_hobject</a>(ctx, i_map),</div>
<div class="line"><span class="lineno">  200</span>                         (<span class="keywordtype">long</span>) i_mappednames, (<a class="code hl_struct" href="structduk__heaphdr.html">duk_heaphdr</a> *) <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#aca26324ee5830d35a824b1e762ef006c">duk_get_hobject</a>(ctx, i_mappednames)));</div>
<div class="line"><span class="lineno">  201</span> </div>
<div class="line"><span class="lineno">  202</span>    <span class="comment">/*</span></div>
<div class="line"><span class="lineno">  203</span><span class="comment">     *  Init arguments properties, map, etc.</span></div>
<div class="line"><span class="lineno">  204</span><span class="comment">     */</span></div>
<div class="line"><span class="lineno">  205</span> </div>
<div class="line"><span class="lineno">  206</span>    <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a5d2b6c5f1be0d673b074d167c9ff7d4d">duk_push_int</a>(ctx, num_stack_args);</div>
<div class="line"><span class="lineno">  207</span>    <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#ad56b7a318e093d42e552c2cf25d492e8">duk_xdef_prop_stridx</a>(ctx, i_arg, <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a846c7f411a94ad5b75b2f7a50f7abb50">DUK_STRIDX_LENGTH</a>, <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#aa4de0ba61ed5a4ed0f12f1ddd42dc986">DUK_PROPDESC_FLAGS_WC</a>);</div>
<div class="line"><span class="lineno">  208</span> </div>
<div class="line"><span class="lineno">  209</span>    <span class="comment">/*</span></div>
<div class="line"><span class="lineno">  210</span><span class="comment">     *  Init argument related properties</span></div>
<div class="line"><span class="lineno">  211</span><span class="comment">     */</span></div>
<div class="line"><span class="lineno">  212</span> </div>
<div class="line"><span class="lineno">  213</span>    <span class="comment">/* step 11 */</span></div>
<div class="line"><span class="lineno">  214</span>    idx = num_stack_args - 1;</div>
<div class="line"><span class="lineno">  215</span>    <span class="keywordflow">while</span> (idx &gt;= 0) {</div>
<div class="line"><span class="lineno">  216</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a2db20d2d3b36d8491ed171cf503488bb">DUK_DDD</a>(<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#aa6e5d41ceaba6832e5ede737f0a35fb9">DUK_DDDPRINT</a>(<span class="stringliteral">&quot;arg idx %ld, argbase=%ld, argidx=%ld&quot;</span>,</div>
<div class="line"><span class="lineno">  217</span>                             (<span class="keywordtype">long</span>) idx, (<span class="keywordtype">long</span>) i_argbase, (<span class="keywordtype">long</span>) (i_argbase + idx)));</div>
<div class="line"><span class="lineno">  218</span> </div>
<div class="line"><span class="lineno">  219</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a2db20d2d3b36d8491ed171cf503488bb">DUK_DDD</a>(<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#aa6e5d41ceaba6832e5ede737f0a35fb9">DUK_DDDPRINT</a>(<span class="stringliteral">&quot;define arguments[%ld]=arg&quot;</span>, (<span class="keywordtype">long</span>) idx));</div>
<div class="line"><span class="lineno">  220</span>        <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a8566105ab847d4151b62c29ceab53a0d">duk_dup</a>(ctx, i_argbase + idx);</div>
<div class="line"><span class="lineno">  221</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a341ebf29df938d732ed6805fc1333171">duk_xdef_prop_index_wec</a>(ctx, i_arg, (<a class="code hl_typedef" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a66a83b11b322fb452d3677f28ee7067f">duk_uarridx_t</a>) idx);</div>
<div class="line"><span class="lineno">  222</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a2db20d2d3b36d8491ed171cf503488bb">DUK_DDD</a>(<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#aa6e5d41ceaba6832e5ede737f0a35fb9">DUK_DDDPRINT</a>(<span class="stringliteral">&quot;defined arguments[%ld]=arg&quot;</span>, (<span class="keywordtype">long</span>) idx));</div>
<div class="line"><span class="lineno">  223</span> </div>
<div class="line"><span class="lineno">  224</span>        <span class="comment">/* step 11.c is relevant only if non-strict (checked in 11.c.ii) */</span></div>
<div class="line"><span class="lineno">  225</span>        <span class="keywordflow">if</span> (!<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#ae5226f867ccd5073adc2df9140389ecb">DUK_HOBJECT_HAS_STRICT</a>(func) &amp;&amp; idx &lt; n_formals) {</div>
<div class="line"><span class="lineno">  226</span>            <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(formals != <a class="code hl_define" href="gmacros_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><span class="lineno">  227</span> </div>
<div class="line"><span class="lineno">  228</span>            <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a2db20d2d3b36d8491ed171cf503488bb">DUK_DDD</a>(<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#aa6e5d41ceaba6832e5ede737f0a35fb9">DUK_DDDPRINT</a>(<span class="stringliteral">&quot;strict function, index within formals (%ld &lt; %ld)&quot;</span>,</div>
<div class="line"><span class="lineno">  229</span>                                 (<span class="keywordtype">long</span>) idx, (<span class="keywordtype">long</span>) n_formals));</div>
<div class="line"><span class="lineno">  230</span> </div>
<div class="line"><span class="lineno">  231</span>            <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a9077276f5224f3985b570a4d82322253">duk_get_prop_index</a>(ctx, i_formals, idx);</div>
<div class="line"><span class="lineno">  232</span>            <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(<a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#ada14d1be1c027a164a237f1402c321ab">duk_is_string</a>(ctx, -1));</div>
<div class="line"><span class="lineno">  233</span> </div>
<div class="line"><span class="lineno">  234</span>            <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a8566105ab847d4151b62c29ceab53a0d">duk_dup</a>(ctx, -1);  <span class="comment">/* [ ... name name ] */</span></div>
<div class="line"><span class="lineno">  235</span> </div>
<div class="line"><span class="lineno">  236</span>            <span class="keywordflow">if</span> (!<a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#af9f80770ce040de69ed8c576f9256920">duk_has_prop</a>(ctx, i_mappednames)) {</div>
<div class="line"><span class="lineno">  237</span>                <span class="comment">/* steps 11.c.ii.1 - 11.c.ii.4, but our internal book-keeping</span></div>
<div class="line"><span class="lineno">  238</span><span class="comment">                 * differs from the reference model</span></div>
<div class="line"><span class="lineno">  239</span><span class="comment">                 */</span></div>
<div class="line"><span class="lineno">  240</span> </div>
<div class="line"><span class="lineno">  241</span>                <span class="comment">/* [ ... name ] */</span></div>
<div class="line"><span class="lineno">  242</span> </div>
<div class="line"><span class="lineno">  243</span>                need_map = 1;</div>
<div class="line"><span class="lineno">  244</span> </div>
<div class="line"><span class="lineno">  245</span>                <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a2db20d2d3b36d8491ed171cf503488bb">DUK_DDD</a>(<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#aa6e5d41ceaba6832e5ede737f0a35fb9">DUK_DDDPRINT</a>(<span class="stringliteral">&quot;set mappednames[%s]=%ld&quot;</span>,</div>
<div class="line"><span class="lineno">  246</span>                                     (<span class="keyword">const</span> <span class="keywordtype">char</span> *) <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a725b7e935bba993ac308645d3340e21d">duk_get_string</a>(ctx, -1),</div>
<div class="line"><span class="lineno">  247</span>                                     (<span class="keywordtype">long</span>) idx));</div>
<div class="line"><span class="lineno">  248</span>                <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a8566105ab847d4151b62c29ceab53a0d">duk_dup</a>(ctx, -1);                      <span class="comment">/* name */</span></div>
<div class="line"><span class="lineno">  249</span>                <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a97a6adfc8eb4c12296d3c2a4f8dab0a6">duk_push_uint</a>(ctx, (<a class="code hl_typedef" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#ac176f6049a9cba3519cc353c879e614b">duk_uint_t</a>) idx);  <span class="comment">/* index */</span></div>
<div class="line"><span class="lineno">  250</span>                <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#ac44e324c8cc1777c335c7d59a50a4798">duk_to_string</a>(ctx, -1);</div>
<div class="line"><span class="lineno">  251</span>                <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a34308fb9d38c9e0e2af04444504356c8">duk_xdef_prop_wec</a>(ctx, i_mappednames);  <span class="comment">/* out of spec, must be configurable */</span></div>
<div class="line"><span class="lineno">  252</span> </div>
<div class="line"><span class="lineno">  253</span>                <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a2db20d2d3b36d8491ed171cf503488bb">DUK_DDD</a>(<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#aa6e5d41ceaba6832e5ede737f0a35fb9">DUK_DDDPRINT</a>(<span class="stringliteral">&quot;set map[%ld]=%s&quot;</span>,</div>
<div class="line"><span class="lineno">  254</span>                                     (<span class="keywordtype">long</span>) idx,</div>
<div class="line"><span class="lineno">  255</span>                                     <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a725b7e935bba993ac308645d3340e21d">duk_get_string</a>(ctx, -1)));</div>
<div class="line"><span class="lineno">  256</span>                <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a8566105ab847d4151b62c29ceab53a0d">duk_dup</a>(ctx, -1);         <span class="comment">/* name */</span></div>
<div class="line"><span class="lineno">  257</span>                <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a341ebf29df938d732ed6805fc1333171">duk_xdef_prop_index_wec</a>(ctx, i_map, (<a class="code hl_typedef" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a66a83b11b322fb452d3677f28ee7067f">duk_uarridx_t</a>) idx);  <span class="comment">/* out of spec, must be configurable */</span></div>
<div class="line"><span class="lineno">  258</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  259</span>                <span class="comment">/* duk_has_prop() popped the second &#39;name&#39; */</span></div>
<div class="line"><span class="lineno">  260</span>            }</div>
<div class="line"><span class="lineno">  261</span> </div>
<div class="line"><span class="lineno">  262</span>            <span class="comment">/* [ ... name ] */</span></div>
<div class="line"><span class="lineno">  263</span>            <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#ac8da334e24a5f42f252271161d2116fb">duk_pop</a>(ctx);  <span class="comment">/* pop &#39;name&#39; */</span></div>
<div class="line"><span class="lineno">  264</span>        }</div>
<div class="line"><span class="lineno">  265</span> </div>
<div class="line"><span class="lineno">  266</span>        idx--;</div>
<div class="line"><span class="lineno">  267</span>    }</div>
<div class="line"><span class="lineno">  268</span> </div>
<div class="line"><span class="lineno">  269</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a2db20d2d3b36d8491ed171cf503488bb">DUK_DDD</a>(<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#aa6e5d41ceaba6832e5ede737f0a35fb9">DUK_DDDPRINT</a>(<span class="stringliteral">&quot;actual arguments processed&quot;</span>));</div>
<div class="line"><span class="lineno">  270</span> </div>
<div class="line"><span class="lineno">  271</span>    <span class="comment">/* step 12 */</span></div>
<div class="line"><span class="lineno">  272</span>    <span class="keywordflow">if</span> (need_map) {</div>
<div class="line"><span class="lineno">  273</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a2db20d2d3b36d8491ed171cf503488bb">DUK_DDD</a>(<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#aa6e5d41ceaba6832e5ede737f0a35fb9">DUK_DDDPRINT</a>(<span class="stringliteral">&quot;adding &#39;map&#39; and &#39;varenv&#39; to arguments object&quot;</span>));</div>
<div class="line"><span class="lineno">  274</span> </div>
<div class="line"><span class="lineno">  275</span>        <span class="comment">/* should never happen for a strict callee */</span></div>
<div class="line"><span class="lineno">  276</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(!<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#ae5226f867ccd5073adc2df9140389ecb">DUK_HOBJECT_HAS_STRICT</a>(func));</div>
<div class="line"><span class="lineno">  277</span> </div>
<div class="line"><span class="lineno">  278</span>        <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a8566105ab847d4151b62c29ceab53a0d">duk_dup</a>(ctx, i_map);</div>
<div class="line"><span class="lineno">  279</span>        <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#ad56b7a318e093d42e552c2cf25d492e8">duk_xdef_prop_stridx</a>(ctx, i_arg, <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#acb855972c73d2d6598abe172bbd88ae1">DUK_STRIDX_INT_MAP</a>, <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a41e3f139e0538302108235e4f3db02d3">DUK_PROPDESC_FLAGS_NONE</a>);  <span class="comment">/* out of spec, don&#39;t care */</span></div>
<div class="line"><span class="lineno">  280</span> </div>
<div class="line"><span class="lineno">  281</span>        <span class="comment">/* The variable environment for magic variable bindings needs to be</span></div>
<div class="line"><span class="lineno">  282</span><span class="comment">         * given by the caller and recorded in the arguments object.</span></div>
<div class="line"><span class="lineno">  283</span><span class="comment">         *</span></div>
<div class="line"><span class="lineno">  284</span><span class="comment">         * See E5 Section 10.6, the creation of setters/getters.</span></div>
<div class="line"><span class="lineno">  285</span><span class="comment">         *</span></div>
<div class="line"><span class="lineno">  286</span><span class="comment">         * The variable environment also provides access to the callee, so</span></div>
<div class="line"><span class="lineno">  287</span><span class="comment">         * an explicit (internal) callee property is not needed.</span></div>
<div class="line"><span class="lineno">  288</span><span class="comment">         */</span></div>
<div class="line"><span class="lineno">  289</span> </div>
<div class="line"><span class="lineno">  290</span>        <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#aca724f007b73483138017f4d32bb6879">duk_push_hobject</a>(ctx, varenv);</div>
<div class="line"><span class="lineno">  291</span>        <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#ad56b7a318e093d42e552c2cf25d492e8">duk_xdef_prop_stridx</a>(ctx, i_arg, <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#ab99e5f8aeaef20e4f61fd2fbf091a190">DUK_STRIDX_INT_VARENV</a>, <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a41e3f139e0538302108235e4f3db02d3">DUK_PROPDESC_FLAGS_NONE</a>);  <span class="comment">/* out of spec, don&#39;t care */</span></div>
<div class="line"><span class="lineno">  292</span>    }</div>
<div class="line"><span class="lineno">  293</span> </div>
<div class="line"><span class="lineno">  294</span>    <span class="comment">/* steps 13-14 */</span></div>
<div class="line"><span class="lineno">  295</span>    <span class="keywordflow">if</span> (<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#ae5226f867ccd5073adc2df9140389ecb">DUK_HOBJECT_HAS_STRICT</a>(func)) {</div>
<div class="line"><span class="lineno">  296</span>        <span class="comment">/* Callee/caller are throwers and are not deletable etc.  They</span></div>
<div class="line"><span class="lineno">  297</span><span class="comment">         * could be implemented as virtual properties, but currently</span></div>
<div class="line"><span class="lineno">  298</span><span class="comment">         * there is no support for virtual properties which are accessors</span></div>
<div class="line"><span class="lineno">  299</span><span class="comment">         * (only plain virtual properties).  This would not be difficult</span></div>
<div class="line"><span class="lineno">  300</span><span class="comment">         * to change in duk_hobject_props, but we can make the throwers</span></div>
<div class="line"><span class="lineno">  301</span><span class="comment">         * normal, concrete properties just as easily.</span></div>
<div class="line"><span class="lineno">  302</span><span class="comment">         *</span></div>
<div class="line"><span class="lineno">  303</span><span class="comment">         * Note that the specification requires that the *same* thrower</span></div>
<div class="line"><span class="lineno">  304</span><span class="comment">         * built-in object is used here!  See E5 Section 10.6 main</span></div>
<div class="line"><span class="lineno">  305</span><span class="comment">         * algoritm, step 14, and Section 13.2.3 which describes the</span></div>
<div class="line"><span class="lineno">  306</span><span class="comment">         * thrower.  See test case test-arguments-throwers.js.</span></div>
<div class="line"><span class="lineno">  307</span><span class="comment">         */</span></div>
<div class="line"><span class="lineno">  308</span> </div>
<div class="line"><span class="lineno">  309</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a2db20d2d3b36d8491ed171cf503488bb">DUK_DDD</a>(<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#aa6e5d41ceaba6832e5ede737f0a35fb9">DUK_DDDPRINT</a>(<span class="stringliteral">&quot;strict function, setting caller/callee to throwers&quot;</span>));</div>
<div class="line"><span class="lineno">  310</span> </div>
<div class="line"><span class="lineno">  311</span>        <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#ab0bf0a6051955151089916e155e48215">duk_xdef_prop_stridx_thrower</a>(ctx, i_arg, <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#af206aa7e4c9e07c14318015ae02f5e9a">DUK_STRIDX_CALLER</a>, <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a41e3f139e0538302108235e4f3db02d3">DUK_PROPDESC_FLAGS_NONE</a>);</div>
<div class="line"><span class="lineno">  312</span>        <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#ab0bf0a6051955151089916e155e48215">duk_xdef_prop_stridx_thrower</a>(ctx, i_arg, <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#acbdcb82a3c6e6881377547f241083edf">DUK_STRIDX_CALLEE</a>, <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a41e3f139e0538302108235e4f3db02d3">DUK_PROPDESC_FLAGS_NONE</a>);</div>
<div class="line"><span class="lineno">  313</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  314</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a2db20d2d3b36d8491ed171cf503488bb">DUK_DDD</a>(<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#aa6e5d41ceaba6832e5ede737f0a35fb9">DUK_DDDPRINT</a>(<span class="stringliteral">&quot;non-strict function, setting callee to actual value&quot;</span>));</div>
<div class="line"><span class="lineno">  315</span>        <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#aca724f007b73483138017f4d32bb6879">duk_push_hobject</a>(ctx, func);</div>
<div class="line"><span class="lineno">  316</span>        <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#ad56b7a318e093d42e552c2cf25d492e8">duk_xdef_prop_stridx</a>(ctx, i_arg, <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#acbdcb82a3c6e6881377547f241083edf">DUK_STRIDX_CALLEE</a>, <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#aa4de0ba61ed5a4ed0f12f1ddd42dc986">DUK_PROPDESC_FLAGS_WC</a>);</div>
<div class="line"><span class="lineno">  317</span>    }</div>
<div class="line"><span class="lineno">  318</span> </div>
<div class="line"><span class="lineno">  319</span>    <span class="comment">/* set exotic behavior only after we&#39;re done */</span></div>
<div class="line"><span class="lineno">  320</span>    <span class="keywordflow">if</span> (need_map) {</div>
<div class="line"><span class="lineno">  321</span>        <span class="comment">/* Exotic behaviors are only enabled for arguments objects</span></div>
<div class="line"><span class="lineno">  322</span><span class="comment">         * which have a parameter map (see E5 Section 10.6 main</span></div>
<div class="line"><span class="lineno">  323</span><span class="comment">         * algorithm, step 12).</span></div>
<div class="line"><span class="lineno">  324</span><span class="comment">         *</span></div>
<div class="line"><span class="lineno">  325</span><span class="comment">         * In particular, a non-strict arguments object with no</span></div>
<div class="line"><span class="lineno">  326</span><span class="comment">         * mapped formals does *NOT* get exotic behavior, even</span></div>
<div class="line"><span class="lineno">  327</span><span class="comment">         * for e.g. &quot;caller&quot; property.  This seems counterintuitive</span></div>
<div class="line"><span class="lineno">  328</span><span class="comment">         * but seems to be the case.</span></div>
<div class="line"><span class="lineno">  329</span><span class="comment">         */</span></div>
<div class="line"><span class="lineno">  330</span> </div>
<div class="line"><span class="lineno">  331</span>        <span class="comment">/* cannot be strict (never mapped variables) */</span></div>
<div class="line"><span class="lineno">  332</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(!<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#ae5226f867ccd5073adc2df9140389ecb">DUK_HOBJECT_HAS_STRICT</a>(func));</div>
<div class="line"><span class="lineno">  333</span> </div>
<div class="line"><span class="lineno">  334</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a2db20d2d3b36d8491ed171cf503488bb">DUK_DDD</a>(<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#aa6e5d41ceaba6832e5ede737f0a35fb9">DUK_DDDPRINT</a>(<span class="stringliteral">&quot;enabling exotic behavior for arguments object&quot;</span>));</div>
<div class="line"><span class="lineno">  335</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a3401d2c1da00e6aa0bcd04a51234645f">DUK_HOBJECT_SET_EXOTIC_ARGUMENTS</a>(<a class="code hl_variable" href="curl_8h.html#a7d68018e95e3d4e6b703538ac1c8c411">arg</a>);</div>
<div class="line"><span class="lineno">  336</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  337</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a2db20d2d3b36d8491ed171cf503488bb">DUK_DDD</a>(<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#aa6e5d41ceaba6832e5ede737f0a35fb9">DUK_DDDPRINT</a>(<span class="stringliteral">&quot;not enabling exotic behavior for arguments object&quot;</span>));</div>
<div class="line"><span class="lineno">  338</span>    }</div>
<div class="line"><span class="lineno">  339</span> </div>
<div class="line"><span class="lineno">  340</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a2db20d2d3b36d8491ed171cf503488bb">DUK_DDD</a>(<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#aa6e5d41ceaba6832e5ede737f0a35fb9">DUK_DDDPRINT</a>(<span class="stringliteral">&quot;final arguments related objects: &quot;</span></div>
<div class="line"><span class="lineno">  341</span>                         <span class="stringliteral">&quot;arguments at index %ld -&gt; %!O &quot;</span></div>
<div class="line"><span class="lineno">  342</span>                         <span class="stringliteral">&quot;map at index %ld -&gt; %!O &quot;</span></div>
<div class="line"><span class="lineno">  343</span>                         <span class="stringliteral">&quot;mappednames at index %ld -&gt; %!O&quot;</span>,</div>
<div class="line"><span class="lineno">  344</span>                         (<span class="keywordtype">long</span>) i_arg, (<a class="code hl_struct" href="structduk__heaphdr.html">duk_heaphdr</a> *) <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#aca26324ee5830d35a824b1e762ef006c">duk_get_hobject</a>(ctx, i_arg),</div>
<div class="line"><span class="lineno">  345</span>                         (<span class="keywordtype">long</span>) i_map, (<a class="code hl_struct" href="structduk__heaphdr.html">duk_heaphdr</a> *) <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#aca26324ee5830d35a824b1e762ef006c">duk_get_hobject</a>(ctx, i_map),</div>
<div class="line"><span class="lineno">  346</span>                         (<span class="keywordtype">long</span>) i_mappednames, (<a class="code hl_struct" href="structduk__heaphdr.html">duk_heaphdr</a> *) <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#aca26324ee5830d35a824b1e762ef006c">duk_get_hobject</a>(ctx, i_mappednames)));</div>
<div class="line"><span class="lineno">  347</span> </div>
<div class="line"><span class="lineno">  348</span>    <span class="comment">/* [ args(n) [crud] formals arguments map mappednames ] */</span></div>
<div class="line"><span class="lineno">  349</span> </div>
<div class="line"><span class="lineno">  350</span>    <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a09f116a4bcf486b3359afaa1abf4bf66">duk_pop_2</a>(ctx);</div>
<div class="line"><span class="lineno">  351</span>    <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52f537d78760f69d0d94d21728279b50">duk_remove</a>(ctx, -2);</div>
<div class="line"><span class="lineno">  352</span> </div>
<div class="line"><span class="lineno">  353</span>    <span class="comment">/* [ args [crud] arguments ] */</span></div>
<div class="line"><span class="lineno">  354</span>}</div>
<div class="ttc" id="acurl_8h_html_a7d68018e95e3d4e6b703538ac1c8c411"><div class="ttname"><a href="curl_8h.html#a7d68018e95e3d4e6b703538ac1c8c411">arg</a></div><div class="ttdeci">CURL_EXTERN int void * arg</div><div class="ttdef"><b>Definition</b> <a href="curl_8h_source.html#l02622">curl.h:2622</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duk__config_8h_html_a3e3bb369382aab50155c1d18bdf73923"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a3e3bb369382aab50155c1d18bdf73923">duk_idx_t</a></div><div class="ttdeci">duk_int_t duk_idx_t</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duk__config_8h_source.html#l01830">duktape-1.5.2/src-noline/duk_config.h:1830</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duk__config_8h_html_a66a83b11b322fb452d3677f28ee7067f"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a66a83b11b322fb452d3677f28ee7067f">duk_uarridx_t</a></div><div class="ttdeci">duk_uint_t duk_uarridx_t</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duk__config_8h_source.html#l01842">duktape-1.5.2/src-noline/duk_config.h:1842</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duk__config_8h_html_ac176f6049a9cba3519cc353c879e614b"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duk__config_8h.html#ac176f6049a9cba3519cc353c879e614b">duk_uint_t</a></div><div class="ttdeci">duk_uint_fast32_t duk_uint_t</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duk__config_8h_source.html#l01786">duktape-1.5.2/src-noline/duk_config.h:1786</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_a09f116a4bcf486b3359afaa1abf4bf66"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#a09f116a4bcf486b3359afaa1abf4bf66">duk_pop_2</a></div><div class="ttdeci">DUK_EXTERNAL void duk_pop_2(duk_context *ctx)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l19167">duktape-1.5.2/src-noline/duktape.c:19167</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_a11bee89b8ec58fdddc9de03af4475bdc"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#a11bee89b8ec58fdddc9de03af4475bdc">duk_require_hobject</a></div><div class="ttdeci">DUK_INTERNAL_DECL duk_hobject * duk_require_hobject(duk_context *ctx, duk_idx_t index)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l16305">duktape-1.5.2/src-noline/duktape.c:16305</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_a1549987aa437dbcc45cfb63722c834d6"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#a1549987aa437dbcc45cfb63722c834d6">duk_get_prop_stridx</a></div><div class="ttdeci">DUK_INTERNAL_DECL duk_bool_t duk_get_prop_stridx(duk_context *ctx, duk_idx_t obj_index, duk_small_int_t stridx)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l14318">duktape-1.5.2/src-noline/duktape.c:14318</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_a18aadaa0c45d12bd296bb8921e1f71fc"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#a18aadaa0c45d12bd296bb8921e1f71fc">DUK_STRIDX_INT_FORMALS</a></div><div class="ttdeci">#define DUK_STRIDX_INT_FORMALS</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l01182">duktape-1.5.2/src-noline/duktape.c:1182</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_a2ea4dcc6b2f4f5c52f30607f24418b82"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#a2ea4dcc6b2f4f5c52f30607f24418b82">DUK_HOBJECT_CLASS_OBJECT</a></div><div class="ttdeci">#define DUK_HOBJECT_CLASS_OBJECT</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l04701">duktape-1.5.2/src-noline/duktape.c:4701</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_a30031b34a632fb96cd7fef08ac81eed1"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#a30031b34a632fb96cd7fef08ac81eed1">DUK_BIDX_OBJECT_PROTOTYPE</a></div><div class="ttdeci">#define DUK_BIDX_OBJECT_PROTOTYPE</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l01632">duktape-1.5.2/src-noline/duktape.c:1632</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_a3401d2c1da00e6aa0bcd04a51234645f"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#a3401d2c1da00e6aa0bcd04a51234645f">DUK_HOBJECT_SET_EXOTIC_ARGUMENTS</a></div><div class="ttdeci">#define DUK_HOBJECT_SET_EXOTIC_ARGUMENTS(h)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l04839">duktape-1.5.2/src-noline/duktape.c:4839</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_a341ebf29df938d732ed6805fc1333171"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#a341ebf29df938d732ed6805fc1333171">duk_xdef_prop_index_wec</a></div><div class="ttdeci">#define duk_xdef_prop_index_wec(ctx, obj_index, arr_index)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l04369">duktape-1.5.2/src-noline/duktape.c:4369</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_a34308fb9d38c9e0e2af04444504356c8"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#a34308fb9d38c9e0e2af04444504356c8">duk_xdef_prop_wec</a></div><div class="ttdeci">#define duk_xdef_prop_wec(ctx, obj_index)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l04367">duktape-1.5.2/src-noline/duktape.c:4367</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_a3c339091d6e037155144ac525ca3cd02"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#a3c339091d6e037155144ac525ca3cd02">duk_require_top_index</a></div><div class="ttdeci">DUK_EXTERNAL duk_idx_t duk_require_top_index(duk_context *ctx)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l15324">duktape-1.5.2/src-noline/duktape.c:15324</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_a41e3f139e0538302108235e4f3db02d3"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#a41e3f139e0538302108235e4f3db02d3">DUK_PROPDESC_FLAGS_NONE</a></div><div class="ttdeci">#define DUK_PROPDESC_FLAGS_NONE</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l04880">duktape-1.5.2/src-noline/duktape.c:4880</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_a505c1451b9e64ea640de57365dcf0616"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#a505c1451b9e64ea640de57365dcf0616">DUK_HOBJECT_CLASS_ARGUMENTS</a></div><div class="ttdeci">#define DUK_HOBJECT_CLASS_ARGUMENTS</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l04692">duktape-1.5.2/src-noline/duktape.c:4692</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_a52b5d3ca26e6c6391f27c77f23d70d8b"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52b5d3ca26e6c6391f27c77f23d70d8b">DUK_HOBJECT_IS_NONBOUND_FUNCTION</a></div><div class="ttdeci">#define DUK_HOBJECT_IS_NONBOUND_FUNCTION(h)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l04779">duktape-1.5.2/src-noline/duktape.c:4779</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_a52f537d78760f69d0d94d21728279b50"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52f537d78760f69d0d94d21728279b50">duk_remove</a></div><div class="ttdeci">DUK_EXTERNAL void duk_remove(duk_context *ctx, duk_idx_t index)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l15820">duktape-1.5.2/src-noline/duktape.c:15820</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_a5d2b6c5f1be0d673b074d167c9ff7d4d"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#a5d2b6c5f1be0d673b074d167c9ff7d4d">duk_push_int</a></div><div class="ttdeci">DUK_EXTERNAL void duk_push_int(duk_context *ctx, duk_int_t val)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l17923">duktape-1.5.2/src-noline/duktape.c:17923</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_a5e79d13530031f2f54f993cd89668356"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#a5e79d13530031f2f54f993cd89668356">DUK_HOBJECT_CLASS_AS_FLAGS</a></div><div class="ttdeci">#define DUK_HOBJECT_CLASS_AS_FLAGS(v)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l04688">duktape-1.5.2/src-noline/duktape.c:4688</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_a725b7e935bba993ac308645d3340e21d"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#a725b7e935bba993ac308645d3340e21d">duk_get_string</a></div><div class="ttdeci">DUK_EXTERNAL const char * duk_get_string(duk_context *ctx, duk_idx_t index)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l16109">duktape-1.5.2/src-noline/duktape.c:16109</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_a846c7f411a94ad5b75b2f7a50f7abb50"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#a846c7f411a94ad5b75b2f7a50f7abb50">DUK_STRIDX_LENGTH</a></div><div class="ttdeci">#define DUK_STRIDX_LENGTH</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l01134">duktape-1.5.2/src-noline/duktape.c:1134</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_a8566105ab847d4151b62c29ceab53a0d"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#a8566105ab847d4151b62c29ceab53a0d">duk_dup</a></div><div class="ttdeci">DUK_EXTERNAL void duk_dup(duk_context *ctx, duk_idx_t from_index)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l15702">duktape-1.5.2/src-noline/duktape.c:15702</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_a9077276f5224f3985b570a4d82322253"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#a9077276f5224f3985b570a4d82322253">duk_get_prop_index</a></div><div class="ttdeci">DUK_EXTERNAL duk_bool_t duk_get_prop_index(duk_context *ctx, duk_idx_t obj_index, duk_uarridx_t arr_index)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l14310">duktape-1.5.2/src-noline/duktape.c:14310</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_a97a6adfc8eb4c12296d3c2a4f8dab0a6"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#a97a6adfc8eb4c12296d3c2a4f8dab0a6">duk_push_uint</a></div><div class="ttdeci">DUK_EXTERNAL void duk_push_uint(duk_context *ctx, duk_uint_t val)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l17956">duktape-1.5.2/src-noline/duktape.c:17956</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_aa4de0ba61ed5a4ed0f12f1ddd42dc986"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#aa4de0ba61ed5a4ed0f12f1ddd42dc986">DUK_PROPDESC_FLAGS_WC</a></div><div class="ttdeci">#define DUK_PROPDESC_FLAGS_WC</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l04885">duktape-1.5.2/src-noline/duktape.c:4885</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_ab0bf0a6051955151089916e155e48215"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#ab0bf0a6051955151089916e155e48215">duk_xdef_prop_stridx_thrower</a></div><div class="ttdeci">DUK_INTERNAL_DECL void duk_xdef_prop_stridx_thrower(duk_context *ctx, duk_idx_t obj_index, duk_small_int_t stridx, duk_small_uint_t desc_flags)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l14604">duktape-1.5.2/src-noline/duktape.c:14604</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_ab3861bb2fd293559d606a43da9dca18c"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#ab3861bb2fd293559d606a43da9dca18c">DUK_HOBJECT_FLAG_EXTENSIBLE</a></div><div class="ttdeci">#define DUK_HOBJECT_FLAG_EXTENSIBLE</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l04652">duktape-1.5.2/src-noline/duktape.c:4652</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_ab50dbd6676f214ef04cd8a09b66ffa55"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#ab50dbd6676f214ef04cd8a09b66ffa55">duk_push_object_helper</a></div><div class="ttdeci">DUK_INTERNAL_DECL duk_idx_t duk_push_object_helper(duk_context *ctx, duk_uint_t hobject_flags_and_class, duk_small_int_t prototype_bidx)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l18394">duktape-1.5.2/src-noline/duktape.c:18394</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_ab99e5f8aeaef20e4f61fd2fbf091a190"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#ab99e5f8aeaef20e4f61fd2fbf091a190">DUK_STRIDX_INT_VARENV</a></div><div class="ttdeci">#define DUK_STRIDX_INT_VARENV</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l01191">duktape-1.5.2/src-noline/duktape.c:1191</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_ac44e324c8cc1777c335c7d59a50a4798"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#ac44e324c8cc1777c335c7d59a50a4798">duk_to_string</a></div><div class="ttdeci">DUK_EXTERNAL const char * duk_to_string(duk_context *ctx, duk_idx_t index)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l17089">duktape-1.5.2/src-noline/duktape.c:17089</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_ac8da334e24a5f42f252271161d2116fb"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#ac8da334e24a5f42f252271161d2116fb">duk_pop</a></div><div class="ttdeci">DUK_EXTERNAL void duk_pop(duk_context *ctx)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l19146">duktape-1.5.2/src-noline/duktape.c:19146</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_aca26324ee5830d35a824b1e762ef006c"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#aca26324ee5830d35a824b1e762ef006c">duk_get_hobject</a></div><div class="ttdeci">DUK_INTERNAL_DECL duk_hobject * duk_get_hobject(duk_context *ctx, duk_idx_t index)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l16301">duktape-1.5.2/src-noline/duktape.c:16301</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_aca724f007b73483138017f4d32bb6879"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#aca724f007b73483138017f4d32bb6879">duk_push_hobject</a></div><div class="ttdeci">DUK_INTERNAL_DECL void duk_push_hobject(duk_context *ctx, duk_hobject *h)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l19059">duktape-1.5.2/src-noline/duktape.c:19059</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_acb855972c73d2d6598abe172bbd88ae1"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#acb855972c73d2d6598abe172bbd88ae1">DUK_STRIDX_INT_MAP</a></div><div class="ttdeci">#define DUK_STRIDX_INT_MAP</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l01203">duktape-1.5.2/src-noline/duktape.c:1203</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_acbdcb82a3c6e6881377547f241083edf"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#acbdcb82a3c6e6881377547f241083edf">DUK_STRIDX_CALLEE</a></div><div class="ttdeci">#define DUK_STRIDX_CALLEE</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l01083">duktape-1.5.2/src-noline/duktape.c:1083</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_ad56b7a318e093d42e552c2cf25d492e8"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#ad56b7a318e093d42e552c2cf25d492e8">duk_xdef_prop_stridx</a></div><div class="ttdeci">DUK_INTERNAL_DECL void duk_xdef_prop_stridx(duk_context *ctx, duk_idx_t obj_index, duk_small_int_t stridx, duk_small_uint_t desc_flags)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l14559">duktape-1.5.2/src-noline/duktape.c:14559</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_ada14d1be1c027a164a237f1402c321ab"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#ada14d1be1c027a164a237f1402c321ab">duk_is_string</a></div><div class="ttdeci">DUK_EXTERNAL duk_bool_t duk_is_string(duk_context *ctx, duk_idx_t index)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l17666">duktape-1.5.2/src-noline/duktape.c:17666</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_adf40b7bab50dd909da79a07c1c2f44c2"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#adf40b7bab50dd909da79a07c1c2f44c2">duk_require_int</a></div><div class="ttdeci">DUK_EXTERNAL duk_int_t duk_require_int(duk_context *ctx, duk_idx_t index)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l16052">duktape-1.5.2/src-noline/duktape.c:16052</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_af206aa7e4c9e07c14318015ae02f5e9a"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#af206aa7e4c9e07c14318015ae02f5e9a">DUK_STRIDX_CALLER</a></div><div class="ttdeci">#define DUK_STRIDX_CALLER</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l01086">duktape-1.5.2/src-noline/duktape.c:1086</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_af9f46dba0a3b55d3e78a02b0afa40514"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#af9f46dba0a3b55d3e78a02b0afa40514">DUK_HOBJECT_FLAG_ARRAY_PART</a></div><div class="ttdeci">#define DUK_HOBJECT_FLAG_ARRAY_PART</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l04659">duktape-1.5.2/src-noline/duktape.c:4659</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_af9f80770ce040de69ed8c576f9256920"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#af9f80770ce040de69ed8c576f9256920">duk_has_prop</a></div><div class="ttdeci">DUK_EXTERNAL duk_bool_t duk_has_prop(duk_context *ctx, duk_idx_t obj_index)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l14471">duktape-1.5.2/src-noline/duktape.c:14471</a></div></div>
<div class="ttc" id="astructduk__heaphdr_html"><div class="ttname"><a href="structduk__heaphdr.html">duk_heaphdr</a></div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l03479">duktape-1.5.2/src-noline/duktape.c:3479</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="curl_8h_source.html#l02622">arg</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07755">DUK_ASSERT</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l01632">DUK_BIDX_OBJECT_PROTOTYPE</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07497">DUK_DDD</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07509">DUK_DDDPRINT</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l15702">duk_dup()</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l16301">duk_get_hobject()</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l14310">duk_get_prop_index()</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l14318">duk_get_prop_stridx()</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l16109">duk_get_string()</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l14471">duk_has_prop()</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l04692">DUK_HOBJECT_CLASS_ARGUMENTS</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l04688">DUK_HOBJECT_CLASS_AS_FLAGS</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l04701">DUK_HOBJECT_CLASS_OBJECT</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l04659">DUK_HOBJECT_FLAG_ARRAY_PART</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l04652">DUK_HOBJECT_FLAG_EXTENSIBLE</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l04811">DUK_HOBJECT_HAS_STRICT</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l04779">DUK_HOBJECT_IS_NONBOUND_FUNCTION</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l04839">DUK_HOBJECT_SET_EXOTIC_ARGUMENTS</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l17666">duk_is_string()</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l19146">duk_pop()</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l19167">duk_pop_2()</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l04880">DUK_PROPDESC_FLAGS_NONE</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l04885">DUK_PROPDESC_FLAGS_WC</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l19059">duk_push_hobject()</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l17923">duk_push_int()</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l18394">duk_push_object_helper()</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l17956">duk_push_uint()</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l15820">duk_remove()</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l16305">duk_require_hobject()</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l16052">duk_require_int()</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l15324">duk_require_top_index()</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l01083">DUK_STRIDX_CALLEE</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l01086">DUK_STRIDX_CALLER</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l01182">DUK_STRIDX_INT_FORMALS</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l01203">DUK_STRIDX_INT_MAP</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l01191">DUK_STRIDX_INT_VARENV</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l01134">DUK_STRIDX_LENGTH</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l17089">duk_to_string()</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l04369">duk_xdef_prop_index_wec</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l14559">duk_xdef_prop_stridx()</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l14604">duk_xdef_prop_stridx_thrower()</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l04367">duk_xdef_prop_wec</a>, and <a class="el" href="gmacros_8h_source.html#l00924">NULL</a>.</p>

<p class="reference">Referenced by <a class="el" href="duktape-1_85_82_2src-separate_2duk__js__call_8c_source.html#l00360">duk__handle_createargs_for_call()</a>.</p>

</div>
</div>
<a id="a0ee6d00b24673db60bd1f2df3700c1e2" name="a0ee6d00b24673db60bd1f2df3700c1e2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0ee6d00b24673db60bd1f2df3700c1e2">&#9670;&#160;</a></span>duk__get_idx_func()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a245b431abb36cac1ac8d0eae054ed5c1">DUK_LOCAL</a> <a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a3e3bb369382aab50155c1d18bdf73923">duk_idx_t</a> duk__get_idx_func </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structduk__hthread.html">duk_hthread</a> *</td>          <td class="paramname"><span class="paramname"><em>thr</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a3e3bb369382aab50155c1d18bdf73923">duk_idx_t</a></td>          <td class="paramname"><span class="paramname"><em>num_stack_args</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="duktape-1_85_82_2src-separate_2duk__js__call_8c_source.html#l00922">922</a> of file <a class="el" href="duktape-1_85_82_2src-separate_2duk__js__call_8c_source.html">duktape-1.5.2/src-separate/duk_js_call.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  922</span>                                                                                  {</div>
<div class="line"><span class="lineno">  923</span>    <a class="code hl_typedef" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#ab0a71934d59f38f195fea2f353032392">duk_size_t</a> off_stack_top;</div>
<div class="line"><span class="lineno">  924</span>    <a class="code hl_typedef" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#ab0a71934d59f38f195fea2f353032392">duk_size_t</a> off_stack_args;</div>
<div class="line"><span class="lineno">  925</span>    <a class="code hl_typedef" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#ab0a71934d59f38f195fea2f353032392">duk_size_t</a> off_stack_all;</div>
<div class="line"><span class="lineno">  926</span>    <a class="code hl_typedef" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a3e3bb369382aab50155c1d18bdf73923">duk_idx_t</a> idx_func;         <span class="comment">/* valstack index of &#39;func&#39; and retval (relative to entry valstack_bottom) */</span></div>
<div class="line"><span class="lineno">  927</span> </div>
<div class="line"><span class="lineno">  928</span>    <span class="comment">/* Argument validation and func/args offset. */</span></div>
<div class="line"><span class="lineno">  929</span>    off_stack_top = (<a class="code hl_typedef" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#ab0a71934d59f38f195fea2f353032392">duk_size_t</a>) ((duk_uint8_t *) thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#aec793ffa71623d879a5849bee26687f2">valstack_top</a> - (duk_uint8_t *) thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#ad39b6c03b81eb0f4d3eefda5083988d3">valstack_bottom</a>);</div>
<div class="line"><span class="lineno">  930</span>    off_stack_args = (<a class="code hl_typedef" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#ab0a71934d59f38f195fea2f353032392">duk_size_t</a>) ((<a class="code hl_typedef" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#ab0a71934d59f38f195fea2f353032392">duk_size_t</a>) num_stack_args * <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a9ad3133ae87f4653a6e6183262a5ca3c">duk_tval</a>));</div>
<div class="line"><span class="lineno">  931</span>    off_stack_all = off_stack_args + 2 * <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a9ad3133ae87f4653a6e6183262a5ca3c">duk_tval</a>);</div>
<div class="line"><span class="lineno">  932</span>    <span class="keywordflow">if</span> (<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a6615c9d227b3ed8f7a543fd8e3c5e4c9">DUK_UNLIKELY</a>(off_stack_all &gt; off_stack_top)) {</div>
<div class="line"><span class="lineno">  933</span>        <span class="comment">/* Since stack indices are not reliable, we can&#39;t do anything useful</span></div>
<div class="line"><span class="lineno">  934</span><span class="comment">         * here.  Invoke the existing setjmp catcher, or if it doesn&#39;t exist,</span></div>
<div class="line"><span class="lineno">  935</span><span class="comment">         * call the fatal error handler.</span></div>
<div class="line"><span class="lineno">  936</span><span class="comment">         */</span></div>
<div class="line"><span class="lineno">  937</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a5d7ecc05e08a0af8396793c7d6d9d916">DUK_ERROR_API</a>(thr, <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a2ff85cd89ea1baf8ab0f8bb7e010d9a5">DUK_STR_INVALID_CALL_ARGS</a>);</div>
<div class="line"><span class="lineno">  938</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  939</span>    }</div>
<div class="line"><span class="lineno">  940</span>    idx_func = (<a class="code hl_typedef" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a3e3bb369382aab50155c1d18bdf73923">duk_idx_t</a>) ((off_stack_top - off_stack_all) / <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a9ad3133ae87f4653a6e6183262a5ca3c">duk_tval</a>));</div>
<div class="line"><span class="lineno">  941</span>    <span class="keywordflow">return</span> idx_func;</div>
<div class="line"><span class="lineno">  942</span>}</div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duk__config_8h_html_a6615c9d227b3ed8f7a543fd8e3c5e4c9"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a6615c9d227b3ed8f7a543fd8e3c5e4c9">DUK_UNLIKELY</a></div><div class="ttdeci">#define DUK_UNLIKELY(x)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duk__config_8h_source.html#l02518">duktape-1.5.2/src-noline/duk_config.h:2518</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_a2ff85cd89ea1baf8ab0f8bb7e010d9a5"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#a2ff85cd89ea1baf8ab0f8bb7e010d9a5">DUK_STR_INVALID_CALL_ARGS</a></div><div class="ttdeci">#define DUK_STR_INVALID_CALL_ARGS</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l02279">duktape-1.5.2/src-noline/duktape.c:2279</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_a5d7ecc05e08a0af8396793c7d6d9d916"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#a5d7ecc05e08a0af8396793c7d6d9d916">DUK_ERROR_API</a></div><div class="ttdeci">#define DUK_ERROR_API(thr, msg)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07869">duktape-1.5.2/src-noline/duktape.c:7869</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_a9ad3133ae87f4653a6e6183262a5ca3c"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#a9ad3133ae87f4653a6e6183262a5ca3c">duk_tval</a></div><div class="ttdeci">struct duk_tval_struct duk_tval</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l00614">duktape-1.5.2/src-noline/duktape.c:614</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07869">DUK_ERROR_API</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l02279">DUK_STR_INVALID_CALL_ARGS</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h_source.html#l02518">DUK_UNLIKELY</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06228">duk_hthread::valstack_bottom</a>, and <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06229">duk_hthread::valstack_top</a>.</p>

<p class="reference">Referenced by <a class="el" href="duktape-1_85_82_2src-separate_2duk__js__call_8c_source.html#l00966">duk_handle_call_protected()</a>, and <a class="el" href="duktape-1_85_82_2src-separate_2duk__js__call_8c_source.html#l01147">duk_handle_call_unprotected()</a>.</p>

</div>
</div>
<a id="a115e6a9a6b1b429b9b2df7e546ba8d9c" name="a115e6a9a6b1b429b9b2df7e546ba8d9c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a115e6a9a6b1b429b9b2df7e546ba8d9c">&#9670;&#160;</a></span>duk__handle_bound_chain_for_call()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a245b431abb36cac1ac8d0eae054ed5c1">DUK_LOCAL</a> void duk__handle_bound_chain_for_call </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structduk__hthread.html">duk_hthread</a> *</td>          <td class="paramname"><span class="paramname"><em>thr</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a3e3bb369382aab50155c1d18bdf73923">duk_idx_t</a></td>          <td class="paramname"><span class="paramname"><em>idx_func</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a3e3bb369382aab50155c1d18bdf73923">duk_idx_t</a> *</td>          <td class="paramname"><span class="paramname"><em>p_num_stack_args</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#af32ca4c30431e819676401ce2b11c2e7">duk_bool_t</a></td>          <td class="paramname"><span class="paramname"><em>is_constructor_call</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="duktape-1_85_82_2src-separate_2duk__js__call_8c_source.html#l00406">406</a> of file <a class="el" href="duktape-1_85_82_2src-separate_2duk__js__call_8c_source.html">duktape-1.5.2/src-separate/duk_js_call.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  409</span>                                                                                {</div>
<div class="line"><span class="lineno">  410</span>    <a class="code hl_struct" href="structduk__hthread.html">duk_context</a> *ctx = (<a class="code hl_struct" href="structduk__hthread.html">duk_context</a> *) thr;</div>
<div class="line"><span class="lineno">  411</span>    <a class="code hl_typedef" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a3e3bb369382aab50155c1d18bdf73923">duk_idx_t</a> num_stack_args;</div>
<div class="line"><span class="lineno">  412</span>    <a class="code hl_struct" href="structduk__tval__struct.html">duk_tval</a> *tv_func;</div>
<div class="line"><span class="lineno">  413</span>    <a class="code hl_struct" href="structduk__hobject.html">duk_hobject</a> *func;</div>
<div class="line"><span class="lineno">  414</span>    <a class="code hl_typedef" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#ac176f6049a9cba3519cc353c879e614b">duk_uint_t</a> sanity;</div>
<div class="line"><span class="lineno">  415</span> </div>
<div class="line"><span class="lineno">  416</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(thr != <a class="code hl_define" href="gmacros_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><span class="lineno">  417</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(p_num_stack_args != <a class="code hl_define" href="gmacros_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><span class="lineno">  418</span> </div>
<div class="line"><span class="lineno">  419</span>    <span class="comment">/* On entry, item at idx_func is a bound, non-lightweight function,</span></div>
<div class="line"><span class="lineno">  420</span><span class="comment">     * but we don&#39;t rely on that below.</span></div>
<div class="line"><span class="lineno">  421</span><span class="comment">     */</span></div>
<div class="line"><span class="lineno">  422</span> </div>
<div class="line"><span class="lineno">  423</span>    num_stack_args = *p_num_stack_args;</div>
<div class="line"><span class="lineno">  424</span> </div>
<div class="line"><span class="lineno">  425</span>    sanity = <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#ab15c1898782ebd494a9aac2c1ecf2805">DUK_HOBJECT_BOUND_CHAIN_SANITY</a>;</div>
<div class="line"><span class="lineno">  426</span>    <span class="keywordflow">do</span> {</div>
<div class="line"><span class="lineno">  427</span>        <a class="code hl_typedef" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a3e3bb369382aab50155c1d18bdf73923">duk_idx_t</a> i, len;</div>
<div class="line"><span class="lineno">  428</span> </div>
<div class="line"><span class="lineno">  429</span>        tv_func = <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#aae4918883d66d1a21907da22171fb1c6">duk_require_tval</a>(ctx, idx_func);</div>
<div class="line"><span class="lineno">  430</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(tv_func != <a class="code hl_define" href="gmacros_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><span class="lineno">  431</span> </div>
<div class="line"><span class="lineno">  432</span>        <span class="keywordflow">if</span> (<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a803cbfe1e33fe5c591d7bec4fd3a6a93">DUK_TVAL_IS_LIGHTFUNC</a>(tv_func)) {</div>
<div class="line"><span class="lineno">  433</span>            <span class="comment">/* Lightweight function: never bound, so terminate. */</span></div>
<div class="line"><span class="lineno">  434</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  435</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a3e6da5a54e90086602a9d6f44997d640">DUK_TVAL_IS_OBJECT</a>(tv_func)) {</div>
<div class="line"><span class="lineno">  436</span>            func = <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a2a196d761c3a7789fcc2ac3cf61ad601">DUK_TVAL_GET_OBJECT</a>(tv_func);</div>
<div class="line"><span class="lineno">  437</span>            <span class="keywordflow">if</span> (!<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a1405011142963f5c45c82eb2a881e385">DUK_HOBJECT_HAS_BOUND</a>(func)) {</div>
<div class="line"><span class="lineno">  438</span>                <span class="comment">/* Normal non-bound function. */</span></div>
<div class="line"><span class="lineno">  439</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  440</span>            }</div>
<div class="line"><span class="lineno">  441</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  442</span>            <span class="comment">/* Function.prototype.bind() should never let this happen,</span></div>
<div class="line"><span class="lineno">  443</span><span class="comment">             * ugly error message is enough.</span></div>
<div class="line"><span class="lineno">  444</span><span class="comment">             */</span></div>
<div class="line"><span class="lineno">  445</span>            <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a50bd040ebe622fdf3fbac5a153dce3b7">DUK_ERROR_INTERNAL_DEFMSG</a>(thr);</div>
<div class="line"><span class="lineno">  446</span>        }</div>
<div class="line"><span class="lineno">  447</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a2a196d761c3a7789fcc2ac3cf61ad601">DUK_TVAL_GET_OBJECT</a>(tv_func) != <a class="code hl_define" href="gmacros_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><span class="lineno">  448</span> </div>
<div class="line"><span class="lineno">  449</span>        <span class="comment">/* XXX: this could be more compact by accessing the internal properties</span></div>
<div class="line"><span class="lineno">  450</span><span class="comment">         * directly as own properties (they cannot be inherited, and are not</span></div>
<div class="line"><span class="lineno">  451</span><span class="comment">         * externally visible).</span></div>
<div class="line"><span class="lineno">  452</span><span class="comment">         */</span></div>
<div class="line"><span class="lineno">  453</span> </div>
<div class="line"><span class="lineno">  454</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a2db20d2d3b36d8491ed171cf503488bb">DUK_DDD</a>(<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#aa6e5d41ceaba6832e5ede737f0a35fb9">DUK_DDDPRINT</a>(<span class="stringliteral">&quot;bound function encountered, ptr=%p, num_stack_args=%ld: %!T&quot;</span>,</div>
<div class="line"><span class="lineno">  455</span>                             (<span class="keywordtype">void</span> *) <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a2a196d761c3a7789fcc2ac3cf61ad601">DUK_TVAL_GET_OBJECT</a>(tv_func), (<span class="keywordtype">long</span>) num_stack_args, tv_func));</div>
<div class="line"><span class="lineno">  456</span> </div>
<div class="line"><span class="lineno">  457</span>        <span class="comment">/* [ ... func this arg1 ... argN ] */</span></div>
<div class="line"><span class="lineno">  458</span> </div>
<div class="line"><span class="lineno">  459</span>        <span class="keywordflow">if</span> (is_constructor_call) {</div>
<div class="line"><span class="lineno">  460</span>            <span class="comment">/* See: tests/ecmascript/test-spec-bound-constructor.js */</span></div>
<div class="line"><span class="lineno">  461</span>            <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a2db20d2d3b36d8491ed171cf503488bb">DUK_DDD</a>(<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#aa6e5d41ceaba6832e5ede737f0a35fb9">DUK_DDDPRINT</a>(<span class="stringliteral">&quot;constructor call: don&#39;t update this binding&quot;</span>));</div>
<div class="line"><span class="lineno">  462</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  463</span>            <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a1549987aa437dbcc45cfb63722c834d6">duk_get_prop_stridx</a>(ctx, idx_func, <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a092b7d6212fafe5e1784afd5cc4c8264">DUK_STRIDX_INT_THIS</a>);</div>
<div class="line"><span class="lineno">  464</span>            <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a690921ea90be3a0cb5483cb80f9c3439">duk_replace</a>(ctx, idx_func + 1);  <span class="comment">/* idx_this = idx_func + 1 */</span></div>
<div class="line"><span class="lineno">  465</span>        }</div>
<div class="line"><span class="lineno">  466</span> </div>
<div class="line"><span class="lineno">  467</span>        <span class="comment">/* [ ... func this arg1 ... argN ] */</span></div>
<div class="line"><span class="lineno">  468</span> </div>
<div class="line"><span class="lineno">  469</span>        <span class="comment">/* XXX: duk_get_length? */</span></div>
<div class="line"><span class="lineno">  470</span>        <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a1549987aa437dbcc45cfb63722c834d6">duk_get_prop_stridx</a>(ctx, idx_func, <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a0724c498f12aa318c0feaadfa7af3c2c">DUK_STRIDX_INT_ARGS</a>);  <span class="comment">/* -&gt; [ ... func this arg1 ... argN _Args ] */</span></div>
<div class="line"><span class="lineno">  471</span>        <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a1549987aa437dbcc45cfb63722c834d6">duk_get_prop_stridx</a>(ctx, -1, <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a846c7f411a94ad5b75b2f7a50f7abb50">DUK_STRIDX_LENGTH</a>);          <span class="comment">/* -&gt; [ ... func this arg1 ... argN _Args length ] */</span></div>
<div class="line"><span class="lineno">  472</span>        len = (<a class="code hl_typedef" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a3e3bb369382aab50155c1d18bdf73923">duk_idx_t</a>) <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#adf40b7bab50dd909da79a07c1c2f44c2">duk_require_int</a>(ctx, -1);</div>
<div class="line"><span class="lineno">  473</span>        <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#ac8da334e24a5f42f252271161d2116fb">duk_pop</a>(ctx);</div>
<div class="line"><span class="lineno">  474</span>        <span class="keywordflow">for</span> (i = 0; i &lt; len; i++) {</div>
<div class="line"><span class="lineno">  475</span>            <span class="comment">/* XXX: very slow - better to bulk allocate a gap, and copy</span></div>
<div class="line"><span class="lineno">  476</span><span class="comment">             * from args_array directly (we know it has a compact array</span></div>
<div class="line"><span class="lineno">  477</span><span class="comment">             * part, etc).</span></div>
<div class="line"><span class="lineno">  478</span><span class="comment">             */</span></div>
<div class="line"><span class="lineno">  479</span> </div>
<div class="line"><span class="lineno">  480</span>            <span class="comment">/* [ ... func this &lt;some bound args&gt; arg1 ... argN _Args ] */</span></div>
<div class="line"><span class="lineno">  481</span>            <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a9077276f5224f3985b570a4d82322253">duk_get_prop_index</a>(ctx, -1, i);</div>
<div class="line"><span class="lineno">  482</span>            <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a86e82045aad43776c7280e8e689c5158">duk_insert</a>(ctx, idx_func + 2 + i);  <span class="comment">/* idx_args = idx_func + 2 */</span></div>
<div class="line"><span class="lineno">  483</span>        }</div>
<div class="line"><span class="lineno">  484</span>        num_stack_args += len;  <span class="comment">/* must be updated to work properly (e.g. creation of &#39;arguments&#39;) */</span></div>
<div class="line"><span class="lineno">  485</span>        <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#ac8da334e24a5f42f252271161d2116fb">duk_pop</a>(ctx);</div>
<div class="line"><span class="lineno">  486</span> </div>
<div class="line"><span class="lineno">  487</span>        <span class="comment">/* [ ... func this &lt;bound args&gt; arg1 ... argN ] */</span></div>
<div class="line"><span class="lineno">  488</span> </div>
<div class="line"><span class="lineno">  489</span>        <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a1549987aa437dbcc45cfb63722c834d6">duk_get_prop_stridx</a>(ctx, idx_func, <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a9f607354da0f14e81fb2fe0ab7a5a047">DUK_STRIDX_INT_TARGET</a>);</div>
<div class="line"><span class="lineno">  490</span>        <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a690921ea90be3a0cb5483cb80f9c3439">duk_replace</a>(ctx, idx_func);  <span class="comment">/* replace in stack */</span></div>
<div class="line"><span class="lineno">  491</span> </div>
<div class="line"><span class="lineno">  492</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a2db20d2d3b36d8491ed171cf503488bb">DUK_DDD</a>(<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#aa6e5d41ceaba6832e5ede737f0a35fb9">DUK_DDDPRINT</a>(<span class="stringliteral">&quot;bound function handled, num_stack_args=%ld, idx_func=%ld, curr func=%!T&quot;</span>,</div>
<div class="line"><span class="lineno">  493</span>                             (<span class="keywordtype">long</span>) num_stack_args, (<span class="keywordtype">long</span>) idx_func, <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#afa34aa8c7f880082f9de613ef2bc3c58">duk_get_tval</a>(ctx, idx_func)));</div>
<div class="line"><span class="lineno">  494</span>    } <span class="keywordflow">while</span> (--sanity &gt; 0);</div>
<div class="line"><span class="lineno">  495</span> </div>
<div class="line"><span class="lineno">  496</span>    <span class="keywordflow">if</span> (sanity == 0) {</div>
<div class="line"><span class="lineno">  497</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a058cd56ed742ea766d26976d56c159d4">DUK_ERROR_RANGE</a>(thr, <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#ada57982f1feed5e762515d90ebb14b4f">DUK_STR_BOUND_CHAIN_LIMIT</a>);</div>
<div class="line"><span class="lineno">  498</span>    }</div>
<div class="line"><span class="lineno">  499</span> </div>
<div class="line"><span class="lineno">  500</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a2db20d2d3b36d8491ed171cf503488bb">DUK_DDD</a>(<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#aa6e5d41ceaba6832e5ede737f0a35fb9">DUK_DDDPRINT</a>(<span class="stringliteral">&quot;final non-bound function is: %!T&quot;</span>, <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#afa34aa8c7f880082f9de613ef2bc3c58">duk_get_tval</a>(ctx, idx_func)));</div>
<div class="line"><span class="lineno">  501</span> </div>
<div class="line"><span class="lineno">  502</span><span class="preprocessor">#if defined(DUK_USE_ASSERTIONS)</span></div>
<div class="line"><span class="lineno">  503</span>    tv_func = <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#aae4918883d66d1a21907da22171fb1c6">duk_require_tval</a>(ctx, idx_func);</div>
<div class="line"><span class="lineno">  504</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a803cbfe1e33fe5c591d7bec4fd3a6a93">DUK_TVAL_IS_LIGHTFUNC</a>(tv_func) || <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a3e6da5a54e90086602a9d6f44997d640">DUK_TVAL_IS_OBJECT</a>(tv_func));</div>
<div class="line"><span class="lineno">  505</span>    <span class="keywordflow">if</span> (<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a3e6da5a54e90086602a9d6f44997d640">DUK_TVAL_IS_OBJECT</a>(tv_func)) {</div>
<div class="line"><span class="lineno">  506</span>        func = <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a2a196d761c3a7789fcc2ac3cf61ad601">DUK_TVAL_GET_OBJECT</a>(tv_func);</div>
<div class="line"><span class="lineno">  507</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(func != <a class="code hl_define" href="gmacros_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><span class="lineno">  508</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(!<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a1405011142963f5c45c82eb2a881e385">DUK_HOBJECT_HAS_BOUND</a>(func));</div>
<div class="line"><span class="lineno">  509</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#af4939c11c36b867784c572c276549369">DUK_HOBJECT_HAS_COMPILEDFUNCTION</a>(func) ||</div>
<div class="line"><span class="lineno">  510</span>                   <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a926cbbfc1c31a48c486b9bf4892f6f29">DUK_HOBJECT_HAS_NATIVEFUNCTION</a>(func));</div>
<div class="line"><span class="lineno">  511</span>    }</div>
<div class="line"><span class="lineno">  512</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  513</span> </div>
<div class="line"><span class="lineno">  514</span>    <span class="comment">/* write back */</span></div>
<div class="line"><span class="lineno">  515</span>    *p_num_stack_args = num_stack_args;</div>
<div class="line"><span class="lineno">  516</span>}</div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_a058cd56ed742ea766d26976d56c159d4"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#a058cd56ed742ea766d26976d56c159d4">DUK_ERROR_RANGE</a></div><div class="ttdeci">#define DUK_ERROR_RANGE(thr, msg)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07875">duktape-1.5.2/src-noline/duktape.c:7875</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_a0724c498f12aa318c0feaadfa7af3c2c"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#a0724c498f12aa318c0feaadfa7af3c2c">DUK_STRIDX_INT_ARGS</a></div><div class="ttdeci">#define DUK_STRIDX_INT_ARGS</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l01200">duktape-1.5.2/src-noline/duktape.c:1200</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_a092b7d6212fafe5e1784afd5cc4c8264"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#a092b7d6212fafe5e1784afd5cc4c8264">DUK_STRIDX_INT_THIS</a></div><div class="ttdeci">#define DUK_STRIDX_INT_THIS</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l01224">duktape-1.5.2/src-noline/duktape.c:1224</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_a1405011142963f5c45c82eb2a881e385"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#a1405011142963f5c45c82eb2a881e385">DUK_HOBJECT_HAS_BOUND</a></div><div class="ttdeci">#define DUK_HOBJECT_HAS_BOUND(h)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l04805">duktape-1.5.2/src-noline/duktape.c:4805</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_a2a196d761c3a7789fcc2ac3cf61ad601"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#a2a196d761c3a7789fcc2ac3cf61ad601">DUK_TVAL_GET_OBJECT</a></div><div class="ttdeci">#define DUK_TVAL_GET_OBJECT(tv)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l00787">duktape-1.5.2/src-noline/duktape.c:787</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_a3e6da5a54e90086602a9d6f44997d640"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#a3e6da5a54e90086602a9d6f44997d640">DUK_TVAL_IS_OBJECT</a></div><div class="ttdeci">#define DUK_TVAL_IS_OBJECT(tv)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l00811">duktape-1.5.2/src-noline/duktape.c:811</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_a50bd040ebe622fdf3fbac5a153dce3b7"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#a50bd040ebe622fdf3fbac5a153dce3b7">DUK_ERROR_INTERNAL_DEFMSG</a></div><div class="ttdeci">#define DUK_ERROR_INTERNAL_DEFMSG(thr)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07856">duktape-1.5.2/src-noline/duktape.c:7856</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_a690921ea90be3a0cb5483cb80f9c3439"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#a690921ea90be3a0cb5483cb80f9c3439">duk_replace</a></div><div class="ttdeci">DUK_EXTERNAL void duk_replace(duk_context *ctx, duk_idx_t to_index)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l15780">duktape-1.5.2/src-noline/duktape.c:15780</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_a803cbfe1e33fe5c591d7bec4fd3a6a93"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#a803cbfe1e33fe5c591d7bec4fd3a6a93">DUK_TVAL_IS_LIGHTFUNC</a></div><div class="ttdeci">#define DUK_TVAL_IS_LIGHTFUNC(tv)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l00809">duktape-1.5.2/src-noline/duktape.c:809</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_a86e82045aad43776c7280e8e689c5158"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#a86e82045aad43776c7280e8e689c5158">duk_insert</a></div><div class="ttdeci">DUK_EXTERNAL void duk_insert(duk_context *ctx, duk_idx_t to_index)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l15740">duktape-1.5.2/src-noline/duktape.c:15740</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_a926cbbfc1c31a48c486b9bf4892f6f29"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#a926cbbfc1c31a48c486b9bf4892f6f29">DUK_HOBJECT_HAS_NATIVEFUNCTION</a></div><div class="ttdeci">#define DUK_HOBJECT_HAS_NATIVEFUNCTION(h)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l04807">duktape-1.5.2/src-noline/duktape.c:4807</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_a9f607354da0f14e81fb2fe0ab7a5a047"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#a9f607354da0f14e81fb2fe0ab7a5a047">DUK_STRIDX_INT_TARGET</a></div><div class="ttdeci">#define DUK_STRIDX_INT_TARGET</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l01221">duktape-1.5.2/src-noline/duktape.c:1221</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_aae4918883d66d1a21907da22171fb1c6"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#aae4918883d66d1a21907da22171fb1c6">duk_require_tval</a></div><div class="ttdeci">DUK_INTERNAL_DECL duk_tval * duk_require_tval(duk_context *ctx, duk_idx_t index)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l15149">duktape-1.5.2/src-noline/duktape.c:15149</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_ab15c1898782ebd494a9aac2c1ecf2805"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#ab15c1898782ebd494a9aac2c1ecf2805">DUK_HOBJECT_BOUND_CHAIN_SANITY</a></div><div class="ttdeci">#define DUK_HOBJECT_BOUND_CHAIN_SANITY</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l05201">duktape-1.5.2/src-noline/duktape.c:5201</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_ada57982f1feed5e762515d90ebb14b4f"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#ada57982f1feed5e762515d90ebb14b4f">DUK_STR_BOUND_CHAIN_LIMIT</a></div><div class="ttdeci">#define DUK_STR_BOUND_CHAIN_LIMIT</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l02471">duktape-1.5.2/src-noline/duktape.c:2471</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_af4939c11c36b867784c572c276549369"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#af4939c11c36b867784c572c276549369">DUK_HOBJECT_HAS_COMPILEDFUNCTION</a></div><div class="ttdeci">#define DUK_HOBJECT_HAS_COMPILEDFUNCTION(h)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l04806">duktape-1.5.2/src-noline/duktape.c:4806</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_afa34aa8c7f880082f9de613ef2bc3c58"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#afa34aa8c7f880082f9de613ef2bc3c58">duk_get_tval</a></div><div class="ttdeci">DUK_INTERNAL_DECL duk_tval * duk_get_tval(duk_context *ctx, duk_idx_t index)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l15121">duktape-1.5.2/src-noline/duktape.c:15121</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07755">DUK_ASSERT</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07497">DUK_DDD</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07509">DUK_DDDPRINT</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07856">DUK_ERROR_INTERNAL_DEFMSG</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07875">DUK_ERROR_RANGE</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l14310">duk_get_prop_index()</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l14318">duk_get_prop_stridx()</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l15121">duk_get_tval()</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l05201">DUK_HOBJECT_BOUND_CHAIN_SANITY</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l04805">DUK_HOBJECT_HAS_BOUND</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l04806">DUK_HOBJECT_HAS_COMPILEDFUNCTION</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l04807">DUK_HOBJECT_HAS_NATIVEFUNCTION</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l15740">duk_insert()</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l19146">duk_pop()</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l15780">duk_replace()</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l16052">duk_require_int()</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l15149">duk_require_tval()</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l02471">DUK_STR_BOUND_CHAIN_LIMIT</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l01200">DUK_STRIDX_INT_ARGS</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l01221">DUK_STRIDX_INT_TARGET</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l01224">DUK_STRIDX_INT_THIS</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l01134">DUK_STRIDX_LENGTH</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l00787">DUK_TVAL_GET_OBJECT</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l00809">DUK_TVAL_IS_LIGHTFUNC</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l00811">DUK_TVAL_IS_OBJECT</a>, and <a class="el" href="gmacros_8h_source.html#l00924">NULL</a>.</p>

<p class="reference">Referenced by <a class="el" href="duktape-1_85_82_2src-separate_2duk__js__call_8c_source.html#l00717">duk__nonbound_func_lookup()</a>.</p>

</div>
</div>
<a id="a728ed96bb1fd8bfc94187cd3cb49c369" name="a728ed96bb1fd8bfc94187cd3cb49c369"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a728ed96bb1fd8bfc94187cd3cb49c369">&#9670;&#160;</a></span>duk__handle_call_error()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a245b431abb36cac1ac8d0eae054ed5c1">DUK_LOCAL</a> void duk__handle_call_error </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structduk__hthread.html">duk_hthread</a> *</td>          <td class="paramname"><span class="paramname"><em>thr</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#ab0a71934d59f38f195fea2f353032392">duk_size_t</a></td>          <td class="paramname"><span class="paramname"><em>entry_valstack_bottom_index</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#ab0a71934d59f38f195fea2f353032392">duk_size_t</a></td>          <td class="paramname"><span class="paramname"><em>entry_valstack_end</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#ab0a71934d59f38f195fea2f353032392">duk_size_t</a></td>          <td class="paramname"><span class="paramname"><em>entry_catchstack_top</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#ab0a71934d59f38f195fea2f353032392">duk_size_t</a></td>          <td class="paramname"><span class="paramname"><em>entry_callstack_top</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a9dbc0fdd27e7326d21cbf56e6d40d8a5">duk_int_t</a></td>          <td class="paramname"><span class="paramname"><em>entry_call_recursion_depth</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structduk__hthread.html">duk_hthread</a> *</td>          <td class="paramname"><span class="paramname"><em>entry_curr_thread</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a7ce35d12b12e3eea5f8d46c6195650d1">duk_uint_fast8_t</a></td>          <td class="paramname"><span class="paramname"><em>entry_thread_state</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a9231b6cd154afc387b6282e9bb8e0c6e">duk_instr_t</a> **</td>          <td class="paramname"><span class="paramname"><em>entry_ptr_curr_pc</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a3e3bb369382aab50155c1d18bdf73923">duk_idx_t</a></td>          <td class="paramname"><span class="paramname"><em>idx_func</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structduk__jmpbuf.html">duk_jmpbuf</a> *</td>          <td class="paramname"><span class="paramname"><em>old_jmpbuf_ptr</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="duktape-1_85_82_2src-separate_2duk__js__call_8c_source.html#l01733">1733</a> of file <a class="el" href="duktape-1_85_82_2src-separate_2duk__js__call_8c_source.html">duktape-1.5.2/src-separate/duk_js_call.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1743</span>                                                                  {</div>
<div class="line"><span class="lineno"> 1744</span>    <a class="code hl_struct" href="structduk__hthread.html">duk_context</a> *ctx;</div>
<div class="line"><span class="lineno"> 1745</span>    <a class="code hl_struct" href="structduk__tval__struct.html">duk_tval</a> *tv_ret;</div>
<div class="line"><span class="lineno"> 1746</span> </div>
<div class="line"><span class="lineno"> 1747</span>    ctx = (<a class="code hl_struct" href="structduk__hthread.html">duk_context</a> *) thr;</div>
<div class="line"><span class="lineno"> 1748</span> </div>
<div class="line"><span class="lineno"> 1749</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a2db20d2d3b36d8491ed171cf503488bb">DUK_DDD</a>(<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#aa6e5d41ceaba6832e5ede737f0a35fb9">DUK_DDDPRINT</a>(<span class="stringliteral">&quot;error caught during duk__handle_call_inner(): %!T&quot;</span>,</div>
<div class="line"><span class="lineno"> 1750</span>                         (<a class="code hl_struct" href="structduk__tval__struct.html">duk_tval</a> *) &amp;thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#a1c6d2e1f36b0b7011f0e52343ca5ed05">heap</a>-&gt;<a class="code hl_variable" href="structduk__heap.html#ab564d681186a71065b5d36d4c61c2362">lj</a>.<a class="code hl_variable" href="structduk__ljstate.html#ae1deaf697aee46f178dafbaf5638d438">value1</a>));</div>
<div class="line"><span class="lineno"> 1751</span> </div>
<div class="line"><span class="lineno"> 1752</span>    <span class="comment">/* Other longjmp types are handled by executor before propagating</span></div>
<div class="line"><span class="lineno"> 1753</span><span class="comment">     * the error here.</span></div>
<div class="line"><span class="lineno"> 1754</span><span class="comment">     */</span></div>
<div class="line"><span class="lineno"> 1755</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#a1c6d2e1f36b0b7011f0e52343ca5ed05">heap</a>-&gt;<a class="code hl_variable" href="structduk__heap.html#ab564d681186a71065b5d36d4c61c2362">lj</a>.<a class="code hl_variable" href="structduk__ljstate.html#a3d4e166347f12121174d04b9ed93dbf5">type</a> == <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a01491eeb67c7b39eb79b036bc1e17c16">DUK_LJ_TYPE_THROW</a>);</div>
<div class="line"><span class="lineno"> 1756</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#aea2cca88da9187f43fb2b925ef7f5ee4">callstack_top</a> &gt;= entry_callstack_top);</div>
<div class="line"><span class="lineno"> 1757</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#a52794290185255eb48736c942b07ae04">catchstack_top</a> &gt;= entry_catchstack_top);</div>
<div class="line"><span class="lineno"> 1758</span> </div>
<div class="line"><span class="lineno"> 1759</span>    <span class="comment">/* We don&#39;t need to sync back thr-&gt;ptr_curr_pc here because</span></div>
<div class="line"><span class="lineno"> 1760</span><span class="comment">     * the bytecode executor always has a setjmp catchpoint which</span></div>
<div class="line"><span class="lineno"> 1761</span><span class="comment">     * does that before errors propagate to here.</span></div>
<div class="line"><span class="lineno"> 1762</span><span class="comment">     */</span></div>
<div class="line"><span class="lineno"> 1763</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#a9ceabe6e4ac27d8e61e8f33d4eab55a6">ptr_curr_pc</a> == <a class="code hl_define" href="gmacros_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><span class="lineno"> 1764</span> </div>
<div class="line"><span class="lineno"> 1765</span>    <span class="comment">/* Restore the previous setjmp catcher so that any error in</span></div>
<div class="line"><span class="lineno"> 1766</span><span class="comment">     * error handling will propagate outwards rather than re-enter</span></div>
<div class="line"><span class="lineno"> 1767</span><span class="comment">     * the same handler.  However, the error handling path must be</span></div>
<div class="line"><span class="lineno"> 1768</span><span class="comment">     * designed to be error free so that sandboxing guarantees are</span></div>
<div class="line"><span class="lineno"> 1769</span><span class="comment">     * reliable, see e.g. https://github.com/svaarala/duktape/issues/476.</span></div>
<div class="line"><span class="lineno"> 1770</span><span class="comment">     */</span></div>
<div class="line"><span class="lineno"> 1771</span>    thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#a1c6d2e1f36b0b7011f0e52343ca5ed05">heap</a>-&gt;<a class="code hl_variable" href="structduk__heap.html#ab564d681186a71065b5d36d4c61c2362">lj</a>.<a class="code hl_variable" href="structduk__ljstate.html#a035175485b99338b27871a1b4925b7d8">jmpbuf_ptr</a> = old_jmpbuf_ptr;</div>
<div class="line"><span class="lineno"> 1772</span> </div>
<div class="line"><span class="lineno"> 1773</span>    <span class="comment">/* XXX: callstack unwind may now throw an error when closing</span></div>
<div class="line"><span class="lineno"> 1774</span><span class="comment">     * scopes; this is a sandboxing issue, described in:</span></div>
<div class="line"><span class="lineno"> 1775</span><span class="comment">     * https://github.com/svaarala/duktape/issues/476</span></div>
<div class="line"><span class="lineno"> 1776</span><span class="comment">     */</span></div>
<div class="line"><span class="lineno"> 1777</span>    <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a293c800100000f744f86bd30ddedaae3">duk_hthread_catchstack_unwind</a>(thr, entry_catchstack_top);</div>
<div class="line"><span class="lineno"> 1778</span>    <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a2280c7ff345d34b3b66982df21218c47">duk_hthread_catchstack_shrink_check</a>(thr);</div>
<div class="line"><span class="lineno"> 1779</span>    <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a6b0424c9d50c491ab32e7605cd9fdae2">duk_hthread_callstack_unwind</a>(thr, entry_callstack_top);</div>
<div class="line"><span class="lineno"> 1780</span>    <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#ab1328365d06bb689313bd28bdc006fbe">duk_hthread_callstack_shrink_check</a>(thr);</div>
<div class="line"><span class="lineno"> 1781</span> </div>
<div class="line"><span class="lineno"> 1782</span>    thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#ad39b6c03b81eb0f4d3eefda5083988d3">valstack_bottom</a> = thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#a08f58ff5b9fa5927891c2e08712e3971">valstack</a> + entry_valstack_bottom_index;</div>
<div class="line"><span class="lineno"> 1783</span>    tv_ret = thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#ad39b6c03b81eb0f4d3eefda5083988d3">valstack_bottom</a> + idx_func;  <span class="comment">/* XXX: byte offset? */</span></div>
<div class="line"><span class="lineno"> 1784</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a707d3bb6b36563e69505b66a9b7335cf">DUK_TVAL_SET_TVAL_UPDREF</a>(thr, tv_ret, &amp;thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#a1c6d2e1f36b0b7011f0e52343ca5ed05">heap</a>-&gt;<a class="code hl_variable" href="structduk__heap.html#ab564d681186a71065b5d36d4c61c2362">lj</a>.<a class="code hl_variable" href="structduk__ljstate.html#ae1deaf697aee46f178dafbaf5638d438">value1</a>);  <span class="comment">/* side effects */</span></div>
<div class="line"><span class="lineno"> 1785</span><span class="preprocessor">#if defined(DUK_USE_FASTINT)</span></div>
<div class="line"><span class="lineno"> 1786</span>    <span class="comment">/* Explicit check for fastint downgrade. */</span></div>
<div class="line"><span class="lineno"> 1787</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a85bcc7dd51670c32e9be58375e1bf618">DUK_TVAL_CHKFAST_INPLACE</a>(tv_ret);</div>
<div class="line"><span class="lineno"> 1788</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1789</span>    <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a808471cbdda897175b2e4d50528c430d">duk_set_top</a>(ctx, idx_func + 1);  <span class="comment">/* XXX: could be eliminated with valstack adjust */</span></div>
<div class="line"><span class="lineno"> 1790</span> </div>
<div class="line"><span class="lineno"> 1791</span>    <span class="comment">/* [ ... errobj ] */</span></div>
<div class="line"><span class="lineno"> 1792</span> </div>
<div class="line"><span class="lineno"> 1793</span>    <span class="comment">/* Ensure there is internal valstack spare before we exit; this may</span></div>
<div class="line"><span class="lineno"> 1794</span><span class="comment">     * throw an alloc error.  The same guaranteed size must be available</span></div>
<div class="line"><span class="lineno"> 1795</span><span class="comment">     * as before the call.  This is not optimal now: we store the valstack</span></div>
<div class="line"><span class="lineno"> 1796</span><span class="comment">     * allocated size during entry; this value may be higher than the</span></div>
<div class="line"><span class="lineno"> 1797</span><span class="comment">     * minimal guarantee for an application.</span></div>
<div class="line"><span class="lineno"> 1798</span><span class="comment">     */</span></div>
<div class="line"><span class="lineno"> 1799</span> </div>
<div class="line"><span class="lineno"> 1800</span>    <span class="comment">/* XXX: this needs to be reworked so that we never shrink the value</span></div>
<div class="line"><span class="lineno"> 1801</span><span class="comment">     * stack on function entry so that we never need to grow it here.</span></div>
<div class="line"><span class="lineno"> 1802</span><span class="comment">     * Needing to grow here is a sandboxing issue because we need to</span></div>
<div class="line"><span class="lineno"> 1803</span><span class="comment">     * allocate which may cause an error in the error handling path</span></div>
<div class="line"><span class="lineno"> 1804</span><span class="comment">     * and thus propagate an error out of a protected call.</span></div>
<div class="line"><span class="lineno"> 1805</span><span class="comment">     */</span></div>
<div class="line"><span class="lineno"> 1806</span> </div>
<div class="line"><span class="lineno"> 1807</span>    (void) <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a77c10520e83828337093fb75217c8994">duk_valstack_resize_raw</a>((<a class="code hl_struct" href="structduk__hthread.html">duk_context</a> *) thr,</div>
<div class="line"><span class="lineno"> 1808</span>                                   entry_valstack_end,                    <span class="comment">/* same as during entry */</span></div>
<div class="line"><span class="lineno"> 1809</span>                                   <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bb7e485dd3c5ecda5f3b08f5b0fd58">DUK_VSRESIZE_FLAG_SHRINK</a> |             <span class="comment">/* flags */</span></div>
<div class="line"><span class="lineno"> 1810</span>                                   <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a7a92ed8b660abc5849cd6db4a762598f">DUK_VSRESIZE_FLAG_COMPACT</a> |</div>
<div class="line"><span class="lineno"> 1811</span>                                   <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a207c421ba76ecb41b4ae7df1ef829112">DUK_VSRESIZE_FLAG_THROW</a>);</div>
<div class="line"><span class="lineno"> 1812</span> </div>
<div class="line"><span class="lineno"> 1813</span> </div>
<div class="line"><span class="lineno"> 1814</span>    <span class="comment">/* These are just convenience &quot;wiping&quot; of state.  Side effects should</span></div>
<div class="line"><span class="lineno"> 1815</span><span class="comment">     * not be an issue here: thr-&gt;heap and thr-&gt;heap-&gt;lj have a stable</span></div>
<div class="line"><span class="lineno"> 1816</span><span class="comment">     * pointer.  Finalizer runs etc capture even out-of-memory errors so</span></div>
<div class="line"><span class="lineno"> 1817</span><span class="comment">     * nothing should throw here.</span></div>
<div class="line"><span class="lineno"> 1818</span><span class="comment">     */</span></div>
<div class="line"><span class="lineno"> 1819</span>    thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#a1c6d2e1f36b0b7011f0e52343ca5ed05">heap</a>-&gt;<a class="code hl_variable" href="structduk__heap.html#ab564d681186a71065b5d36d4c61c2362">lj</a>.<a class="code hl_variable" href="structduk__ljstate.html#a3d4e166347f12121174d04b9ed93dbf5">type</a> = <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a6af5993d9334f7a01bbc1219671ca5ea">DUK_LJ_TYPE_UNKNOWN</a>;</div>
<div class="line"><span class="lineno"> 1820</span>    thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#a1c6d2e1f36b0b7011f0e52343ca5ed05">heap</a>-&gt;<a class="code hl_variable" href="structduk__heap.html#ab564d681186a71065b5d36d4c61c2362">lj</a>.<a class="code hl_variable" href="structduk__ljstate.html#a6ec0311d74ac88b57bc24ab5b149e3f9">iserror</a> = 0;</div>
<div class="line"><span class="lineno"> 1821</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#acb7d8467c90d4c8f1c772eaff56f70e9">DUK_TVAL_SET_UNDEFINED_UPDREF</a>(thr, &amp;thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#a1c6d2e1f36b0b7011f0e52343ca5ed05">heap</a>-&gt;<a class="code hl_variable" href="structduk__heap.html#ab564d681186a71065b5d36d4c61c2362">lj</a>.<a class="code hl_variable" href="structduk__ljstate.html#ae1deaf697aee46f178dafbaf5638d438">value1</a>);  <span class="comment">/* side effects */</span></div>
<div class="line"><span class="lineno"> 1822</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#acb7d8467c90d4c8f1c772eaff56f70e9">DUK_TVAL_SET_UNDEFINED_UPDREF</a>(thr, &amp;thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#a1c6d2e1f36b0b7011f0e52343ca5ed05">heap</a>-&gt;<a class="code hl_variable" href="structduk__heap.html#ab564d681186a71065b5d36d4c61c2362">lj</a>.<a class="code hl_variable" href="structduk__ljstate.html#a8d28969876a04123a2206617267c1384">value2</a>);  <span class="comment">/* side effects */</span></div>
<div class="line"><span class="lineno"> 1823</span> </div>
<div class="line"><span class="lineno"> 1824</span>    <span class="comment">/* Restore entry thread executor curr_pc stack frame pointer. */</span></div>
<div class="line"><span class="lineno"> 1825</span>    thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#a9ceabe6e4ac27d8e61e8f33d4eab55a6">ptr_curr_pc</a> = entry_ptr_curr_pc;</div>
<div class="line"><span class="lineno"> 1826</span> </div>
<div class="line"><span class="lineno"> 1827</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#ada39afa145c10879d68bc705850edcd7">DUK_HEAP_SWITCH_THREAD</a>(thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#a1c6d2e1f36b0b7011f0e52343ca5ed05">heap</a>, entry_curr_thread);  <span class="comment">/* may be NULL */</span></div>
<div class="line"><span class="lineno"> 1828</span>    thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#a4dc5dc48406aa6240185468557d154dc">state</a> = (duk_uint8_t) entry_thread_state;</div>
<div class="line"><span class="lineno"> 1829</span> </div>
<div class="line"><span class="lineno"> 1830</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>((thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#a4dc5dc48406aa6240185468557d154dc">state</a> == <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a60d14816853d0b43d8f6e2d033a9df60">DUK_HTHREAD_STATE_INACTIVE</a> &amp;&amp; thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#a1c6d2e1f36b0b7011f0e52343ca5ed05">heap</a>-&gt;<a class="code hl_variable" href="structduk__heap.html#a1f913439bf8af92c753891bea8abda78">curr_thread</a> == <a class="code hl_define" href="gmacros_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) ||  <span class="comment">/* first call */</span></div>
<div class="line"><span class="lineno"> 1831</span>               (thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#a4dc5dc48406aa6240185468557d154dc">state</a> == <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a60d14816853d0b43d8f6e2d033a9df60">DUK_HTHREAD_STATE_INACTIVE</a> &amp;&amp; thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#a1c6d2e1f36b0b7011f0e52343ca5ed05">heap</a>-&gt;<a class="code hl_variable" href="structduk__heap.html#a1f913439bf8af92c753891bea8abda78">curr_thread</a> != <a class="code hl_define" href="gmacros_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) ||  <span class="comment">/* other call */</span></div>
<div class="line"><span class="lineno"> 1832</span>               (thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#a4dc5dc48406aa6240185468557d154dc">state</a> == <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a82ed1e61fa4a768cbc65401274bfd89a">DUK_HTHREAD_STATE_RUNNING</a> &amp;&amp; thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#a1c6d2e1f36b0b7011f0e52343ca5ed05">heap</a>-&gt;<a class="code hl_variable" href="structduk__heap.html#a1f913439bf8af92c753891bea8abda78">curr_thread</a> == thr));     <span class="comment">/* current thread */</span></div>
<div class="line"><span class="lineno"> 1833</span> </div>
<div class="line"><span class="lineno"> 1834</span>    thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#a1c6d2e1f36b0b7011f0e52343ca5ed05">heap</a>-&gt;<a class="code hl_variable" href="structduk__heap.html#ab229eef9c6b0d7fcd267527a4b107fe5">call_recursion_depth</a> = entry_call_recursion_depth;</div>
<div class="line"><span class="lineno"> 1835</span> </div>
<div class="line"><span class="lineno"> 1836</span>    <span class="comment">/* If the debugger is active we need to force an interrupt so that</span></div>
<div class="line"><span class="lineno"> 1837</span><span class="comment">     * debugger breakpoints are rechecked.  This is important for function</span></div>
<div class="line"><span class="lineno"> 1838</span><span class="comment">     * calls caused by side effects (e.g. when doing a DUK_OP_GETPROP), see</span></div>
<div class="line"><span class="lineno"> 1839</span><span class="comment">     * GH-303.  Only needed for success path, error path always causes a</span></div>
<div class="line"><span class="lineno"> 1840</span><span class="comment">     * breakpoint recheck in the executor.  It would be enough to set this</span></div>
<div class="line"><span class="lineno"> 1841</span><span class="comment">     * only when returning to an Ecmascript activation, but setting the flag</span></div>
<div class="line"><span class="lineno"> 1842</span><span class="comment">     * on every return should have no ill effect.</span></div>
<div class="line"><span class="lineno"> 1843</span><span class="comment">     */</span></div>
<div class="line"><span class="lineno"> 1844</span><span class="preprocessor">#if defined(DUK_USE_DEBUGGER_SUPPORT)</span></div>
<div class="line"><span class="lineno"> 1845</span>    <span class="keywordflow">if</span> (DUK_HEAP_IS_DEBUGGER_ATTACHED(thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#a1c6d2e1f36b0b7011f0e52343ca5ed05">heap</a>)) {</div>
<div class="line"><span class="lineno"> 1846</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a6c3a2adb6e09294c7e65f69821e5e81a">DUK_DD</a>(<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#aa66ca9adc2b4187c5d549a9b117b03d3">DUK_DDPRINT</a>(<span class="stringliteral">&quot;returning with debugger enabled, force interrupt&quot;</span>));</div>
<div class="line"><span class="lineno"> 1847</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(thr-&gt;interrupt_counter &lt;= thr-&gt;interrupt_init);</div>
<div class="line"><span class="lineno"> 1848</span>        thr-&gt;interrupt_init -= thr-&gt;interrupt_counter;</div>
<div class="line"><span class="lineno"> 1849</span>        thr-&gt;interrupt_counter = 0;</div>
<div class="line"><span class="lineno"> 1850</span>        thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#a1c6d2e1f36b0b7011f0e52343ca5ed05">heap</a>-&gt;dbg_force_restart = 1;</div>
<div class="line"><span class="lineno"> 1851</span>    }</div>
<div class="line"><span class="lineno"> 1852</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1853</span> </div>
<div class="line"><span class="lineno"> 1854</span><span class="preprocessor">#if defined(DUK_USE_INTERRUPT_COUNTER) &amp;&amp; defined(DUK_USE_DEBUG)</span></div>
<div class="line"><span class="lineno"> 1855</span>    duk__interrupt_fixup(thr, entry_curr_thread);</div>
<div class="line"><span class="lineno"> 1856</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1857</span>}</div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_a01491eeb67c7b39eb79b036bc1e17c16"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#a01491eeb67c7b39eb79b036bc1e17c16">DUK_LJ_TYPE_THROW</a></div><div class="ttdeci">#define DUK_LJ_TYPE_THROW</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06702">duktape-1.5.2/src-noline/duktape.c:6702</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_a2280c7ff345d34b3b66982df21218c47"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#a2280c7ff345d34b3b66982df21218c47">duk_hthread_catchstack_shrink_check</a></div><div class="ttdeci">DUK_INTERNAL_DECL void duk_hthread_catchstack_shrink_check(duk_hthread *thr)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l54522">duktape-1.5.2/src-noline/duktape.c:54522</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_a293c800100000f744f86bd30ddedaae3"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#a293c800100000f744f86bd30ddedaae3">duk_hthread_catchstack_unwind</a></div><div class="ttdeci">DUK_INTERNAL_DECL void duk_hthread_catchstack_unwind(duk_hthread *thr, duk_size_t new_top)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l54560">duktape-1.5.2/src-noline/duktape.c:54560</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_a60d14816853d0b43d8f6e2d033a9df60"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#a60d14816853d0b43d8f6e2d033a9df60">DUK_HTHREAD_STATE_INACTIVE</a></div><div class="ttdeci">#define DUK_HTHREAD_STATE_INACTIVE</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06076">duktape-1.5.2/src-noline/duktape.c:6076</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_a6af5993d9334f7a01bbc1219671ca5ea"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#a6af5993d9334f7a01bbc1219671ca5ea">DUK_LJ_TYPE_UNKNOWN</a></div><div class="ttdeci">#define DUK_LJ_TYPE_UNKNOWN</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06701">duktape-1.5.2/src-noline/duktape.c:6701</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_a6b0424c9d50c491ab32e7605cd9fdae2"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#a6b0424c9d50c491ab32e7605cd9fdae2">duk_hthread_callstack_unwind</a></div><div class="ttdeci">DUK_INTERNAL_DECL void duk_hthread_callstack_unwind(duk_hthread *thr, duk_size_t new_top)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l54255">duktape-1.5.2/src-noline/duktape.c:54255</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_a6c3a2adb6e09294c7e65f69821e5e81a"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#a6c3a2adb6e09294c7e65f69821e5e81a">DUK_DD</a></div><div class="ttdeci">#define DUK_DD(x)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07496">duktape-1.5.2/src-noline/duktape.c:7496</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_a707d3bb6b36563e69505b66a9b7335cf"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#a707d3bb6b36563e69505b66a9b7335cf">DUK_TVAL_SET_TVAL_UPDREF</a></div><div class="ttdeci">#define DUK_TVAL_SET_TVAL_UPDREF</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l04029">duktape-1.5.2/src-noline/duktape.c:4029</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_a7a92ed8b660abc5849cd6db4a762598f"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#a7a92ed8b660abc5849cd6db4a762598f">DUK_VSRESIZE_FLAG_COMPACT</a></div><div class="ttdeci">#define DUK_VSRESIZE_FLAG_COMPACT</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l04221">duktape-1.5.2/src-noline/duktape.c:4221</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_a82ed1e61fa4a768cbc65401274bfd89a"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#a82ed1e61fa4a768cbc65401274bfd89a">DUK_HTHREAD_STATE_RUNNING</a></div><div class="ttdeci">#define DUK_HTHREAD_STATE_RUNNING</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06077">duktape-1.5.2/src-noline/duktape.c:6077</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_a85bcc7dd51670c32e9be58375e1bf618"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#a85bcc7dd51670c32e9be58375e1bf618">DUK_TVAL_CHKFAST_INPLACE</a></div><div class="ttdeci">#define DUK_TVAL_CHKFAST_INPLACE(v)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l00720">duktape-1.5.2/src-noline/duktape.c:720</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_aa66ca9adc2b4187c5d549a9b117b03d3"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#aa66ca9adc2b4187c5d549a9b117b03d3">DUK_DDPRINT</a></div><div class="ttdeci">#define DUK_DDPRINT</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07508">duktape-1.5.2/src-noline/duktape.c:7508</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_ab1328365d06bb689313bd28bdc006fbe"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#ab1328365d06bb689313bd28bdc006fbe">duk_hthread_callstack_shrink_check</a></div><div class="ttdeci">DUK_INTERNAL_DECL void duk_hthread_callstack_shrink_check(duk_hthread *thr)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l54217">duktape-1.5.2/src-noline/duktape.c:54217</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_acb7d8467c90d4c8f1c772eaff56f70e9"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#acb7d8467c90d4c8f1c772eaff56f70e9">DUK_TVAL_SET_UNDEFINED_UPDREF</a></div><div class="ttdeci">#define DUK_TVAL_SET_UNDEFINED_UPDREF</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l04004">duktape-1.5.2/src-noline/duktape.c:4004</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_ada39afa145c10879d68bc705850edcd7"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#ada39afa145c10879d68bc705850edcd7">DUK_HEAP_SWITCH_THREAD</a></div><div class="ttdeci">#define DUK_HEAP_SWITCH_THREAD(heap, newthr)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06735">duktape-1.5.2/src-noline/duktape.c:6735</a></div></div>
<div class="ttc" id="astructduk__heap_html_a1f913439bf8af92c753891bea8abda78"><div class="ttname"><a href="structduk__heap.html#a1f913439bf8af92c753891bea8abda78">duk_heap::curr_thread</a></div><div class="ttdeci">duk_hthread * curr_thread</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07044">duktape-1.5.2/src-noline/duktape.c:7044</a></div></div>
<div class="ttc" id="astructduk__heap_html_ab229eef9c6b0d7fcd267527a4b107fe5"><div class="ttname"><a href="structduk__heap.html#ab229eef9c6b0d7fcd267527a4b107fe5">duk_heap::call_recursion_depth</a></div><div class="ttdeci">duk_int_t call_recursion_depth</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07050">duktape-1.5.2/src-noline/duktape.c:7050</a></div></div>
<div class="ttc" id="astructduk__heap_html_ab564d681186a71065b5d36d4c61c2362"><div class="ttname"><a href="structduk__heap.html#ab564d681186a71065b5d36d4c61c2362">duk_heap::lj</a></div><div class="ttdeci">duk_ljstate lj</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07035">duktape-1.5.2/src-noline/duktape.c:7035</a></div></div>
<div class="ttc" id="astructduk__hthread_html_a1c6d2e1f36b0b7011f0e52343ca5ed05"><div class="ttname"><a href="structduk__hthread.html#a1c6d2e1f36b0b7011f0e52343ca5ed05">duk_hthread::heap</a></div><div class="ttdeci">duk_heap * heap</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06202">duktape-1.5.2/src-noline/duktape.c:6202</a></div></div>
<div class="ttc" id="astructduk__hthread_html_a4dc5dc48406aa6240185468557d154dc"><div class="ttname"><a href="structduk__hthread.html#a4dc5dc48406aa6240185468557d154dc">duk_hthread::state</a></div><div class="ttdeci">duk_uint8_t state</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06208">duktape-1.5.2/src-noline/duktape.c:6208</a></div></div>
<div class="ttc" id="astructduk__hthread_html_a52794290185255eb48736c942b07ae04"><div class="ttname"><a href="structduk__hthread.html#a52794290185255eb48736c942b07ae04">duk_hthread::catchstack_top</a></div><div class="ttdeci">duk_size_t catchstack_top</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06243">duktape-1.5.2/src-noline/duktape.c:6243</a></div></div>
<div class="ttc" id="astructduk__hthread_html_a9ceabe6e4ac27d8e61e8f33d4eab55a6"><div class="ttname"><a href="structduk__hthread.html#a9ceabe6e4ac27d8e61e8f33d4eab55a6">duk_hthread::ptr_curr_pc</a></div><div class="ttdeci">duk_instr_t ** ptr_curr_pc</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06199">duktape-1.5.2/src-noline/duktape.c:6199</a></div></div>
<div class="ttc" id="astructduk__hthread_html_aea2cca88da9187f43fb2b925ef7f5ee4"><div class="ttname"><a href="structduk__hthread.html#aea2cca88da9187f43fb2b925ef7f5ee4">duk_hthread::callstack_top</a></div><div class="ttdeci">duk_size_t callstack_top</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06237">duktape-1.5.2/src-noline/duktape.c:6237</a></div></div>
<div class="ttc" id="astructduk__ljstate_html_a035175485b99338b27871a1b4925b7d8"><div class="ttname"><a href="structduk__ljstate.html#a035175485b99338b27871a1b4925b7d8">duk_ljstate::jmpbuf_ptr</a></div><div class="ttdeci">duk_jmpbuf * jmpbuf_ptr</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06948">duktape-1.5.2/src-noline/duktape.c:6948</a></div></div>
<div class="ttc" id="astructduk__ljstate_html_a3d4e166347f12121174d04b9ed93dbf5"><div class="ttname"><a href="structduk__ljstate.html#a3d4e166347f12121174d04b9ed93dbf5">duk_ljstate::type</a></div><div class="ttdeci">duk_small_uint_t type</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06949">duktape-1.5.2/src-noline/duktape.c:6949</a></div></div>
<div class="ttc" id="astructduk__ljstate_html_a6ec0311d74ac88b57bc24ab5b149e3f9"><div class="ttname"><a href="structduk__ljstate.html#a6ec0311d74ac88b57bc24ab5b149e3f9">duk_ljstate::iserror</a></div><div class="ttdeci">duk_bool_t iserror</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06950">duktape-1.5.2/src-noline/duktape.c:6950</a></div></div>
<div class="ttc" id="astructduk__ljstate_html_a8d28969876a04123a2206617267c1384"><div class="ttname"><a href="structduk__ljstate.html#a8d28969876a04123a2206617267c1384">duk_ljstate::value2</a></div><div class="ttdeci">duk_tval value2</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06952">duktape-1.5.2/src-noline/duktape.c:6952</a></div></div>
<div class="ttc" id="astructduk__ljstate_html_ae1deaf697aee46f178dafbaf5638d438"><div class="ttname"><a href="structduk__ljstate.html#ae1deaf697aee46f178dafbaf5638d438">duk_ljstate::value1</a></div><div class="ttdeci">duk_tval value1</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06951">duktape-1.5.2/src-noline/duktape.c:6951</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07050">duk_heap::call_recursion_depth</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06237">duk_hthread::callstack_top</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06243">duk_hthread::catchstack_top</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07044">duk_heap::curr_thread</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07755">DUK_ASSERT</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07496">DUK_DD</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07497">DUK_DDD</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07509">DUK_DDDPRINT</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07508">DUK_DDPRINT</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06735">DUK_HEAP_SWITCH_THREAD</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l54217">duk_hthread_callstack_shrink_check()</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l54255">duk_hthread_callstack_unwind()</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l54522">duk_hthread_catchstack_shrink_check()</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l54560">duk_hthread_catchstack_unwind()</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06076">DUK_HTHREAD_STATE_INACTIVE</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06077">DUK_HTHREAD_STATE_RUNNING</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06702">DUK_LJ_TYPE_THROW</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06701">DUK_LJ_TYPE_UNKNOWN</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l15216">duk_set_top()</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l00720">DUK_TVAL_CHKFAST_INPLACE</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l04029">DUK_TVAL_SET_TVAL_UPDREF</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l04004">DUK_TVAL_SET_UNDEFINED_UPDREF</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l15491">duk_valstack_resize_raw()</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l04221">DUK_VSRESIZE_FLAG_COMPACT</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l04220">DUK_VSRESIZE_FLAG_SHRINK</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l04222">DUK_VSRESIZE_FLAG_THROW</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06202">duk_hthread::heap</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06950">duk_ljstate::iserror</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06948">duk_ljstate::jmpbuf_ptr</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07035">duk_heap::lj</a>, <a class="el" href="gmacros_8h_source.html#l00924">NULL</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06199">duk_hthread::ptr_curr_pc</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06208">duk_hthread::state</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06949">duk_ljstate::type</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06226">duk_hthread::valstack</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06228">duk_hthread::valstack_bottom</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06951">duk_ljstate::value1</a>, and <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06952">duk_ljstate::value2</a>.</p>

<p class="reference">Referenced by <a class="el" href="duktape-1_85_82_2src-separate_2duk__js__call_8c_source.html#l00966">duk_handle_call_protected()</a>.</p>

</div>
</div>
<a id="a6f05358775a8df038c9b0850c9e3f8a9" name="a6f05358775a8df038c9b0850c9e3f8a9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6f05358775a8df038c9b0850c9e3f8a9">&#9670;&#160;</a></span>duk__handle_call_inner()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a245b431abb36cac1ac8d0eae054ed5c1">DUK_LOCAL</a> void duk__handle_call_inner </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structduk__hthread.html">duk_hthread</a> *</td>          <td class="paramname"><span class="paramname"><em>thr</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a3e3bb369382aab50155c1d18bdf73923">duk_idx_t</a></td>          <td class="paramname"><span class="paramname"><em>num_stack_args</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a2b7ba45bf826058a9b7720b5e258efc6">duk_small_uint_t</a></td>          <td class="paramname"><span class="paramname"><em>call_flags</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a3e3bb369382aab50155c1d18bdf73923">duk_idx_t</a></td>          <td class="paramname"><span class="paramname"><em>idx_func</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="duktape-1_85_82_2src-separate_2duk__js__call_8c_source.html#l01158">1158</a> of file <a class="el" href="duktape-1_85_82_2src-separate_2duk__js__call_8c_source.html">duktape-1.5.2/src-separate/duk_js_call.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1161</span>                                                          {</div>
<div class="line"><span class="lineno"> 1162</span>    <a class="code hl_struct" href="structduk__hthread.html">duk_context</a> *ctx;</div>
<div class="line"><span class="lineno"> 1163</span>    <a class="code hl_typedef" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#ab0a71934d59f38f195fea2f353032392">duk_size_t</a> entry_valstack_bottom_index;</div>
<div class="line"><span class="lineno"> 1164</span>    <a class="code hl_typedef" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#ab0a71934d59f38f195fea2f353032392">duk_size_t</a> entry_valstack_end;</div>
<div class="line"><span class="lineno"> 1165</span>    <a class="code hl_typedef" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#ab0a71934d59f38f195fea2f353032392">duk_size_t</a> entry_callstack_top;</div>
<div class="line"><span class="lineno"> 1166</span>    <a class="code hl_typedef" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#ab0a71934d59f38f195fea2f353032392">duk_size_t</a> entry_catchstack_top;</div>
<div class="line"><span class="lineno"> 1167</span>    <a class="code hl_typedef" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a9dbc0fdd27e7326d21cbf56e6d40d8a5">duk_int_t</a> entry_call_recursion_depth;</div>
<div class="line"><span class="lineno"> 1168</span>    <a class="code hl_struct" href="structduk__hthread.html">duk_hthread</a> *entry_curr_thread;</div>
<div class="line"><span class="lineno"> 1169</span>    <a class="code hl_typedef" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a7ce35d12b12e3eea5f8d46c6195650d1">duk_uint_fast8_t</a> entry_thread_state;</div>
<div class="line"><span class="lineno"> 1170</span>    <a class="code hl_typedef" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a9231b6cd154afc387b6282e9bb8e0c6e">duk_instr_t</a> **entry_ptr_curr_pc;</div>
<div class="line"><span class="lineno"> 1171</span>    <a class="code hl_typedef" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a3e3bb369382aab50155c1d18bdf73923">duk_idx_t</a> nargs;            <span class="comment">/* # argument registers target function wants (&lt; 0 =&gt; &quot;as is&quot;) */</span></div>
<div class="line"><span class="lineno"> 1172</span>    <a class="code hl_typedef" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a3e3bb369382aab50155c1d18bdf73923">duk_idx_t</a> nregs;            <span class="comment">/* # total registers target function wants on entry (&lt; 0 =&gt; &quot;as is&quot;) */</span></div>
<div class="line"><span class="lineno"> 1173</span>    <a class="code hl_struct" href="structduk__hobject.html">duk_hobject</a> *func;          <span class="comment">/* &#39;func&#39; on stack (borrowed reference) */</span></div>
<div class="line"><span class="lineno"> 1174</span>    <a class="code hl_struct" href="structduk__tval__struct.html">duk_tval</a> *tv_func;          <span class="comment">/* duk_tval ptr for &#39;func&#39; on stack (borrowed reference) or tv_func_copy */</span></div>
<div class="line"><span class="lineno"> 1175</span>    <a class="code hl_struct" href="structduk__tval__struct.html">duk_tval</a> tv_func_copy;      <span class="comment">/* to avoid relookups */</span></div>
<div class="line"><span class="lineno"> 1176</span>    <a class="code hl_struct" href="structduk__activation.html">duk_activation</a> *act;</div>
<div class="line"><span class="lineno"> 1177</span>    <a class="code hl_struct" href="structduk__hobject.html">duk_hobject</a> *env;</div>
<div class="line"><span class="lineno"> 1178</span>    <a class="code hl_typedef" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a3cd45ada834d9a7fcfcaf2d654435c6c">duk_ret_t</a> rc;</div>
<div class="line"><span class="lineno"> 1179</span> </div>
<div class="line"><span class="lineno"> 1180</span>    ctx = (<a class="code hl_struct" href="structduk__hthread.html">duk_context</a> *) thr;</div>
<div class="line"><span class="lineno"> 1181</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(thr != <a class="code hl_define" href="gmacros_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><span class="lineno"> 1182</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a06fc3069d0dbc1b0d9d28c15bb07e1ce">DUK_ASSERT_CTX_VALID</a>(ctx);</div>
<div class="line"><span class="lineno"> 1183</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(ctx != <a class="code hl_define" href="gmacros_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><span class="lineno"> 1184</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(num_stack_args &gt;= 0);</div>
<div class="line"><span class="lineno"> 1185</span>    <span class="comment">/* XXX: currently NULL allocations are not supported; remove if later allowed */</span></div>
<div class="line"><span class="lineno"> 1186</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#a08f58ff5b9fa5927891c2e08712e3971">valstack</a> != <a class="code hl_define" href="gmacros_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><span class="lineno"> 1187</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#ac03631b2f8ff5bab23d409f0bb966579">callstack</a> != <a class="code hl_define" href="gmacros_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><span class="lineno"> 1188</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#af6ad1a5c8500ffe6443be8fec677a775">catchstack</a> != <a class="code hl_define" href="gmacros_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><span class="lineno"> 1189</span> </div>
<div class="line"><span class="lineno"> 1190</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a6c3a2adb6e09294c7e65f69821e5e81a">DUK_DD</a>(<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#aa66ca9adc2b4187c5d549a9b117b03d3">DUK_DDPRINT</a>(<span class="stringliteral">&quot;duk__handle_call_inner: num_stack_args=%ld, call_flags=0x%08lx, top=%ld&quot;</span>,</div>
<div class="line"><span class="lineno"> 1191</span>                       (<span class="keywordtype">long</span>) num_stack_args, (<span class="keywordtype">long</span>) call_flags, (<span class="keywordtype">long</span>) <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a8c8653fcd951809042c23c42e534c421">duk_get_top</a>(ctx)));</div>
<div class="line"><span class="lineno"> 1192</span> </div>
<div class="line"><span class="lineno"> 1193</span>    <span class="comment">/*</span></div>
<div class="line"><span class="lineno"> 1194</span><span class="comment">     *  Store entry state.</span></div>
<div class="line"><span class="lineno"> 1195</span><span class="comment">     */</span></div>
<div class="line"><span class="lineno"> 1196</span> </div>
<div class="line"><span class="lineno"> 1197</span>    entry_valstack_bottom_index = (<a class="code hl_typedef" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#ab0a71934d59f38f195fea2f353032392">duk_size_t</a>) (thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#ad39b6c03b81eb0f4d3eefda5083988d3">valstack_bottom</a> - thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#a08f58ff5b9fa5927891c2e08712e3971">valstack</a>);</div>
<div class="line"><span class="lineno"> 1198</span><span class="preprocessor">#if defined(DUK_USE_PREFER_SIZE)</span></div>
<div class="line"><span class="lineno"> 1199</span>    entry_valstack_end = (<a class="code hl_typedef" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#ab0a71934d59f38f195fea2f353032392">duk_size_t</a>) (thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#a09749b7b70f6fd8ad3661adfac3316b5">valstack_end</a> - thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#a08f58ff5b9fa5927891c2e08712e3971">valstack</a>);</div>
<div class="line"><span class="lineno"> 1200</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno"> 1201</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>((<a class="code hl_typedef" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#ab0a71934d59f38f195fea2f353032392">duk_size_t</a>) (thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#a09749b7b70f6fd8ad3661adfac3316b5">valstack_end</a> - thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#a08f58ff5b9fa5927891c2e08712e3971">valstack</a>) == thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#ad195c4cbdb413aa9c6d4144a3959e749">valstack_size</a>);</div>
<div class="line"><span class="lineno"> 1202</span>    entry_valstack_end = thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#ad195c4cbdb413aa9c6d4144a3959e749">valstack_size</a>;</div>
<div class="line"><span class="lineno"> 1203</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1204</span>    entry_callstack_top = thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#aea2cca88da9187f43fb2b925ef7f5ee4">callstack_top</a>;</div>
<div class="line"><span class="lineno"> 1205</span>    entry_catchstack_top = thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#a52794290185255eb48736c942b07ae04">catchstack_top</a>;</div>
<div class="line"><span class="lineno"> 1206</span>    entry_call_recursion_depth = thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#a1c6d2e1f36b0b7011f0e52343ca5ed05">heap</a>-&gt;<a class="code hl_variable" href="structduk__heap.html#ab229eef9c6b0d7fcd267527a4b107fe5">call_recursion_depth</a>;</div>
<div class="line"><span class="lineno"> 1207</span>    entry_curr_thread = thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#a1c6d2e1f36b0b7011f0e52343ca5ed05">heap</a>-&gt;<a class="code hl_variable" href="structduk__heap.html#a1f913439bf8af92c753891bea8abda78">curr_thread</a>;  <span class="comment">/* Note: may be NULL if first call */</span></div>
<div class="line"><span class="lineno"> 1208</span>    entry_thread_state = thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#a4dc5dc48406aa6240185468557d154dc">state</a>;</div>
<div class="line"><span class="lineno"> 1209</span>    entry_ptr_curr_pc = thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#a9ceabe6e4ac27d8e61e8f33d4eab55a6">ptr_curr_pc</a>;  <span class="comment">/* may be NULL */</span></div>
<div class="line"><span class="lineno"> 1210</span> </div>
<div class="line"><span class="lineno"> 1211</span>    <span class="comment">/* If thr-&gt;ptr_curr_pc is set, sync curr_pc to act-&gt;pc.  Then NULL</span></div>
<div class="line"><span class="lineno"> 1212</span><span class="comment">     * thr-&gt;ptr_curr_pc so that it&#39;s not accidentally used with an incorrect</span></div>
<div class="line"><span class="lineno"> 1213</span><span class="comment">     * activation when side effects occur.</span></div>
<div class="line"><span class="lineno"> 1214</span><span class="comment">     */</span></div>
<div class="line"><span class="lineno"> 1215</span>    <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a8cee88ae1401c33134400aa455dd6754">duk_hthread_sync_and_null_currpc</a>(thr);</div>
<div class="line"><span class="lineno"> 1216</span> </div>
<div class="line"><span class="lineno"> 1217</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a6c3a2adb6e09294c7e65f69821e5e81a">DUK_DD</a>(<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#aa66ca9adc2b4187c5d549a9b117b03d3">DUK_DDPRINT</a>(<span class="stringliteral">&quot;duk__handle_call_inner: thr=%p, num_stack_args=%ld, &quot;</span></div>
<div class="line"><span class="lineno"> 1218</span>                       <span class="stringliteral">&quot;call_flags=0x%08lx (ignorerec=%ld, constructor=%ld), &quot;</span></div>
<div class="line"><span class="lineno"> 1219</span>                       <span class="stringliteral">&quot;valstack_top=%ld, idx_func=%ld, idx_args=%ld, rec_depth=%ld/%ld, &quot;</span></div>
<div class="line"><span class="lineno"> 1220</span>                       <span class="stringliteral">&quot;entry_valstack_bottom_index=%ld, entry_callstack_top=%ld, entry_catchstack_top=%ld, &quot;</span></div>
<div class="line"><span class="lineno"> 1221</span>                       <span class="stringliteral">&quot;entry_call_recursion_depth=%ld, entry_curr_thread=%p, entry_thread_state=%ld&quot;</span>,</div>
<div class="line"><span class="lineno"> 1222</span>                       (<span class="keywordtype">void</span> *) thr,</div>
<div class="line"><span class="lineno"> 1223</span>                       (<span class="keywordtype">long</span>) num_stack_args,</div>
<div class="line"><span class="lineno"> 1224</span>                       (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>) call_flags,</div>
<div class="line"><span class="lineno"> 1225</span>                       (<span class="keywordtype">long</span>) ((call_flags &amp; <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#afa9b99df5108fec08cd0dc85f30d70da">DUK_CALL_FLAG_IGNORE_RECLIMIT</a>) != 0 ? 1 : 0),</div>
<div class="line"><span class="lineno"> 1226</span>                       (long) ((call_flags &amp; <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a19a9d6a4b52e03c7f42e925cfe76992f">DUK_CALL_FLAG_CONSTRUCTOR_CALL</a>) != 0 ? 1 : 0),</div>
<div class="line"><span class="lineno"> 1227</span>                       (long) <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a8c8653fcd951809042c23c42e534c421">duk_get_top</a>(ctx),</div>
<div class="line"><span class="lineno"> 1228</span>                       (long) idx_func,</div>
<div class="line"><span class="lineno"> 1229</span>                       (long) (idx_func + 2),</div>
<div class="line"><span class="lineno"> 1230</span>                       (long) thr-&gt;heap-&gt;call_recursion_depth,</div>
<div class="line"><span class="lineno"> 1231</span>                       (long) thr-&gt;heap-&gt;call_recursion_limit,</div>
<div class="line"><span class="lineno"> 1232</span>                       (long) entry_valstack_bottom_index,</div>
<div class="line"><span class="lineno"> 1233</span>                       (long) entry_callstack_top,</div>
<div class="line"><span class="lineno"> 1234</span>                       (long) entry_catchstack_top,</div>
<div class="line"><span class="lineno"> 1235</span>                       (long) entry_call_recursion_depth,</div>
<div class="line"><span class="lineno"> 1236</span>                       (void *) entry_curr_thread,</div>
<div class="line"><span class="lineno"> 1237</span>                       (long) entry_thread_state));</div>
<div class="line"><span class="lineno"> 1238</span> </div>
<div class="line"><span class="lineno"> 1239</span> </div>
<div class="line"><span class="lineno"> 1240</span>    <span class="comment">/*</span></div>
<div class="line"><span class="lineno"> 1241</span><span class="comment">     *  Thread state check and book-keeping.</span></div>
<div class="line"><span class="lineno"> 1242</span><span class="comment">     */</span></div>
<div class="line"><span class="lineno"> 1243</span> </div>
<div class="line"><span class="lineno"> 1244</span>    <span class="keywordflow">if</span> (thr == thr-&gt;heap-&gt;curr_thread) {</div>
<div class="line"><span class="lineno"> 1245</span>        <span class="comment">/* same thread */</span></div>
<div class="line"><span class="lineno"> 1246</span>        <span class="keywordflow">if</span> (thr-&gt;state != <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a82ed1e61fa4a768cbc65401274bfd89a">DUK_HTHREAD_STATE_RUNNING</a>) {</div>
<div class="line"><span class="lineno"> 1247</span>            <span class="comment">/* should actually never happen, but check anyway */</span></div>
<div class="line"><span class="lineno"> 1248</span>            <span class="keywordflow">goto</span> thread_state_error;</div>
<div class="line"><span class="lineno"> 1249</span>        }</div>
<div class="line"><span class="lineno"> 1250</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1251</span>        <span class="comment">/* different thread */</span></div>
<div class="line"><span class="lineno"> 1252</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(thr-&gt;heap-&gt;curr_thread == <a class="code hl_define" href="gmacros_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> ||</div>
<div class="line"><span class="lineno"> 1253</span>                   thr-&gt;heap-&gt;curr_thread-&gt;state == <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a82ed1e61fa4a768cbc65401274bfd89a">DUK_HTHREAD_STATE_RUNNING</a>);</div>
<div class="line"><span class="lineno"> 1254</span>        <span class="keywordflow">if</span> (thr-&gt;state != <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a60d14816853d0b43d8f6e2d033a9df60">DUK_HTHREAD_STATE_INACTIVE</a>) {</div>
<div class="line"><span class="lineno"> 1255</span>            <span class="keywordflow">goto</span> thread_state_error;</div>
<div class="line"><span class="lineno"> 1256</span>        }</div>
<div class="line"><span class="lineno"> 1257</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#ada39afa145c10879d68bc705850edcd7">DUK_HEAP_SWITCH_THREAD</a>(thr-&gt;heap, thr);</div>
<div class="line"><span class="lineno"> 1258</span>        thr-&gt;state = <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a82ed1e61fa4a768cbc65401274bfd89a">DUK_HTHREAD_STATE_RUNNING</a>;</div>
<div class="line"><span class="lineno"> 1259</span> </div>
<div class="line"><span class="lineno"> 1260</span>        <span class="comment">/* Note: multiple threads may be simultaneously in the RUNNING</span></div>
<div class="line"><span class="lineno"> 1261</span><span class="comment">         * state, but not in the same &quot;resume chain&quot;.</span></div>
<div class="line"><span class="lineno"> 1262</span><span class="comment">         */</span></div>
<div class="line"><span class="lineno"> 1263</span>    }</div>
<div class="line"><span class="lineno"> 1264</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(thr-&gt;heap-&gt;curr_thread == thr);</div>
<div class="line"><span class="lineno"> 1265</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(thr-&gt;state == <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a82ed1e61fa4a768cbc65401274bfd89a">DUK_HTHREAD_STATE_RUNNING</a>);</div>
<div class="line"><span class="lineno"> 1266</span> </div>
<div class="line"><span class="lineno"> 1267</span>    <span class="comment">/*</span></div>
<div class="line"><span class="lineno"> 1268</span><span class="comment">     *  C call recursion depth check, which provides a reasonable upper</span></div>
<div class="line"><span class="lineno"> 1269</span><span class="comment">     *  bound on maximum C stack size (arbitrary C stack growth is only</span></div>
<div class="line"><span class="lineno"> 1270</span><span class="comment">     *  possible by recursive handle_call / handle_safe_call calls).</span></div>
<div class="line"><span class="lineno"> 1271</span><span class="comment">     */</span></div>
<div class="line"><span class="lineno"> 1272</span> </div>
<div class="line"><span class="lineno"> 1273</span>    <span class="comment">/* XXX: remove DUK_CALL_FLAG_IGNORE_RECLIMIT flag: there&#39;s now the</span></div>
<div class="line"><span class="lineno"> 1274</span><span class="comment">     * reclimit bump?</span></div>
<div class="line"><span class="lineno"> 1275</span><span class="comment">     */</span></div>
<div class="line"><span class="lineno"> 1276</span> </div>
<div class="line"><span class="lineno"> 1277</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(thr-&gt;heap-&gt;call_recursion_depth &gt;= 0);</div>
<div class="line"><span class="lineno"> 1278</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(thr-&gt;heap-&gt;call_recursion_depth &lt;= thr-&gt;heap-&gt;call_recursion_limit);</div>
<div class="line"><span class="lineno"> 1279</span>    <span class="keywordflow">if</span> (call_flags &amp; <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#afa9b99df5108fec08cd0dc85f30d70da">DUK_CALL_FLAG_IGNORE_RECLIMIT</a>) {</div>
<div class="line"><span class="lineno"> 1280</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a6c3a2adb6e09294c7e65f69821e5e81a">DUK_DD</a>(<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#aa66ca9adc2b4187c5d549a9b117b03d3">DUK_DDPRINT</a>(<span class="stringliteral">&quot;ignoring reclimit for this call (probably an errhandler call)&quot;</span>));</div>
<div class="line"><span class="lineno"> 1281</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1282</span>        <span class="keywordflow">if</span> (thr-&gt;heap-&gt;call_recursion_depth &gt;= thr-&gt;heap-&gt;call_recursion_limit) {</div>
<div class="line"><span class="lineno"> 1283</span>            <span class="comment">/* XXX: error message is a bit misleading: we reached a recursion</span></div>
<div class="line"><span class="lineno"> 1284</span><span class="comment">             * limit which is also essentially the same as a C callstack limit</span></div>
<div class="line"><span class="lineno"> 1285</span><span class="comment">             * (except perhaps with some relaxed threading assumptions).</span></div>
<div class="line"><span class="lineno"> 1286</span><span class="comment">             */</span></div>
<div class="line"><span class="lineno"> 1287</span>            <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a058cd56ed742ea766d26976d56c159d4">DUK_ERROR_RANGE</a>(thr, <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#aa065bcb3f7f1d242bd6baa3a285dc0d8">DUK_STR_C_CALLSTACK_LIMIT</a>);</div>
<div class="line"><span class="lineno"> 1288</span>        }</div>
<div class="line"><span class="lineno"> 1289</span>        thr-&gt;heap-&gt;call_recursion_depth++;</div>
<div class="line"><span class="lineno"> 1290</span>    }</div>
<div class="line"><span class="lineno"> 1291</span> </div>
<div class="line"><span class="lineno"> 1292</span>    <span class="comment">/*</span></div>
<div class="line"><span class="lineno"> 1293</span><span class="comment">     *  Check the function type, handle bound function chains, and prepare</span></div>
<div class="line"><span class="lineno"> 1294</span><span class="comment">     *  parameters for the rest of the call handling.  Also figure out the</span></div>
<div class="line"><span class="lineno"> 1295</span><span class="comment">     *  effective &#39;this&#39; binding, which replaces the current value at</span></div>
<div class="line"><span class="lineno"> 1296</span><span class="comment">     *  idx_func + 1.</span></div>
<div class="line"><span class="lineno"> 1297</span><span class="comment">     *</span></div>
<div class="line"><span class="lineno"> 1298</span><span class="comment">     *  If the target function is a &#39;bound&#39; one, follow the chain of &#39;bound&#39;</span></div>
<div class="line"><span class="lineno"> 1299</span><span class="comment">     *  functions until a non-bound function is found.  During this process,</span></div>
<div class="line"><span class="lineno"> 1300</span><span class="comment">     *  bound arguments are &#39;prepended&#39; to existing ones, and the &quot;this&quot;</span></div>
<div class="line"><span class="lineno"> 1301</span><span class="comment">     *  binding is overridden.  See E5 Section 15.3.4.5.1.</span></div>
<div class="line"><span class="lineno"> 1302</span><span class="comment">     *</span></div>
<div class="line"><span class="lineno"> 1303</span><span class="comment">     *  Lightfunc detection happens here too.  Note that lightweight functions</span></div>
<div class="line"><span class="lineno"> 1304</span><span class="comment">     *  can be wrapped by (non-lightweight) bound functions so we must resolve</span></div>
<div class="line"><span class="lineno"> 1305</span><span class="comment">     *  the bound function chain first.</span></div>
<div class="line"><span class="lineno"> 1306</span><span class="comment">     */</span></div>
<div class="line"><span class="lineno"> 1307</span> </div>
<div class="line"><span class="lineno"> 1308</span>    func = <a class="code hl_function" href="#a0d5042617a44a3204d4839319683aeb2">duk__nonbound_func_lookup</a>(ctx, idx_func, &amp;num_stack_args, &amp;tv_func, call_flags);</div>
<div class="line"><span class="lineno"> 1309</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a04ff20dec8ac63c2010d16bcfd823d15">DUK_TVAL_SET_TVAL</a>(&amp;tv_func_copy, tv_func);</div>
<div class="line"><span class="lineno"> 1310</span>    tv_func = &amp;tv_func_copy;  <span class="comment">/* local copy to avoid relookups */</span></div>
<div class="line"><span class="lineno"> 1311</span> </div>
<div class="line"><span class="lineno"> 1312</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(func == <a class="code hl_define" href="gmacros_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> || !<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a1405011142963f5c45c82eb2a881e385">DUK_HOBJECT_HAS_BOUND</a>(func));</div>
<div class="line"><span class="lineno"> 1313</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(func == <a class="code hl_define" href="gmacros_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> || (<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a3b446d4cd53f63e5e57b80041eb0d598">DUK_HOBJECT_IS_COMPILEDFUNCTION</a>(func) ||</div>
<div class="line"><span class="lineno"> 1314</span>                                <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a70ce6873e608ce9399d8c7e2e45af92f">DUK_HOBJECT_IS_NATIVEFUNCTION</a>(func)));</div>
<div class="line"><span class="lineno"> 1315</span> </div>
<div class="line"><span class="lineno"> 1316</span>    <a class="code hl_function" href="#a08825b479944b1b525fe432f83bbe57e">duk__coerce_effective_this_binding</a>(thr, func, idx_func + 1);</div>
<div class="line"><span class="lineno"> 1317</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a2db20d2d3b36d8491ed171cf503488bb">DUK_DDD</a>(<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#aa6e5d41ceaba6832e5ede737f0a35fb9">DUK_DDDPRINT</a>(<span class="stringliteral">&quot;effective &#39;this&#39; binding is: %!T&quot;</span>,</div>
<div class="line"><span class="lineno"> 1318</span>                         (<a class="code hl_struct" href="structduk__tval__struct.html">duk_tval</a> *) <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#afa34aa8c7f880082f9de613ef2bc3c58">duk_get_tval</a>(ctx, idx_func + 1)));</div>
<div class="line"><span class="lineno"> 1319</span> </div>
<div class="line"><span class="lineno"> 1320</span>    <span class="comment">/* [ ... func this arg1 ... argN ] */</span></div>
<div class="line"><span class="lineno"> 1321</span> </div>
<div class="line"><span class="lineno"> 1322</span>    <span class="comment">/*</span></div>
<div class="line"><span class="lineno"> 1323</span><span class="comment">     *  Setup a preliminary activation and figure out nargs/nregs.</span></div>
<div class="line"><span class="lineno"> 1324</span><span class="comment">     *</span></div>
<div class="line"><span class="lineno"> 1325</span><span class="comment">     *  Don&#39;t touch valstack_bottom or valstack_top yet so that Duktape API</span></div>
<div class="line"><span class="lineno"> 1326</span><span class="comment">     *  calls work normally.</span></div>
<div class="line"><span class="lineno"> 1327</span><span class="comment">     */</span></div>
<div class="line"><span class="lineno"> 1328</span> </div>
<div class="line"><span class="lineno"> 1329</span>    <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a0490bab9b44658a5ac4aad3bc88b0e4b">duk_hthread_callstack_grow</a>(thr);</div>
<div class="line"><span class="lineno"> 1330</span> </div>
<div class="line"><span class="lineno"> 1331</span>    <span class="keywordflow">if</span> (thr-&gt;callstack_top &gt; 0) {</div>
<div class="line"><span class="lineno"> 1332</span>        <span class="comment">/*</span></div>
<div class="line"><span class="lineno"> 1333</span><span class="comment">         *  Update idx_retval of current activation.</span></div>
<div class="line"><span class="lineno"> 1334</span><span class="comment">         *</span></div>
<div class="line"><span class="lineno"> 1335</span><span class="comment">         *  Although it might seem this is not necessary (bytecode executor</span></div>
<div class="line"><span class="lineno"> 1336</span><span class="comment">         *  does this for Ecmascript-to-Ecmascript calls; other calls are</span></div>
<div class="line"><span class="lineno"> 1337</span><span class="comment">         *  handled here), this turns out to be necessary for handling yield</span></div>
<div class="line"><span class="lineno"> 1338</span><span class="comment">         *  and resume.  For them, an Ecmascript-to-native call happens, and</span></div>
<div class="line"><span class="lineno"> 1339</span><span class="comment">         *  the Ecmascript call&#39;s idx_retval must be set for things to work.</span></div>
<div class="line"><span class="lineno"> 1340</span><span class="comment">         */</span></div>
<div class="line"><span class="lineno"> 1341</span> </div>
<div class="line"><span class="lineno"> 1342</span>        (thr-&gt;callstack + thr-&gt;callstack_top - 1)-&gt;idx_retval = entry_valstack_bottom_index + idx_func;</div>
<div class="line"><span class="lineno"> 1343</span>    }</div>
<div class="line"><span class="lineno"> 1344</span> </div>
<div class="line"><span class="lineno"> 1345</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(thr-&gt;callstack_top &lt; thr-&gt;callstack_size);</div>
<div class="line"><span class="lineno"> 1346</span>    act = thr-&gt;callstack + thr-&gt;callstack_top;</div>
<div class="line"><span class="lineno"> 1347</span>    thr-&gt;callstack_top++;</div>
<div class="line"><span class="lineno"> 1348</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(thr-&gt;callstack_top &lt;= thr-&gt;callstack_size);</div>
<div class="line"><span class="lineno"> 1349</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(thr-&gt;valstack_top &gt; thr-&gt;valstack_bottom);  <span class="comment">/* at least effective &#39;this&#39; */</span></div>
<div class="line"><span class="lineno"> 1350</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(func == <a class="code hl_define" href="gmacros_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> || !<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a1405011142963f5c45c82eb2a881e385">DUK_HOBJECT_HAS_BOUND</a>(func));</div>
<div class="line"><span class="lineno"> 1351</span> </div>
<div class="line"><span class="lineno"> 1352</span>    act-&gt;<a class="code hl_variable" href="structduk__activation.html#a05a11e283998d74a28767200b42d1bc1">flags</a> = 0;</div>
<div class="line"><span class="lineno"> 1353</span> </div>
<div class="line"><span class="lineno"> 1354</span>    <span class="comment">/* For now all calls except Ecma-to-Ecma calls prevent a yield. */</span></div>
<div class="line"><span class="lineno"> 1355</span>    act-&gt;<a class="code hl_variable" href="structduk__activation.html#a05a11e283998d74a28767200b42d1bc1">flags</a> |= <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a0516cfba051919d12ec8a46e815b178f">DUK_ACT_FLAG_PREVENT_YIELD</a>;</div>
<div class="line"><span class="lineno"> 1356</span>    <span class="keywordflow">if</span> (call_flags &amp; <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a19a9d6a4b52e03c7f42e925cfe76992f">DUK_CALL_FLAG_CONSTRUCTOR_CALL</a>) {</div>
<div class="line"><span class="lineno"> 1357</span>        act-&gt;<a class="code hl_variable" href="structduk__activation.html#a05a11e283998d74a28767200b42d1bc1">flags</a> |= <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a74b3c69afa49e28b1680178cd9c8715d">DUK_ACT_FLAG_CONSTRUCT</a>;</div>
<div class="line"><span class="lineno"> 1358</span>    }</div>
<div class="line"><span class="lineno"> 1359</span>    <span class="keywordflow">if</span> (call_flags &amp; <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#ad0cff35ef1e7aa971563b058bd47e5d2">DUK_CALL_FLAG_DIRECT_EVAL</a>) {</div>
<div class="line"><span class="lineno"> 1360</span>        act-&gt;<a class="code hl_variable" href="structduk__activation.html#a05a11e283998d74a28767200b42d1bc1">flags</a> |= <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a611f8fe05a3a8885f2c7568ac80a34c9">DUK_ACT_FLAG_DIRECT_EVAL</a>;</div>
<div class="line"><span class="lineno"> 1361</span>    }</div>
<div class="line"><span class="lineno"> 1362</span> </div>
<div class="line"><span class="lineno"> 1363</span>    <span class="comment">/* These base values are never used, but if the compiler doesn&#39;t know</span></div>
<div class="line"><span class="lineno"> 1364</span><span class="comment">     * that DUK_ERROR() won&#39;t return, these are needed to silence warnings.</span></div>
<div class="line"><span class="lineno"> 1365</span><span class="comment">     * On the other hand, scan-build will warn about the values not being</span></div>
<div class="line"><span class="lineno"> 1366</span><span class="comment">     * used, so add a DUK_UNREF.</span></div>
<div class="line"><span class="lineno"> 1367</span><span class="comment">     */</span></div>
<div class="line"><span class="lineno"> 1368</span>    nargs = 0; <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a9170138f330dbcaabfae9d2c59cc9684">DUK_UNREF</a>(nargs);</div>
<div class="line"><span class="lineno"> 1369</span>    nregs = 0; <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a9170138f330dbcaabfae9d2c59cc9684">DUK_UNREF</a>(nregs);</div>
<div class="line"><span class="lineno"> 1370</span> </div>
<div class="line"><span class="lineno"> 1371</span>    <span class="keywordflow">if</span> (<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#aff85916aff22bb1c4a5b83e2008cdc30">DUK_LIKELY</a>(func != <a class="code hl_define" href="gmacros_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)) {</div>
<div class="line"><span class="lineno"> 1372</span>        <span class="keywordflow">if</span> (<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#ae5226f867ccd5073adc2df9140389ecb">DUK_HOBJECT_HAS_STRICT</a>(func)) {</div>
<div class="line"><span class="lineno"> 1373</span>            act-&gt;<a class="code hl_variable" href="structduk__activation.html#a05a11e283998d74a28767200b42d1bc1">flags</a> |= <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a56d7614c6c54403b83c190449622328f">DUK_ACT_FLAG_STRICT</a>;</div>
<div class="line"><span class="lineno"> 1374</span>        }</div>
<div class="line"><span class="lineno"> 1375</span>        <span class="keywordflow">if</span> (<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a3b446d4cd53f63e5e57b80041eb0d598">DUK_HOBJECT_IS_COMPILEDFUNCTION</a>(func)) {</div>
<div class="line"><span class="lineno"> 1376</span>            nargs = ((<a class="code hl_struct" href="structduk__hcompiledfunction.html">duk_hcompiledfunction</a> *) func)-&gt;nargs;</div>
<div class="line"><span class="lineno"> 1377</span>            nregs = ((<a class="code hl_struct" href="structduk__hcompiledfunction.html">duk_hcompiledfunction</a> *) func)-&gt;nregs;</div>
<div class="line"><span class="lineno"> 1378</span>            <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(nregs &gt;= nargs);</div>
<div class="line"><span class="lineno"> 1379</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a70ce6873e608ce9399d8c7e2e45af92f">DUK_HOBJECT_IS_NATIVEFUNCTION</a>(func)) {</div>
<div class="line"><span class="lineno"> 1380</span>            <span class="comment">/* Note: nargs (and nregs) may be negative for a native,</span></div>
<div class="line"><span class="lineno"> 1381</span><span class="comment">             * function, which indicates that the function wants the</span></div>
<div class="line"><span class="lineno"> 1382</span><span class="comment">             * input stack &quot;as is&quot; (i.e. handles &quot;vararg&quot; arguments).</span></div>
<div class="line"><span class="lineno"> 1383</span><span class="comment">             */</span></div>
<div class="line"><span class="lineno"> 1384</span>            nargs = ((<a class="code hl_struct" href="structduk__hnativefunction.html">duk_hnativefunction</a> *) func)-&gt;nargs;</div>
<div class="line"><span class="lineno"> 1385</span>            nregs = nargs;</div>
<div class="line"><span class="lineno"> 1386</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1387</span>            <span class="comment">/* XXX: this should be an assert */</span></div>
<div class="line"><span class="lineno"> 1388</span>            <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a13623e5d472d92f656ad1d9a2875d277">DUK_ERROR_TYPE</a>(thr, <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a0face1475afe4e3efae57c1386b88c32">DUK_STR_NOT_CALLABLE</a>);</div>
<div class="line"><span class="lineno"> 1389</span>        }</div>
<div class="line"><span class="lineno"> 1390</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1391</span>        <a class="code hl_typedef" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a2b7ba45bf826058a9b7720b5e258efc6">duk_small_uint_t</a> lf_flags;</div>
<div class="line"><span class="lineno"> 1392</span> </div>
<div class="line"><span class="lineno"> 1393</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a803cbfe1e33fe5c591d7bec4fd3a6a93">DUK_TVAL_IS_LIGHTFUNC</a>(tv_func));</div>
<div class="line"><span class="lineno"> 1394</span>        lf_flags = <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#af6d39c7f5b5aa18478e5aec403d3247c">DUK_TVAL_GET_LIGHTFUNC_FLAGS</a>(tv_func);</div>
<div class="line"><span class="lineno"> 1395</span>        nargs = <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#acec31793b1aa8698cdd68ec7015146a9">DUK_LFUNC_FLAGS_GET_NARGS</a>(lf_flags);</div>
<div class="line"><span class="lineno"> 1396</span>        <span class="keywordflow">if</span> (nargs == <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a652ca5b5e92f72cf5bfccf39611eca11">DUK_LFUNC_NARGS_VARARGS</a>) {</div>
<div class="line"><span class="lineno"> 1397</span>            nargs = -1;  <span class="comment">/* vararg */</span></div>
<div class="line"><span class="lineno"> 1398</span>        }</div>
<div class="line"><span class="lineno"> 1399</span>        nregs = nargs;</div>
<div class="line"><span class="lineno"> 1400</span> </div>
<div class="line"><span class="lineno"> 1401</span>        act-&gt;<a class="code hl_variable" href="structduk__activation.html#a05a11e283998d74a28767200b42d1bc1">flags</a> |= <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a56d7614c6c54403b83c190449622328f">DUK_ACT_FLAG_STRICT</a>;</div>
<div class="line"><span class="lineno"> 1402</span>    }</div>
<div class="line"><span class="lineno"> 1403</span> </div>
<div class="line"><span class="lineno"> 1404</span>    act-&gt;<a class="code hl_variable" href="structduk__activation.html#a6de02a28083672138fb33da69fbf701a">func</a> = func;  <span class="comment">/* NULL for lightfunc */</span></div>
<div class="line"><span class="lineno"> 1405</span>    act-&gt;<a class="code hl_variable" href="structduk__activation.html#a92ea93909d22ddbd33cfc46f32726387">var_env</a> = <a class="code hl_define" href="gmacros_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><span class="lineno"> 1406</span>    act-&gt;<a class="code hl_variable" href="structduk__activation.html#a2e3041f6643f991adf53a6a8d55ea3c3">lex_env</a> = <a class="code hl_define" href="gmacros_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><span class="lineno"> 1407</span><span class="preprocessor">#if defined(DUK_USE_NONSTD_FUNC_CALLER_PROPERTY)</span></div>
<div class="line"><span class="lineno"> 1408</span>    act-&gt;prev_caller = <a class="code hl_define" href="gmacros_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><span class="lineno"> 1409</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1410</span>    act-&gt;<a class="code hl_variable" href="structduk__activation.html#a19ed13846f28deb48700a005c10aba8c">curr_pc</a> = <a class="code hl_define" href="gmacros_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><span class="lineno"> 1411</span><span class="preprocessor">#if defined(DUK_USE_DEBUGGER_SUPPORT)</span></div>
<div class="line"><span class="lineno"> 1412</span>    act-&gt;prev_line = 0;</div>
<div class="line"><span class="lineno"> 1413</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1414</span>    act-&gt;<a class="code hl_variable" href="structduk__activation.html#a181b5225468a571c32b94317422e08f2">idx_bottom</a> = entry_valstack_bottom_index + idx_func + 2;</div>
<div class="line"><span class="lineno"> 1415</span><span class="preprocessor">#if 0  </span><span class="comment">/* topmost activation idx_retval is considered garbage, no need to init */</span><span class="preprocessor"></span></div>
<div class="line"><span class="lineno"> 1416</span>    act-&gt;<a class="code hl_variable" href="structduk__activation.html#af82e168e163ea9e05c40281092e44347">idx_retval</a> = 0;</div>
<div class="line"><span class="lineno"> 1417</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1418</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a04ff20dec8ac63c2010d16bcfd823d15">DUK_TVAL_SET_TVAL</a>(&amp;act-&gt;<a class="code hl_variable" href="structduk__activation.html#aee23fb32ca20b90a8c06cd785c61534b">tv_func</a>, tv_func);  <span class="comment">/* borrowed, no refcount */</span></div>
<div class="line"><span class="lineno"> 1419</span> </div>
<div class="line"><span class="lineno"> 1420</span>    <span class="comment">/* XXX: remove the preventcount and make yield walk the callstack?</span></div>
<div class="line"><span class="lineno"> 1421</span><span class="comment">     * Or perhaps just use a single flag, not a counter, faster to just</span></div>
<div class="line"><span class="lineno"> 1422</span><span class="comment">     * set and restore?</span></div>
<div class="line"><span class="lineno"> 1423</span><span class="comment">     */</span></div>
<div class="line"><span class="lineno"> 1424</span>    <span class="keywordflow">if</span> (act-&gt;<a class="code hl_variable" href="structduk__activation.html#a05a11e283998d74a28767200b42d1bc1">flags</a> &amp; <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a0516cfba051919d12ec8a46e815b178f">DUK_ACT_FLAG_PREVENT_YIELD</a>) {</div>
<div class="line"><span class="lineno"> 1425</span>        <span class="comment">/* duk_hthread_callstack_unwind() will decrease this on unwind */</span></div>
<div class="line"><span class="lineno"> 1426</span>        thr-&gt;callstack_preventcount++;</div>
<div class="line"><span class="lineno"> 1427</span>    }</div>
<div class="line"><span class="lineno"> 1428</span> </div>
<div class="line"><span class="lineno"> 1429</span>    <span class="comment">/* XXX: Is this INCREF necessary? &#39;func&#39; is always a borrowed</span></div>
<div class="line"><span class="lineno"> 1430</span><span class="comment">     * reference reachable through the value stack?  If changed, stack</span></div>
<div class="line"><span class="lineno"> 1431</span><span class="comment">     * unwind code also needs to be fixed to match.</span></div>
<div class="line"><span class="lineno"> 1432</span><span class="comment">     */</span></div>
<div class="line"><span class="lineno"> 1433</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#aee2b028c473ecd0ac84f414e3ccaacd1">DUK_HOBJECT_INCREF_ALLOWNULL</a>(thr, func);  <span class="comment">/* act-&gt;func */</span></div>
<div class="line"><span class="lineno"> 1434</span> </div>
<div class="line"><span class="lineno"> 1435</span><span class="preprocessor">#if defined(DUK_USE_NONSTD_FUNC_CALLER_PROPERTY)</span></div>
<div class="line"><span class="lineno"> 1436</span>    <span class="keywordflow">if</span> (func) {</div>
<div class="line"><span class="lineno"> 1437</span>        duk__update_func_caller_prop(thr, func);</div>
<div class="line"><span class="lineno"> 1438</span>    }</div>
<div class="line"><span class="lineno"> 1439</span>    act = thr-&gt;callstack + thr-&gt;callstack_top - 1;</div>
<div class="line"><span class="lineno"> 1440</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1441</span> </div>
<div class="line"><span class="lineno"> 1442</span>    <span class="comment">/* [ ... func this arg1 ... argN ] */</span></div>
<div class="line"><span class="lineno"> 1443</span> </div>
<div class="line"><span class="lineno"> 1444</span>    <span class="comment">/*</span></div>
<div class="line"><span class="lineno"> 1445</span><span class="comment">     *  Environment record creation and &#39;arguments&#39; object creation.</span></div>
<div class="line"><span class="lineno"> 1446</span><span class="comment">     *  Named function expression name binding is handled by the</span></div>
<div class="line"><span class="lineno"> 1447</span><span class="comment">     *  compiler; the compiled function&#39;s parent env will contain</span></div>
<div class="line"><span class="lineno"> 1448</span><span class="comment">     *  the (immutable) binding already.</span></div>
<div class="line"><span class="lineno"> 1449</span><span class="comment">     *</span></div>
<div class="line"><span class="lineno"> 1450</span><span class="comment">     *  This handling is now identical for C and Ecmascript functions.</span></div>
<div class="line"><span class="lineno"> 1451</span><span class="comment">     *  C functions always have the &#39;NEWENV&#39; flag set, so their</span></div>
<div class="line"><span class="lineno"> 1452</span><span class="comment">     *  environment record initialization is delayed (which is good).</span></div>
<div class="line"><span class="lineno"> 1453</span><span class="comment">     *</span></div>
<div class="line"><span class="lineno"> 1454</span><span class="comment">     *  Delayed creation (on demand) is handled in duk_js_var.c.</span></div>
<div class="line"><span class="lineno"> 1455</span><span class="comment">     */</span></div>
<div class="line"><span class="lineno"> 1456</span> </div>
<div class="line"><span class="lineno"> 1457</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(func == <a class="code hl_define" href="gmacros_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> || !<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a1405011142963f5c45c82eb2a881e385">DUK_HOBJECT_HAS_BOUND</a>(func));  <span class="comment">/* bound function chain has already been resolved */</span></div>
<div class="line"><span class="lineno"> 1458</span> </div>
<div class="line"><span class="lineno"> 1459</span>    <span class="keywordflow">if</span> (<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#aff85916aff22bb1c4a5b83e2008cdc30">DUK_LIKELY</a>(func != <a class="code hl_define" href="gmacros_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)) {</div>
<div class="line"><span class="lineno"> 1460</span>        <span class="keywordflow">if</span> (<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#aff85916aff22bb1c4a5b83e2008cdc30">DUK_LIKELY</a>(<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#abc40e3d6cc4e2c0c659abdb0bd5ab78b">DUK_HOBJECT_HAS_NEWENV</a>(func))) {</div>
<div class="line"><span class="lineno"> 1461</span>            <span class="keywordflow">if</span> (<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#aff85916aff22bb1c4a5b83e2008cdc30">DUK_LIKELY</a>(!<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a405107c06eacfb0b9b6e82aaaa609b9d">DUK_HOBJECT_HAS_CREATEARGS</a>(func))) {</div>
<div class="line"><span class="lineno"> 1462</span>                <span class="comment">/* Use a new environment but there&#39;s no &#39;arguments&#39; object;</span></div>
<div class="line"><span class="lineno"> 1463</span><span class="comment">                 * delayed environment initialization.  This is the most</span></div>
<div class="line"><span class="lineno"> 1464</span><span class="comment">                 * common case.</span></div>
<div class="line"><span class="lineno"> 1465</span><span class="comment">                 */</span></div>
<div class="line"><span class="lineno"> 1466</span>                <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(act-&gt;<a class="code hl_variable" href="structduk__activation.html#a2e3041f6643f991adf53a6a8d55ea3c3">lex_env</a> == <a class="code hl_define" href="gmacros_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><span class="lineno"> 1467</span>                <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(act-&gt;<a class="code hl_variable" href="structduk__activation.html#a92ea93909d22ddbd33cfc46f32726387">var_env</a> == <a class="code hl_define" href="gmacros_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><span class="lineno"> 1468</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1469</span>                <span class="comment">/* Use a new environment and there&#39;s an &#39;arguments&#39; object.</span></div>
<div class="line"><span class="lineno"> 1470</span><span class="comment">                 * We need to initialize it right now.</span></div>
<div class="line"><span class="lineno"> 1471</span><span class="comment">                 */</span></div>
<div class="line"><span class="lineno"> 1472</span> </div>
<div class="line"><span class="lineno"> 1473</span>                <span class="comment">/* third arg: absolute index (to entire valstack) of idx_bottom of new activation */</span></div>
<div class="line"><span class="lineno"> 1474</span>                env = <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a2c84775718b9520a875530d3f92b4b5b">duk_create_activation_environment_record</a>(thr, func, act-&gt;<a class="code hl_variable" href="structduk__activation.html#a181b5225468a571c32b94317422e08f2">idx_bottom</a>);</div>
<div class="line"><span class="lineno"> 1475</span>                <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(env != <a class="code hl_define" href="gmacros_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><span class="lineno"> 1476</span> </div>
<div class="line"><span class="lineno"> 1477</span>                <span class="comment">/* [ ... func this arg1 ... argN envobj ] */</span></div>
<div class="line"><span class="lineno"> 1478</span> </div>
<div class="line"><span class="lineno"> 1479</span>                <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a405107c06eacfb0b9b6e82aaaa609b9d">DUK_HOBJECT_HAS_CREATEARGS</a>(func));</div>
<div class="line"><span class="lineno"> 1480</span>                <a class="code hl_function" href="#a988107c9c80890ed0641244b749a1969">duk__handle_createargs_for_call</a>(thr, func, env, num_stack_args);</div>
<div class="line"><span class="lineno"> 1481</span> </div>
<div class="line"><span class="lineno"> 1482</span>                <span class="comment">/* [ ... func this arg1 ... argN envobj ] */</span></div>
<div class="line"><span class="lineno"> 1483</span> </div>
<div class="line"><span class="lineno"> 1484</span>                act = thr-&gt;callstack + thr-&gt;callstack_top - 1;</div>
<div class="line"><span class="lineno"> 1485</span>                act-&gt;<a class="code hl_variable" href="structduk__activation.html#a2e3041f6643f991adf53a6a8d55ea3c3">lex_env</a> = env;</div>
<div class="line"><span class="lineno"> 1486</span>                act-&gt;<a class="code hl_variable" href="structduk__activation.html#a92ea93909d22ddbd33cfc46f32726387">var_env</a> = env;</div>
<div class="line"><span class="lineno"> 1487</span>                <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#ac6b106695c0dfa435ade88972d1e46b8">DUK_HOBJECT_INCREF</a>(thr, env);</div>
<div class="line"><span class="lineno"> 1488</span>                <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#ac6b106695c0dfa435ade88972d1e46b8">DUK_HOBJECT_INCREF</a>(thr, env);  <span class="comment">/* XXX: incref by count (2) directly */</span></div>
<div class="line"><span class="lineno"> 1489</span>                <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#ac8da334e24a5f42f252271161d2116fb">duk_pop</a>(ctx);</div>
<div class="line"><span class="lineno"> 1490</span>            }</div>
<div class="line"><span class="lineno"> 1491</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1492</span>            <span class="comment">/* Use existing env (e.g. for non-strict eval); cannot have</span></div>
<div class="line"><span class="lineno"> 1493</span><span class="comment">             * an own &#39;arguments&#39; object (but can refer to an existing one).</span></div>
<div class="line"><span class="lineno"> 1494</span><span class="comment">             */</span></div>
<div class="line"><span class="lineno"> 1495</span> </div>
<div class="line"><span class="lineno"> 1496</span>            <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(!<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a405107c06eacfb0b9b6e82aaaa609b9d">DUK_HOBJECT_HAS_CREATEARGS</a>(func));</div>
<div class="line"><span class="lineno"> 1497</span> </div>
<div class="line"><span class="lineno"> 1498</span>            <a class="code hl_function" href="#a208a38260dcc44fddbc4658759b71f08">duk__handle_oldenv_for_call</a>(thr, func, act);</div>
<div class="line"><span class="lineno"> 1499</span> </div>
<div class="line"><span class="lineno"> 1500</span>            <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(act-&gt;<a class="code hl_variable" href="structduk__activation.html#a2e3041f6643f991adf53a6a8d55ea3c3">lex_env</a> != <a class="code hl_define" href="gmacros_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><span class="lineno"> 1501</span>            <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(act-&gt;<a class="code hl_variable" href="structduk__activation.html#a92ea93909d22ddbd33cfc46f32726387">var_env</a> != <a class="code hl_define" href="gmacros_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><span class="lineno"> 1502</span>        }</div>
<div class="line"><span class="lineno"> 1503</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1504</span>        <span class="comment">/* Lightfuncs are always native functions and have &quot;newenv&quot;. */</span></div>
<div class="line"><span class="lineno"> 1505</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(act-&gt;<a class="code hl_variable" href="structduk__activation.html#a2e3041f6643f991adf53a6a8d55ea3c3">lex_env</a> == <a class="code hl_define" href="gmacros_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><span class="lineno"> 1506</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(act-&gt;<a class="code hl_variable" href="structduk__activation.html#a92ea93909d22ddbd33cfc46f32726387">var_env</a> == <a class="code hl_define" href="gmacros_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><span class="lineno"> 1507</span>    }</div>
<div class="line"><span class="lineno"> 1508</span> </div>
<div class="line"><span class="lineno"> 1509</span>    <span class="comment">/* [ ... func this arg1 ... argN ] */</span></div>
<div class="line"><span class="lineno"> 1510</span> </div>
<div class="line"><span class="lineno"> 1511</span>    <span class="comment">/*</span></div>
<div class="line"><span class="lineno"> 1512</span><span class="comment">     *  Setup value stack: clamp to &#39;nargs&#39;, fill up to &#39;nregs&#39;</span></div>
<div class="line"><span class="lineno"> 1513</span><span class="comment">     *</span></div>
<div class="line"><span class="lineno"> 1514</span><span class="comment">     *  Value stack may either grow or shrink, depending on the</span></div>
<div class="line"><span class="lineno"> 1515</span><span class="comment">     *  number of func registers and the number of actual arguments.</span></div>
<div class="line"><span class="lineno"> 1516</span><span class="comment">     *  If nregs &gt;= 0, func wants args clamped to &#39;nargs&#39;; else it</span></div>
<div class="line"><span class="lineno"> 1517</span><span class="comment">     *  wants all args (= &#39;num_stack_args&#39;).</span></div>
<div class="line"><span class="lineno"> 1518</span><span class="comment">     */</span></div>
<div class="line"><span class="lineno"> 1519</span> </div>
<div class="line"><span class="lineno"> 1520</span>    <span class="comment">/* XXX: optimize value stack operation */</span></div>
<div class="line"><span class="lineno"> 1521</span>    <span class="comment">/* XXX: don&#39;t want to shrink allocation here */</span></div>
<div class="line"><span class="lineno"> 1522</span> </div>
<div class="line"><span class="lineno"> 1523</span>    <a class="code hl_function" href="#a24504a6bbcf7c2ac1bbcf078f0313652">duk__adjust_valstack_and_top</a>(thr,</div>
<div class="line"><span class="lineno"> 1524</span>                                 num_stack_args,</div>
<div class="line"><span class="lineno"> 1525</span>                                 idx_func + 2,</div>
<div class="line"><span class="lineno"> 1526</span>                                 nregs,</div>
<div class="line"><span class="lineno"> 1527</span>                                 nargs,</div>
<div class="line"><span class="lineno"> 1528</span>                                 func);</div>
<div class="line"><span class="lineno"> 1529</span> </div>
<div class="line"><span class="lineno"> 1530</span>    <span class="comment">/*</span></div>
<div class="line"><span class="lineno"> 1531</span><span class="comment">     *  Determine call type, then finalize activation, shift to</span></div>
<div class="line"><span class="lineno"> 1532</span><span class="comment">     *  new value stack bottom, and call the target.</span></div>
<div class="line"><span class="lineno"> 1533</span><span class="comment">     */</span></div>
<div class="line"><span class="lineno"> 1534</span> </div>
<div class="line"><span class="lineno"> 1535</span>    <span class="keywordflow">if</span> (func != <a class="code hl_define" href="gmacros_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> &amp;&amp; <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a3b446d4cd53f63e5e57b80041eb0d598">DUK_HOBJECT_IS_COMPILEDFUNCTION</a>(func)) {</div>
<div class="line"><span class="lineno"> 1536</span>        <span class="comment">/*</span></div>
<div class="line"><span class="lineno"> 1537</span><span class="comment">         *  Ecmascript call</span></div>
<div class="line"><span class="lineno"> 1538</span><span class="comment">         */</span></div>
<div class="line"><span class="lineno"> 1539</span> </div>
<div class="line"><span class="lineno"> 1540</span>        <a class="code hl_struct" href="structduk__tval__struct.html">duk_tval</a> *tv_ret;</div>
<div class="line"><span class="lineno"> 1541</span>        <a class="code hl_struct" href="structduk__tval__struct.html">duk_tval</a> *tv_funret;</div>
<div class="line"><span class="lineno"> 1542</span> </div>
<div class="line"><span class="lineno"> 1543</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(func != <a class="code hl_define" href="gmacros_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><span class="lineno"> 1544</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#af4939c11c36b867784c572c276549369">DUK_HOBJECT_HAS_COMPILEDFUNCTION</a>(func));</div>
<div class="line"><span class="lineno"> 1545</span>        act-&gt;<a class="code hl_variable" href="structduk__activation.html#a19ed13846f28deb48700a005c10aba8c">curr_pc</a> = <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a108793d34c82fc91faeb744adf2ce722">DUK_HCOMPILEDFUNCTION_GET_CODE_BASE</a>(thr-&gt;heap, (<a class="code hl_struct" href="structduk__hcompiledfunction.html">duk_hcompiledfunction</a> *) func);</div>
<div class="line"><span class="lineno"> 1546</span> </div>
<div class="line"><span class="lineno"> 1547</span>        thr-&gt;valstack_bottom = thr-&gt;valstack_bottom + idx_func + 2;</div>
<div class="line"><span class="lineno"> 1548</span>        <span class="comment">/* keep current valstack_top */</span></div>
<div class="line"><span class="lineno"> 1549</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(thr-&gt;valstack_bottom &gt;= thr-&gt;valstack);</div>
<div class="line"><span class="lineno"> 1550</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(thr-&gt;valstack_top &gt;= thr-&gt;valstack_bottom);</div>
<div class="line"><span class="lineno"> 1551</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(thr-&gt;valstack_end &gt;= thr-&gt;valstack_top);</div>
<div class="line"><span class="lineno"> 1552</span> </div>
<div class="line"><span class="lineno"> 1553</span>        <span class="comment">/* [ ... func this | arg1 ... argN ] (&#39;this&#39; must precede new bottom) */</span></div>
<div class="line"><span class="lineno"> 1554</span> </div>
<div class="line"><span class="lineno"> 1555</span>        <span class="comment">/*</span></div>
<div class="line"><span class="lineno"> 1556</span><span class="comment">         *  Bytecode executor call.</span></div>
<div class="line"><span class="lineno"> 1557</span><span class="comment">         *</span></div>
<div class="line"><span class="lineno"> 1558</span><span class="comment">         *  Execute bytecode, handling any recursive function calls and</span></div>
<div class="line"><span class="lineno"> 1559</span><span class="comment">         *  thread resumptions.  Returns when execution would return from</span></div>
<div class="line"><span class="lineno"> 1560</span><span class="comment">         *  the entry level activation.  When the executor returns, a</span></div>
<div class="line"><span class="lineno"> 1561</span><span class="comment">         *  single return value is left on the stack top.</span></div>
<div class="line"><span class="lineno"> 1562</span><span class="comment">         *</span></div>
<div class="line"><span class="lineno"> 1563</span><span class="comment">         *  The only possible longjmp() is an error (DUK_LJ_TYPE_THROW),</span></div>
<div class="line"><span class="lineno"> 1564</span><span class="comment">         *  other types are handled internally by the executor.</span></div>
<div class="line"><span class="lineno"> 1565</span><span class="comment">         */</span></div>
<div class="line"><span class="lineno"> 1566</span> </div>
<div class="line"><span class="lineno"> 1567</span>        <span class="comment">/* thr-&gt;ptr_curr_pc is set by bytecode executor early on entry */</span></div>
<div class="line"><span class="lineno"> 1568</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(thr-&gt;ptr_curr_pc == <a class="code hl_define" href="gmacros_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><span class="lineno"> 1569</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a2db20d2d3b36d8491ed171cf503488bb">DUK_DDD</a>(<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#aa6e5d41ceaba6832e5ede737f0a35fb9">DUK_DDDPRINT</a>(<span class="stringliteral">&quot;entering bytecode execution&quot;</span>));</div>
<div class="line"><span class="lineno"> 1570</span>        <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#aec3eb13ec7276cc2edf08eee64ec7845">duk_js_execute_bytecode</a>(thr);</div>
<div class="line"><span class="lineno"> 1571</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a2db20d2d3b36d8491ed171cf503488bb">DUK_DDD</a>(<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#aa6e5d41ceaba6832e5ede737f0a35fb9">DUK_DDDPRINT</a>(<span class="stringliteral">&quot;returned from bytecode execution&quot;</span>));</div>
<div class="line"><span class="lineno"> 1572</span> </div>
<div class="line"><span class="lineno"> 1573</span>        <span class="comment">/* Unwind. */</span></div>
<div class="line"><span class="lineno"> 1574</span> </div>
<div class="line"><span class="lineno"> 1575</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(thr-&gt;catchstack_top &gt;= entry_catchstack_top);  <span class="comment">/* may need unwind */</span></div>
<div class="line"><span class="lineno"> 1576</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(thr-&gt;callstack_top == entry_callstack_top + 1);</div>
<div class="line"><span class="lineno"> 1577</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(thr-&gt;callstack_top == entry_callstack_top + 1);</div>
<div class="line"><span class="lineno"> 1578</span>        <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a293c800100000f744f86bd30ddedaae3">duk_hthread_catchstack_unwind</a>(thr, entry_catchstack_top);</div>
<div class="line"><span class="lineno"> 1579</span>        <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a2280c7ff345d34b3b66982df21218c47">duk_hthread_catchstack_shrink_check</a>(thr);</div>
<div class="line"><span class="lineno"> 1580</span>        <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a6b0424c9d50c491ab32e7605cd9fdae2">duk_hthread_callstack_unwind</a>(thr, entry_callstack_top);</div>
<div class="line"><span class="lineno"> 1581</span>        <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#ab1328365d06bb689313bd28bdc006fbe">duk_hthread_callstack_shrink_check</a>(thr);</div>
<div class="line"><span class="lineno"> 1582</span> </div>
<div class="line"><span class="lineno"> 1583</span>        thr-&gt;valstack_bottom = thr-&gt;valstack + entry_valstack_bottom_index;</div>
<div class="line"><span class="lineno"> 1584</span>        <span class="comment">/* keep current valstack_top */</span></div>
<div class="line"><span class="lineno"> 1585</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(thr-&gt;valstack_bottom &gt;= thr-&gt;valstack);</div>
<div class="line"><span class="lineno"> 1586</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(thr-&gt;valstack_top &gt;= thr-&gt;valstack_bottom);</div>
<div class="line"><span class="lineno"> 1587</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(thr-&gt;valstack_end &gt;= thr-&gt;valstack_top);</div>
<div class="line"><span class="lineno"> 1588</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(thr-&gt;valstack_top - thr-&gt;valstack_bottom &gt;= idx_func + 1);</div>
<div class="line"><span class="lineno"> 1589</span> </div>
<div class="line"><span class="lineno"> 1590</span>        <span class="comment">/* Return value handling. */</span></div>
<div class="line"><span class="lineno"> 1591</span> </div>
<div class="line"><span class="lineno"> 1592</span>        <span class="comment">/* [ ... func this (crud) retval ] */</span></div>
<div class="line"><span class="lineno"> 1593</span> </div>
<div class="line"><span class="lineno"> 1594</span>        tv_ret = thr-&gt;valstack_bottom + idx_func;</div>
<div class="line"><span class="lineno"> 1595</span>        tv_funret = thr-&gt;valstack_top - 1;</div>
<div class="line"><span class="lineno"> 1596</span><span class="preprocessor">#if defined(DUK_USE_FASTINT)</span></div>
<div class="line"><span class="lineno"> 1597</span>        <span class="comment">/* Explicit check for fastint downgrade. */</span></div>
<div class="line"><span class="lineno"> 1598</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a85bcc7dd51670c32e9be58375e1bf618">DUK_TVAL_CHKFAST_INPLACE</a>(tv_funret);</div>
<div class="line"><span class="lineno"> 1599</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1600</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a707d3bb6b36563e69505b66a9b7335cf">DUK_TVAL_SET_TVAL_UPDREF</a>(thr, tv_ret, tv_funret);  <span class="comment">/* side effects */</span></div>
<div class="line"><span class="lineno"> 1601</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1602</span>        <span class="comment">/*</span></div>
<div class="line"><span class="lineno"> 1603</span><span class="comment">         *  Native call.</span></div>
<div class="line"><span class="lineno"> 1604</span><span class="comment">         */</span></div>
<div class="line"><span class="lineno"> 1605</span> </div>
<div class="line"><span class="lineno"> 1606</span>        <a class="code hl_struct" href="structduk__tval__struct.html">duk_tval</a> *tv_ret;</div>
<div class="line"><span class="lineno"> 1607</span>        <a class="code hl_struct" href="structduk__tval__struct.html">duk_tval</a> *tv_funret;</div>
<div class="line"><span class="lineno"> 1608</span> </div>
<div class="line"><span class="lineno"> 1609</span>        thr-&gt;valstack_bottom = thr-&gt;valstack_bottom + idx_func + 2;</div>
<div class="line"><span class="lineno"> 1610</span>        <span class="comment">/* keep current valstack_top */</span></div>
<div class="line"><span class="lineno"> 1611</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(thr-&gt;valstack_bottom &gt;= thr-&gt;valstack);</div>
<div class="line"><span class="lineno"> 1612</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(thr-&gt;valstack_top &gt;= thr-&gt;valstack_bottom);</div>
<div class="line"><span class="lineno"> 1613</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(thr-&gt;valstack_end &gt;= thr-&gt;valstack_top);</div>
<div class="line"><span class="lineno"> 1614</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(func == <a class="code hl_define" href="gmacros_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> || ((<a class="code hl_struct" href="structduk__hnativefunction.html">duk_hnativefunction</a> *) func)-&gt;func != <a class="code hl_define" href="gmacros_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><span class="lineno"> 1615</span> </div>
<div class="line"><span class="lineno"> 1616</span>        <span class="comment">/* [ ... func this | arg1 ... argN ] (&#39;this&#39; must precede new bottom) */</span></div>
<div class="line"><span class="lineno"> 1617</span> </div>
<div class="line"><span class="lineno"> 1618</span>        <span class="comment">/* For native calls must be NULL so we don&#39;t sync back */</span></div>
<div class="line"><span class="lineno"> 1619</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(thr-&gt;ptr_curr_pc == <a class="code hl_define" href="gmacros_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><span class="lineno"> 1620</span> </div>
<div class="line"><span class="lineno"> 1621</span>        <span class="keywordflow">if</span> (func) {</div>
<div class="line"><span class="lineno"> 1622</span>            rc = ((<a class="code hl_struct" href="structduk__hnativefunction.html">duk_hnativefunction</a> *) func)-&gt;func((<a class="code hl_struct" href="structduk__hthread.html">duk_context</a> *) thr);</div>
<div class="line"><span class="lineno"> 1623</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1624</span>            <a class="code hl_typedef" href="duktape-1_85_82_2src-noline_2duktape_8h.html#abbfc90e9e821f725fcc484431cf078d7">duk_c_function</a> funcptr = <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a3b500467f813b5bd9e8c8f561a85a93a">DUK_TVAL_GET_LIGHTFUNC_FUNCPTR</a>(tv_func);</div>
<div class="line"><span class="lineno"> 1625</span>            rc = funcptr((<a class="code hl_struct" href="structduk__hthread.html">duk_context</a> *) thr);</div>
<div class="line"><span class="lineno"> 1626</span>        }</div>
<div class="line"><span class="lineno"> 1627</span> </div>
<div class="line"><span class="lineno"> 1628</span>        <span class="comment">/* Automatic error throwing, retval check. */</span></div>
<div class="line"><span class="lineno"> 1629</span> </div>
<div class="line"><span class="lineno"> 1630</span>        <span class="keywordflow">if</span> (rc &lt; 0) {</div>
<div class="line"><span class="lineno"> 1631</span>            <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#abe3b9bb1677d53303510b06244c27f26">duk_error_throw_from_negative_rc</a>(thr, rc);</div>
<div class="line"><span class="lineno"> 1632</span>            <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a0f457284c000920f86441b7ca7cbfe08">DUK_UNREACHABLE</a>();</div>
<div class="line"><span class="lineno"> 1633</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (rc &gt; 1) {</div>
<div class="line"><span class="lineno"> 1634</span>            <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a5d7ecc05e08a0af8396793c7d6d9d916">DUK_ERROR_API</a>(thr, <span class="stringliteral">&quot;c function returned invalid rc&quot;</span>);</div>
<div class="line"><span class="lineno"> 1635</span>        }</div>
<div class="line"><span class="lineno"> 1636</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(rc == 0 || rc == 1);</div>
<div class="line"><span class="lineno"> 1637</span> </div>
<div class="line"><span class="lineno"> 1638</span>        <span class="comment">/* Unwind. */</span></div>
<div class="line"><span class="lineno"> 1639</span> </div>
<div class="line"><span class="lineno"> 1640</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(thr-&gt;catchstack_top == entry_catchstack_top);  <span class="comment">/* no need to unwind */</span></div>
<div class="line"><span class="lineno"> 1641</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(thr-&gt;callstack_top == entry_callstack_top + 1);</div>
<div class="line"><span class="lineno"> 1642</span>        <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a6b0424c9d50c491ab32e7605cd9fdae2">duk_hthread_callstack_unwind</a>(thr, entry_callstack_top);</div>
<div class="line"><span class="lineno"> 1643</span>        <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#ab1328365d06bb689313bd28bdc006fbe">duk_hthread_callstack_shrink_check</a>(thr);</div>
<div class="line"><span class="lineno"> 1644</span> </div>
<div class="line"><span class="lineno"> 1645</span>        thr-&gt;valstack_bottom = thr-&gt;valstack + entry_valstack_bottom_index;</div>
<div class="line"><span class="lineno"> 1646</span>        <span class="comment">/* keep current valstack_top */</span></div>
<div class="line"><span class="lineno"> 1647</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(thr-&gt;valstack_bottom &gt;= thr-&gt;valstack);</div>
<div class="line"><span class="lineno"> 1648</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(thr-&gt;valstack_top &gt;= thr-&gt;valstack_bottom);</div>
<div class="line"><span class="lineno"> 1649</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(thr-&gt;valstack_end &gt;= thr-&gt;valstack_top);</div>
<div class="line"><span class="lineno"> 1650</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(thr-&gt;valstack_top - thr-&gt;valstack_bottom &gt;= idx_func + 1);</div>
<div class="line"><span class="lineno"> 1651</span> </div>
<div class="line"><span class="lineno"> 1652</span>        <span class="comment">/* Return value handling. */</span></div>
<div class="line"><span class="lineno"> 1653</span> </div>
<div class="line"><span class="lineno"> 1654</span>        <span class="comment">/* XXX: should this happen in the callee&#39;s activation or after unwinding? */</span></div>
<div class="line"><span class="lineno"> 1655</span>        tv_ret = thr-&gt;valstack_bottom + idx_func;</div>
<div class="line"><span class="lineno"> 1656</span>        <span class="keywordflow">if</span> (rc == 0) {</div>
<div class="line"><span class="lineno"> 1657</span>            <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#acb7d8467c90d4c8f1c772eaff56f70e9">DUK_TVAL_SET_UNDEFINED_UPDREF</a>(thr, tv_ret);  <span class="comment">/* side effects */</span></div>
<div class="line"><span class="lineno"> 1658</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1659</span>            <span class="comment">/* [ ... func this (crud) retval ] */</span></div>
<div class="line"><span class="lineno"> 1660</span>            tv_funret = thr-&gt;valstack_top - 1;</div>
<div class="line"><span class="lineno"> 1661</span><span class="preprocessor">#if defined(DUK_USE_FASTINT)</span></div>
<div class="line"><span class="lineno"> 1662</span>            <span class="comment">/* Explicit check for fastint downgrade. */</span></div>
<div class="line"><span class="lineno"> 1663</span>            <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a85bcc7dd51670c32e9be58375e1bf618">DUK_TVAL_CHKFAST_INPLACE</a>(tv_funret);</div>
<div class="line"><span class="lineno"> 1664</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1665</span>            <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a707d3bb6b36563e69505b66a9b7335cf">DUK_TVAL_SET_TVAL_UPDREF</a>(thr, tv_ret, tv_funret);  <span class="comment">/* side effects */</span></div>
<div class="line"><span class="lineno"> 1666</span>        }</div>
<div class="line"><span class="lineno"> 1667</span>    }</div>
<div class="line"><span class="lineno"> 1668</span> </div>
<div class="line"><span class="lineno"> 1669</span>    <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a808471cbdda897175b2e4d50528c430d">duk_set_top</a>(ctx, idx_func + 1);  <span class="comment">/* XXX: unnecessary, handle in adjust */</span></div>
<div class="line"><span class="lineno"> 1670</span> </div>
<div class="line"><span class="lineno"> 1671</span>    <span class="comment">/* [ ... retval ] */</span></div>
<div class="line"><span class="lineno"> 1672</span> </div>
<div class="line"><span class="lineno"> 1673</span>    <span class="comment">/* Ensure there is internal valstack spare before we exit; this may</span></div>
<div class="line"><span class="lineno"> 1674</span><span class="comment">     * throw an alloc error.  The same guaranteed size must be available</span></div>
<div class="line"><span class="lineno"> 1675</span><span class="comment">     * as before the call.  This is not optimal now: we store the valstack</span></div>
<div class="line"><span class="lineno"> 1676</span><span class="comment">     * allocated size during entry; this value may be higher than the</span></div>
<div class="line"><span class="lineno"> 1677</span><span class="comment">     * minimal guarantee for an application.</span></div>
<div class="line"><span class="lineno"> 1678</span><span class="comment">     */</span></div>
<div class="line"><span class="lineno"> 1679</span> </div>
<div class="line"><span class="lineno"> 1680</span>    <span class="comment">/* XXX: we should never shrink here; when we error out later, we&#39;d</span></div>
<div class="line"><span class="lineno"> 1681</span><span class="comment">     * need to potentially grow the value stack in error unwind which could</span></div>
<div class="line"><span class="lineno"> 1682</span><span class="comment">     * cause another error.</span></div>
<div class="line"><span class="lineno"> 1683</span><span class="comment">     */</span></div>
<div class="line"><span class="lineno"> 1684</span> </div>
<div class="line"><span class="lineno"> 1685</span>    (void) <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a77c10520e83828337093fb75217c8994">duk_valstack_resize_raw</a>((<a class="code hl_struct" href="structduk__hthread.html">duk_context</a> *) thr,</div>
<div class="line"><span class="lineno"> 1686</span>                                   entry_valstack_end,                    <span class="comment">/* same as during entry */</span></div>
<div class="line"><span class="lineno"> 1687</span>                                   <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bb7e485dd3c5ecda5f3b08f5b0fd58">DUK_VSRESIZE_FLAG_SHRINK</a> |             <span class="comment">/* flags */</span></div>
<div class="line"><span class="lineno"> 1688</span>                                   <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a7a92ed8b660abc5849cd6db4a762598f">DUK_VSRESIZE_FLAG_COMPACT</a> |</div>
<div class="line"><span class="lineno"> 1689</span>                                   <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a207c421ba76ecb41b4ae7df1ef829112">DUK_VSRESIZE_FLAG_THROW</a>);</div>
<div class="line"><span class="lineno"> 1690</span> </div>
<div class="line"><span class="lineno"> 1691</span>    <span class="comment">/* Restore entry thread executor curr_pc stack frame pointer. */</span></div>
<div class="line"><span class="lineno"> 1692</span>    thr-&gt;ptr_curr_pc = entry_ptr_curr_pc;</div>
<div class="line"><span class="lineno"> 1693</span> </div>
<div class="line"><span class="lineno"> 1694</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#ada39afa145c10879d68bc705850edcd7">DUK_HEAP_SWITCH_THREAD</a>(thr-&gt;heap, entry_curr_thread);  <span class="comment">/* may be NULL */</span></div>
<div class="line"><span class="lineno"> 1695</span>    thr-&gt;state = (duk_uint8_t) entry_thread_state;</div>
<div class="line"><span class="lineno"> 1696</span> </div>
<div class="line"><span class="lineno"> 1697</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>((thr-&gt;state == <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a60d14816853d0b43d8f6e2d033a9df60">DUK_HTHREAD_STATE_INACTIVE</a> &amp;&amp; thr-&gt;heap-&gt;curr_thread == <a class="code hl_define" href="gmacros_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) ||  <span class="comment">/* first call */</span></div>
<div class="line"><span class="lineno"> 1698</span>               (thr-&gt;state == <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a60d14816853d0b43d8f6e2d033a9df60">DUK_HTHREAD_STATE_INACTIVE</a> &amp;&amp; thr-&gt;heap-&gt;curr_thread != <a class="code hl_define" href="gmacros_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) ||  <span class="comment">/* other call */</span></div>
<div class="line"><span class="lineno"> 1699</span>               (thr-&gt;state == <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a82ed1e61fa4a768cbc65401274bfd89a">DUK_HTHREAD_STATE_RUNNING</a> &amp;&amp; thr-&gt;heap-&gt;curr_thread == thr));     <span class="comment">/* current thread */</span></div>
<div class="line"><span class="lineno"> 1700</span> </div>
<div class="line"><span class="lineno"> 1701</span>    thr-&gt;heap-&gt;call_recursion_depth = entry_call_recursion_depth;</div>
<div class="line"><span class="lineno"> 1702</span> </div>
<div class="line"><span class="lineno"> 1703</span>    <span class="comment">/* If the debugger is active we need to force an interrupt so that</span></div>
<div class="line"><span class="lineno"> 1704</span><span class="comment">     * debugger breakpoints are rechecked.  This is important for function</span></div>
<div class="line"><span class="lineno"> 1705</span><span class="comment">     * calls caused by side effects (e.g. when doing a DUK_OP_GETPROP), see</span></div>
<div class="line"><span class="lineno"> 1706</span><span class="comment">     * GH-303.  Only needed for success path, error path always causes a</span></div>
<div class="line"><span class="lineno"> 1707</span><span class="comment">     * breakpoint recheck in the executor.  It would be enough to set this</span></div>
<div class="line"><span class="lineno"> 1708</span><span class="comment">     * only when returning to an Ecmascript activation, but setting the flag</span></div>
<div class="line"><span class="lineno"> 1709</span><span class="comment">     * on every return should have no ill effect.</span></div>
<div class="line"><span class="lineno"> 1710</span><span class="comment">     */</span></div>
<div class="line"><span class="lineno"> 1711</span><span class="preprocessor">#if defined(DUK_USE_DEBUGGER_SUPPORT)</span></div>
<div class="line"><span class="lineno"> 1712</span>    <span class="keywordflow">if</span> (DUK_HEAP_IS_DEBUGGER_ATTACHED(thr-&gt;heap)) {</div>
<div class="line"><span class="lineno"> 1713</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a6c3a2adb6e09294c7e65f69821e5e81a">DUK_DD</a>(<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#aa66ca9adc2b4187c5d549a9b117b03d3">DUK_DDPRINT</a>(<span class="stringliteral">&quot;returning with debugger enabled, force interrupt&quot;</span>));</div>
<div class="line"><span class="lineno"> 1714</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(thr-&gt;interrupt_counter &lt;= thr-&gt;interrupt_init);</div>
<div class="line"><span class="lineno"> 1715</span>        thr-&gt;interrupt_init -= thr-&gt;interrupt_counter;</div>
<div class="line"><span class="lineno"> 1716</span>        thr-&gt;interrupt_counter = 0;</div>
<div class="line"><span class="lineno"> 1717</span>        thr-&gt;heap-&gt;dbg_force_restart = 1;</div>
<div class="line"><span class="lineno"> 1718</span>    }</div>
<div class="line"><span class="lineno"> 1719</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1720</span> </div>
<div class="line"><span class="lineno"> 1721</span><span class="preprocessor">#if defined(DUK_USE_INTERRUPT_COUNTER) &amp;&amp; defined(DUK_USE_DEBUG)</span></div>
<div class="line"><span class="lineno"> 1722</span>    duk__interrupt_fixup(thr, entry_curr_thread);</div>
<div class="line"><span class="lineno"> 1723</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1724</span> </div>
<div class="line"><span class="lineno"> 1725</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1726</span> </div>
<div class="line"><span class="lineno"> 1727</span> thread_state_error:</div>
<div class="line"><span class="lineno"> 1728</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#af27bb9bfb183631e8c068865a8270012">DUK_ERROR_FMT1</a>(thr, <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8h.html#a02cde94a668a996bb017286a38c7e658">DUK_ERR_TYPE_ERROR</a>, <span class="stringliteral">&quot;invalid thread state for call (%ld)&quot;</span>, (<span class="keywordtype">long</span>) thr-&gt;state);</div>
<div class="line"><span class="lineno"> 1729</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a0f457284c000920f86441b7ca7cbfe08">DUK_UNREACHABLE</a>();</div>
<div class="line"><span class="lineno"> 1730</span>    <span class="keywordflow">return</span>;  <span class="comment">/* never executed */</span></div>
<div class="line"><span class="lineno"> 1731</span>}</div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duk__config_8h_html_a0f457284c000920f86441b7ca7cbfe08"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a0f457284c000920f86441b7ca7cbfe08">DUK_UNREACHABLE</a></div><div class="ttdeci">#define DUK_UNREACHABLE()</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duk__config_8h_source.html#l02504">duktape-1.5.2/src-noline/duk_config.h:2504</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duk__config_8h_html_a2b7ba45bf826058a9b7720b5e258efc6"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a2b7ba45bf826058a9b7720b5e258efc6">duk_small_uint_t</a></div><div class="ttdeci">unsigned int duk_small_uint_t</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duk__config_8h_source.html#l01808">duktape-1.5.2/src-noline/duk_config.h:1808</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duk__config_8h_html_a3cd45ada834d9a7fcfcaf2d654435c6c"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a3cd45ada834d9a7fcfcaf2d654435c6c">duk_ret_t</a></div><div class="ttdeci">duk_small_int_t duk_ret_t</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duk__config_8h_source.html#l01850">duktape-1.5.2/src-noline/duk_config.h:1850</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duk__config_8h_html_a7ce35d12b12e3eea5f8d46c6195650d1"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a7ce35d12b12e3eea5f8d46c6195650d1">duk_uint_fast8_t</a></div><div class="ttdeci">duk_uint8_t duk_uint_fast8_t</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duk__config_8h_source.html#l01627">duktape-1.5.2/src-noline/duk_config.h:1627</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duk__config_8h_html_a9170138f330dbcaabfae9d2c59cc9684"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a9170138f330dbcaabfae9d2c59cc9684">DUK_UNREF</a></div><div class="ttdeci">#define DUK_UNREF(x)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duk__config_8h_source.html#l02494">duktape-1.5.2/src-noline/duk_config.h:2494</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duk__config_8h_html_a9dbc0fdd27e7326d21cbf56e6d40d8a5"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a9dbc0fdd27e7326d21cbf56e6d40d8a5">duk_int_t</a></div><div class="ttdeci">duk_int_fast32_t duk_int_t</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duk__config_8h_source.html#l01785">duktape-1.5.2/src-noline/duk_config.h:1785</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_a0490bab9b44658a5ac4aad3bc88b0e4b"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#a0490bab9b44658a5ac4aad3bc88b0e4b">duk_hthread_callstack_grow</a></div><div class="ttdeci">DUK_INTERNAL_DECL void duk_hthread_callstack_grow(duk_hthread *thr)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l54177">duktape-1.5.2/src-noline/duktape.c:54177</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_a04ff20dec8ac63c2010d16bcfd823d15"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#a04ff20dec8ac63c2010d16bcfd823d15">DUK_TVAL_SET_TVAL</a></div><div class="ttdeci">#define DUK_TVAL_SET_TVAL(v, x)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l00755">duktape-1.5.2/src-noline/duktape.c:755</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_a0516cfba051919d12ec8a46e815b178f"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#a0516cfba051919d12ec8a46e815b178f">DUK_ACT_FLAG_PREVENT_YIELD</a></div><div class="ttdeci">#define DUK_ACT_FLAG_PREVENT_YIELD</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l05990">duktape-1.5.2/src-noline/duktape.c:5990</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_a06fc3069d0dbc1b0d9d28c15bb07e1ce"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#a06fc3069d0dbc1b0d9d28c15bb07e1ce">DUK_ASSERT_CTX_VALID</a></div><div class="ttdeci">#define DUK_ASSERT_CTX_VALID(ctx)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06106">duktape-1.5.2/src-noline/duktape.c:6106</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_a0face1475afe4e3efae57c1386b88c32"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#a0face1475afe4e3efae57c1386b88c32">DUK_STR_NOT_CALLABLE</a></div><div class="ttdeci">#define DUK_STR_NOT_CALLABLE</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l02281">duktape-1.5.2/src-noline/duktape.c:2281</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_a108793d34c82fc91faeb744adf2ce722"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#a108793d34c82fc91faeb744adf2ce722">DUK_HCOMPILEDFUNCTION_GET_CODE_BASE</a></div><div class="ttdeci">#define DUK_HCOMPILEDFUNCTION_GET_CODE_BASE(heap, h)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l05603">duktape-1.5.2/src-noline/duktape.c:5603</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_a13623e5d472d92f656ad1d9a2875d277"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#a13623e5d472d92f656ad1d9a2875d277">DUK_ERROR_TYPE</a></div><div class="ttdeci">#define DUK_ERROR_TYPE(thr, msg)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07882">duktape-1.5.2/src-noline/duktape.c:7882</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_a19a9d6a4b52e03c7f42e925cfe76992f"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#a19a9d6a4b52e03c7f42e925cfe76992f">DUK_CALL_FLAG_CONSTRUCTOR_CALL</a></div><div class="ttdeci">#define DUK_CALL_FLAG_CONSTRUCTOR_CALL</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l08344">duktape-1.5.2/src-noline/duktape.c:8344</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_a2c84775718b9520a875530d3f92b4b5b"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#a2c84775718b9520a875530d3f92b4b5b">duk_create_activation_environment_record</a></div><div class="ttdeci">DUK_INTERNAL_DECL duk_hobject * duk_create_activation_environment_record(duk_hthread *thr, duk_hobject *func, duk_size_t idx_bottom)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l71582">duktape-1.5.2/src-noline/duktape.c:71582</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_a3b446d4cd53f63e5e57b80041eb0d598"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#a3b446d4cd53f63e5e57b80041eb0d598">DUK_HOBJECT_IS_COMPILEDFUNCTION</a></div><div class="ttdeci">#define DUK_HOBJECT_IS_COMPILEDFUNCTION(h)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l04774">duktape-1.5.2/src-noline/duktape.c:4774</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_a3b500467f813b5bd9e8c8f561a85a93a"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#a3b500467f813b5bd9e8c8f561a85a93a">DUK_TVAL_GET_LIGHTFUNC_FUNCPTR</a></div><div class="ttdeci">#define DUK_TVAL_GET_LIGHTFUNC_FUNCPTR(tv)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l00784">duktape-1.5.2/src-noline/duktape.c:784</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_a405107c06eacfb0b9b6e82aaaa609b9d"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#a405107c06eacfb0b9b6e82aaaa609b9d">DUK_HOBJECT_HAS_CREATEARGS</a></div><div class="ttdeci">#define DUK_HOBJECT_HAS_CREATEARGS(h)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l04815">duktape-1.5.2/src-noline/duktape.c:4815</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_a56d7614c6c54403b83c190449622328f"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#a56d7614c6c54403b83c190449622328f">DUK_ACT_FLAG_STRICT</a></div><div class="ttdeci">#define DUK_ACT_FLAG_STRICT</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l05987">duktape-1.5.2/src-noline/duktape.c:5987</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_a611f8fe05a3a8885f2c7568ac80a34c9"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#a611f8fe05a3a8885f2c7568ac80a34c9">DUK_ACT_FLAG_DIRECT_EVAL</a></div><div class="ttdeci">#define DUK_ACT_FLAG_DIRECT_EVAL</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l05991">duktape-1.5.2/src-noline/duktape.c:5991</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_a652ca5b5e92f72cf5bfccf39611eca11"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#a652ca5b5e92f72cf5bfccf39611eca11">DUK_LFUNC_NARGS_VARARGS</a></div><div class="ttdeci">#define DUK_LFUNC_NARGS_VARARGS</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l00851">duktape-1.5.2/src-noline/duktape.c:851</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_a74b3c69afa49e28b1680178cd9c8715d"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#a74b3c69afa49e28b1680178cd9c8715d">DUK_ACT_FLAG_CONSTRUCT</a></div><div class="ttdeci">#define DUK_ACT_FLAG_CONSTRUCT</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l05989">duktape-1.5.2/src-noline/duktape.c:5989</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_a8c8653fcd951809042c23c42e534c421"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#a8c8653fcd951809042c23c42e534c421">duk_get_top</a></div><div class="ttdeci">DUK_EXTERNAL duk_idx_t duk_get_top(duk_context *ctx)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l15204">duktape-1.5.2/src-noline/duktape.c:15204</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_a8cee88ae1401c33134400aa455dd6754"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#a8cee88ae1401c33134400aa455dd6754">duk_hthread_sync_and_null_currpc</a></div><div class="ttdeci">DUK_INTERNAL_DECL void duk_hthread_sync_and_null_currpc(duk_hthread *thr)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l54139">duktape-1.5.2/src-noline/duktape.c:54139</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_a9231b6cd154afc387b6282e9bb8e0c6e"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#a9231b6cd154afc387b6282e9bb8e0c6e">duk_instr_t</a></div><div class="ttdeci">duk_uint32_t duk_instr_t</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l02537">duktape-1.5.2/src-noline/duktape.c:2537</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_aa065bcb3f7f1d242bd6baa3a285dc0d8"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#aa065bcb3f7f1d242bd6baa3a285dc0d8">DUK_STR_C_CALLSTACK_LIMIT</a></div><div class="ttdeci">#define DUK_STR_C_CALLSTACK_LIMIT</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l02472">duktape-1.5.2/src-noline/duktape.c:2472</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_abc40e3d6cc4e2c0c659abdb0bd5ab78b"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#abc40e3d6cc4e2c0c659abdb0bd5ab78b">DUK_HOBJECT_HAS_NEWENV</a></div><div class="ttdeci">#define DUK_HOBJECT_HAS_NEWENV(h)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l04813">duktape-1.5.2/src-noline/duktape.c:4813</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_abe3b9bb1677d53303510b06244c27f26"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#abe3b9bb1677d53303510b06244c27f26">duk_error_throw_from_negative_rc</a></div><div class="ttdeci">DUK_INTERNAL void duk_error_throw_from_negative_rc(duk_hthread *thr, duk_ret_t rc)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l40421">duktape-1.5.2/src-noline/duktape.c:40421</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_acec31793b1aa8698cdd68ec7015146a9"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#acec31793b1aa8698cdd68ec7015146a9">DUK_LFUNC_FLAGS_GET_NARGS</a></div><div class="ttdeci">#define DUK_LFUNC_FLAGS_GET_NARGS(lf_flags)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l00846">duktape-1.5.2/src-noline/duktape.c:846</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_ad0cff35ef1e7aa971563b058bd47e5d2"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#ad0cff35ef1e7aa971563b058bd47e5d2">DUK_CALL_FLAG_DIRECT_EVAL</a></div><div class="ttdeci">#define DUK_CALL_FLAG_DIRECT_EVAL</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l08347">duktape-1.5.2/src-noline/duktape.c:8347</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_aec3eb13ec7276cc2edf08eee64ec7845"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#aec3eb13ec7276cc2edf08eee64ec7845">duk_js_execute_bytecode</a></div><div class="ttdeci">DUK_INTERNAL_DECL void duk_js_execute_bytecode(duk_hthread *exec_thr)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l67244">duktape-1.5.2/src-noline/duktape.c:67244</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_aee2b028c473ecd0ac84f414e3ccaacd1"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#aee2b028c473ecd0ac84f414e3ccaacd1">DUK_HOBJECT_INCREF_ALLOWNULL</a></div><div class="ttdeci">#define DUK_HOBJECT_INCREF_ALLOWNULL(thr, h)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l03838">duktape-1.5.2/src-noline/duktape.c:3838</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_af27bb9bfb183631e8c068865a8270012"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#af27bb9bfb183631e8c068865a8270012">DUK_ERROR_FMT1</a></div><div class="ttdeci">#define DUK_ERROR_FMT1(thr, err, fmt, arg1)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07628">duktape-1.5.2/src-noline/duktape.c:7628</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_af6d39c7f5b5aa18478e5aec403d3247c"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#af6d39c7f5b5aa18478e5aec403d3247c">DUK_TVAL_GET_LIGHTFUNC_FLAGS</a></div><div class="ttdeci">#define DUK_TVAL_GET_LIGHTFUNC_FLAGS(tv)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l00785">duktape-1.5.2/src-noline/duktape.c:785</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_afa9b99df5108fec08cd0dc85f30d70da"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#afa9b99df5108fec08cd0dc85f30d70da">DUK_CALL_FLAG_IGNORE_RECLIMIT</a></div><div class="ttdeci">#define DUK_CALL_FLAG_IGNORE_RECLIMIT</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l08343">duktape-1.5.2/src-noline/duktape.c:8343</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8h_html_a02cde94a668a996bb017286a38c7e658"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8h.html#a02cde94a668a996bb017286a38c7e658">DUK_ERR_TYPE_ERROR</a></div><div class="ttdeci">#define DUK_ERR_TYPE_ERROR</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8h_source.html#l00345">duktape-1.5.2/src-noline/duktape.h:345</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8h_html_abbfc90e9e821f725fcc484431cf078d7"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8h.html#abbfc90e9e821f725fcc484431cf078d7">duk_c_function</a></div><div class="ttdeci">duk_ret_t(* duk_c_function)(duk_context *ctx)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8h_source.html#l00177">duktape-1.5.2/src-noline/duktape.h:177</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-separate_2duk__js__call_8c_html_a08825b479944b1b525fe432f83bbe57e"><div class="ttname"><a href="#a08825b479944b1b525fe432f83bbe57e">duk__coerce_effective_this_binding</a></div><div class="ttdeci">DUK_LOCAL void duk__coerce_effective_this_binding(duk_hthread *thr, duk_hobject *func, duk_idx_t idx_this)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-separate_2duk__js__call_8c_source.html#l00665">duktape-1.5.2/src-separate/duk_js_call.c:665</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-separate_2duk__js__call_8c_html_a0d5042617a44a3204d4839319683aeb2"><div class="ttname"><a href="#a0d5042617a44a3204d4839319683aeb2">duk__nonbound_func_lookup</a></div><div class="ttdeci">DUK_LOCAL duk_hobject * duk__nonbound_func_lookup(duk_context *ctx, duk_idx_t idx_func, duk_idx_t *out_num_stack_args, duk_tval **out_tv_func, duk_small_uint_t call_flags)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-separate_2duk__js__call_8c_source.html#l00717">duktape-1.5.2/src-separate/duk_js_call.c:717</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-separate_2duk__js__call_8c_html_a208a38260dcc44fddbc4658759b71f08"><div class="ttname"><a href="#a208a38260dcc44fddbc4658759b71f08">duk__handle_oldenv_for_call</a></div><div class="ttdeci">DUK_LOCAL void duk__handle_oldenv_for_call(duk_hthread *thr, duk_hobject *func, duk_activation *act)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-separate_2duk__js__call_8c_source.html#l00523">duktape-1.5.2/src-separate/duk_js_call.c:523</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-separate_2duk__js__call_8c_html_a24504a6bbcf7c2ac1bbcf078f0313652"><div class="ttname"><a href="#a24504a6bbcf7c2ac1bbcf078f0313652">duk__adjust_valstack_and_top</a></div><div class="ttdeci">DUK_LOCAL void duk__adjust_valstack_and_top(duk_hthread *thr, duk_idx_t num_stack_args, duk_idx_t idx_args, duk_idx_t nregs, duk_idx_t nargs, duk_hobject *func)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-separate_2duk__js__call_8c_source.html#l00782">duktape-1.5.2/src-separate/duk_js_call.c:782</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-separate_2duk__js__call_8c_html_a988107c9c80890ed0641244b749a1969"><div class="ttname"><a href="#a988107c9c80890ed0641244b749a1969">duk__handle_createargs_for_call</a></div><div class="ttdeci">DUK_LOCAL void duk__handle_createargs_for_call(duk_hthread *thr, duk_hobject *func, duk_hobject *env, duk_idx_t num_stack_args)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-separate_2duk__js__call_8c_source.html#l00360">duktape-1.5.2/src-separate/duk_js_call.c:360</a></div></div>
<div class="ttc" id="astructduk__activation_html"><div class="ttname"><a href="structduk__activation.html">duk_activation</a></div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06129">duktape-1.5.2/src-noline/duktape.c:6129</a></div></div>
<div class="ttc" id="astructduk__activation_html_a05a11e283998d74a28767200b42d1bc1"><div class="ttname"><a href="structduk__activation.html#a05a11e283998d74a28767200b42d1bc1">duk_activation::flags</a></div><div class="ttdeci">duk_small_uint_t flags</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06145">duktape-1.5.2/src-noline/duktape.c:6145</a></div></div>
<div class="ttc" id="astructduk__activation_html_a181b5225468a571c32b94317422e08f2"><div class="ttname"><a href="structduk__activation.html#a181b5225468a571c32b94317422e08f2">duk_activation::idx_bottom</a></div><div class="ttdeci">duk_size_t idx_bottom</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06159">duktape-1.5.2/src-noline/duktape.c:6159</a></div></div>
<div class="ttc" id="astructduk__activation_html_a19ed13846f28deb48700a005c10aba8c"><div class="ttname"><a href="structduk__activation.html#a19ed13846f28deb48700a005c10aba8c">duk_activation::curr_pc</a></div><div class="ttdeci">duk_instr_t * curr_pc</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06141">duktape-1.5.2/src-noline/duktape.c:6141</a></div></div>
<div class="ttc" id="astructduk__activation_html_a2e3041f6643f991adf53a6a8d55ea3c3"><div class="ttname"><a href="structduk__activation.html#a2e3041f6643f991adf53a6a8d55ea3c3">duk_activation::lex_env</a></div><div class="ttdeci">duk_hobject * lex_env</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06133">duktape-1.5.2/src-noline/duktape.c:6133</a></div></div>
<div class="ttc" id="astructduk__activation_html_a6de02a28083672138fb33da69fbf701a"><div class="ttname"><a href="structduk__activation.html#a6de02a28083672138fb33da69fbf701a">duk_activation::func</a></div><div class="ttdeci">duk_hobject * func</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06131">duktape-1.5.2/src-noline/duktape.c:6131</a></div></div>
<div class="ttc" id="astructduk__activation_html_a92ea93909d22ddbd33cfc46f32726387"><div class="ttname"><a href="structduk__activation.html#a92ea93909d22ddbd33cfc46f32726387">duk_activation::var_env</a></div><div class="ttdeci">duk_hobject * var_env</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06132">duktape-1.5.2/src-noline/duktape.c:6132</a></div></div>
<div class="ttc" id="astructduk__activation_html_aee23fb32ca20b90a8c06cd785c61534b"><div class="ttname"><a href="structduk__activation.html#aee23fb32ca20b90a8c06cd785c61534b">duk_activation::tv_func</a></div><div class="ttdeci">duk_tval tv_func</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06130">duktape-1.5.2/src-noline/duktape.c:6130</a></div></div>
<div class="ttc" id="astructduk__activation_html_af82e168e163ea9e05c40281092e44347"><div class="ttname"><a href="structduk__activation.html#af82e168e163ea9e05c40281092e44347">duk_activation::idx_retval</a></div><div class="ttdeci">duk_size_t idx_retval</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06171">duktape-1.5.2/src-noline/duktape.c:6171</a></div></div>
<div class="ttc" id="astructduk__hcompiledfunction_html"><div class="ttname"><a href="structduk__hcompiledfunction.html">duk_hcompiledfunction</a></div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l05658">duktape-1.5.2/src-noline/duktape.c:5658</a></div></div>
<div class="ttc" id="astructduk__hnativefunction_html"><div class="ttname"><a href="structduk__hnativefunction.html">duk_hnativefunction</a></div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l05788">duktape-1.5.2/src-noline/duktape.c:5788</a></div></div>
<div class="ttc" id="astructduk__hthread_html_a09749b7b70f6fd8ad3661adfac3316b5"><div class="ttname"><a href="structduk__hthread.html#a09749b7b70f6fd8ad3661adfac3316b5">duk_hthread::valstack_end</a></div><div class="ttdeci">duk_tval * valstack_end</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06227">duktape-1.5.2/src-noline/duktape.c:6227</a></div></div>
<div class="ttc" id="astructduk__hthread_html_ac03631b2f8ff5bab23d409f0bb966579"><div class="ttname"><a href="structduk__hthread.html#ac03631b2f8ff5bab23d409f0bb966579">duk_hthread::callstack</a></div><div class="ttdeci">duk_activation * callstack</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06235">duktape-1.5.2/src-noline/duktape.c:6235</a></div></div>
<div class="ttc" id="astructduk__hthread_html_ad195c4cbdb413aa9c6d4144a3959e749"><div class="ttname"><a href="structduk__hthread.html#ad195c4cbdb413aa9c6d4144a3959e749">duk_hthread::valstack_size</a></div><div class="ttdeci">duk_size_t valstack_size</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06231">duktape-1.5.2/src-noline/duktape.c:6231</a></div></div>
<div class="ttc" id="astructduk__hthread_html_af6ad1a5c8500ffe6443be8fec677a775"><div class="ttname"><a href="structduk__hthread.html#af6ad1a5c8500ffe6443be8fec677a775">duk_hthread::catchstack</a></div><div class="ttdeci">duk_catcher * catchstack</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06241">duktape-1.5.2/src-noline/duktape.c:6241</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07050">duk_heap::call_recursion_depth</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07051">duk_heap::call_recursion_limit</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06235">duk_hthread::callstack</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06238">duk_hthread::callstack_preventcount</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06236">duk_hthread::callstack_size</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06237">duk_hthread::callstack_top</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06241">duk_hthread::catchstack</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06243">duk_hthread::catchstack_top</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06141">duk_activation::curr_pc</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07044">duk_heap::curr_thread</a>, <a class="el" href="duktape-1_85_82_2src-separate_2duk__js__call_8c_source.html#l00782">duk__adjust_valstack_and_top()</a>, <a class="el" href="duktape-1_85_82_2src-separate_2duk__js__call_8c_source.html#l00665">duk__coerce_effective_this_binding()</a>, <a class="el" href="duktape-1_85_82_2src-separate_2duk__js__call_8c_source.html#l00360">duk__handle_createargs_for_call()</a>, <a class="el" href="duktape-1_85_82_2src-separate_2duk__js__call_8c_source.html#l00523">duk__handle_oldenv_for_call()</a>, <a class="el" href="duktape-1_85_82_2src-separate_2duk__js__call_8c_source.html#l00717">duk__nonbound_func_lookup()</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l05989">DUK_ACT_FLAG_CONSTRUCT</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l05991">DUK_ACT_FLAG_DIRECT_EVAL</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l05990">DUK_ACT_FLAG_PREVENT_YIELD</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l05987">DUK_ACT_FLAG_STRICT</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07755">DUK_ASSERT</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06106">DUK_ASSERT_CTX_VALID</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l08344">DUK_CALL_FLAG_CONSTRUCTOR_CALL</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l08347">DUK_CALL_FLAG_DIRECT_EVAL</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l08343">DUK_CALL_FLAG_IGNORE_RECLIMIT</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l71582">duk_create_activation_environment_record()</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07496">DUK_DD</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07497">DUK_DDD</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07509">DUK_DDDPRINT</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07508">DUK_DDPRINT</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8h_source.html#l00345">DUK_ERR_TYPE_ERROR</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07869">DUK_ERROR_API</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07628">DUK_ERROR_FMT1</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07875">DUK_ERROR_RANGE</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l40421">duk_error_throw_from_negative_rc()</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07882">DUK_ERROR_TYPE</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l15204">duk_get_top()</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l15121">duk_get_tval()</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l05603">DUK_HCOMPILEDFUNCTION_GET_CODE_BASE</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06735">DUK_HEAP_SWITCH_THREAD</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l04805">DUK_HOBJECT_HAS_BOUND</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l04806">DUK_HOBJECT_HAS_COMPILEDFUNCTION</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l04815">DUK_HOBJECT_HAS_CREATEARGS</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l04813">DUK_HOBJECT_HAS_NEWENV</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l04811">DUK_HOBJECT_HAS_STRICT</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l03822">DUK_HOBJECT_INCREF</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l03838">DUK_HOBJECT_INCREF_ALLOWNULL</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l04774">DUK_HOBJECT_IS_COMPILEDFUNCTION</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l04775">DUK_HOBJECT_IS_NATIVEFUNCTION</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l54177">duk_hthread_callstack_grow()</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l54217">duk_hthread_callstack_shrink_check()</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l54255">duk_hthread_callstack_unwind()</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l54522">duk_hthread_catchstack_shrink_check()</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l54560">duk_hthread_catchstack_unwind()</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06076">DUK_HTHREAD_STATE_INACTIVE</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06077">DUK_HTHREAD_STATE_RUNNING</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l54139">duk_hthread_sync_and_null_currpc()</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l67244">duk_js_execute_bytecode()</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l00846">DUK_LFUNC_FLAGS_GET_NARGS</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l00851">DUK_LFUNC_NARGS_VARARGS</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h_source.html#l02515">DUK_LIKELY</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l19146">duk_pop()</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l15216">duk_set_top()</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l02472">DUK_STR_C_CALLSTACK_LIMIT</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l02281">DUK_STR_NOT_CALLABLE</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l00720">DUK_TVAL_CHKFAST_INPLACE</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l00785">DUK_TVAL_GET_LIGHTFUNC_FLAGS</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l00784">DUK_TVAL_GET_LIGHTFUNC_FUNCPTR</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l00809">DUK_TVAL_IS_LIGHTFUNC</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l00755">DUK_TVAL_SET_TVAL</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l04029">DUK_TVAL_SET_TVAL_UPDREF</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l04004">DUK_TVAL_SET_UNDEFINED_UPDREF</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h_source.html#l02504">DUK_UNREACHABLE</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h_source.html#l02494">DUK_UNREF</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l15491">duk_valstack_resize_raw()</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l04221">DUK_VSRESIZE_FLAG_COMPACT</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l04220">DUK_VSRESIZE_FLAG_SHRINK</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l04222">DUK_VSRESIZE_FLAG_THROW</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06145">duk_activation::flags</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06131">duk_activation::func</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06202">duk_hthread::heap</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06159">duk_activation::idx_bottom</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06171">duk_activation::idx_retval</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06133">duk_activation::lex_env</a>, <a class="el" href="gmacros_8h_source.html#l00924">NULL</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06199">duk_hthread::ptr_curr_pc</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06208">duk_hthread::state</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06130">duk_activation::tv_func</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06226">duk_hthread::valstack</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06228">duk_hthread::valstack_bottom</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06227">duk_hthread::valstack_end</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06231">duk_hthread::valstack_size</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06229">duk_hthread::valstack_top</a>, and <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06132">duk_activation::var_env</a>.</p>

<p class="reference">Referenced by <a class="el" href="duktape-1_85_82_2src-separate_2duk__js__call_8c_source.html#l00966">duk_handle_call_protected()</a>, and <a class="el" href="duktape-1_85_82_2src-separate_2duk__js__call_8c_source.html#l01147">duk_handle_call_unprotected()</a>.</p>

</div>
</div>
<a id="a988107c9c80890ed0641244b749a1969" name="a988107c9c80890ed0641244b749a1969"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a988107c9c80890ed0641244b749a1969">&#9670;&#160;</a></span>duk__handle_createargs_for_call()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a245b431abb36cac1ac8d0eae054ed5c1">DUK_LOCAL</a> void duk__handle_createargs_for_call </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structduk__hthread.html">duk_hthread</a> *</td>          <td class="paramname"><span class="paramname"><em>thr</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structduk__hobject.html">duk_hobject</a> *</td>          <td class="paramname"><span class="paramname"><em>func</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structduk__hobject.html">duk_hobject</a> *</td>          <td class="paramname"><span class="paramname"><em>env</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a3e3bb369382aab50155c1d18bdf73923">duk_idx_t</a></td>          <td class="paramname"><span class="paramname"><em>num_stack_args</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="duktape-1_85_82_2src-separate_2duk__js__call_8c_source.html#l00360">360</a> of file <a class="el" href="duktape-1_85_82_2src-separate_2duk__js__call_8c_source.html">duktape-1.5.2/src-separate/duk_js_call.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  363</span>                                                                         {</div>
<div class="line"><span class="lineno">  364</span>    <a class="code hl_struct" href="structduk__hthread.html">duk_context</a> *ctx = (<a class="code hl_struct" href="structduk__hthread.html">duk_context</a> *) thr;</div>
<div class="line"><span class="lineno">  365</span> </div>
<div class="line"><span class="lineno">  366</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a2db20d2d3b36d8491ed171cf503488bb">DUK_DDD</a>(<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#aa6e5d41ceaba6832e5ede737f0a35fb9">DUK_DDDPRINT</a>(<span class="stringliteral">&quot;creating arguments object for function call&quot;</span>));</div>
<div class="line"><span class="lineno">  367</span> </div>
<div class="line"><span class="lineno">  368</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(thr != <a class="code hl_define" href="gmacros_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><span class="lineno">  369</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(func != <a class="code hl_define" href="gmacros_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><span class="lineno">  370</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(env != <a class="code hl_define" href="gmacros_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><span class="lineno">  371</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a405107c06eacfb0b9b6e82aaaa609b9d">DUK_HOBJECT_HAS_CREATEARGS</a>(func));</div>
<div class="line"><span class="lineno">  372</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(<a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a8c8653fcd951809042c23c42e534c421">duk_get_top</a>(ctx) &gt;= num_stack_args + 1);</div>
<div class="line"><span class="lineno">  373</span> </div>
<div class="line"><span class="lineno">  374</span>    <span class="comment">/* [ ... arg1 ... argN envobj ] */</span></div>
<div class="line"><span class="lineno">  375</span> </div>
<div class="line"><span class="lineno">  376</span>    <a class="code hl_function" href="#a0e907083e0c0fef469fbf2c811353d71">duk__create_arguments_object</a>(thr,</div>
<div class="line"><span class="lineno">  377</span>                                 func,</div>
<div class="line"><span class="lineno">  378</span>                                 env,</div>
<div class="line"><span class="lineno">  379</span>                                 <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a8c8653fcd951809042c23c42e534c421">duk_get_top</a>(ctx) - num_stack_args - 1,    <span class="comment">/* idx_argbase */</span></div>
<div class="line"><span class="lineno">  380</span>                                 num_stack_args);</div>
<div class="line"><span class="lineno">  381</span> </div>
<div class="line"><span class="lineno">  382</span>    <span class="comment">/* [ ... arg1 ... argN envobj argobj ] */</span></div>
<div class="line"><span class="lineno">  383</span> </div>
<div class="line"><span class="lineno">  384</span>    <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#ad56b7a318e093d42e552c2cf25d492e8">duk_xdef_prop_stridx</a>(ctx,</div>
<div class="line"><span class="lineno">  385</span>                         -2,</div>
<div class="line"><span class="lineno">  386</span>                         <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a2238185c7d78755b307636a874abcfb5">DUK_STRIDX_LC_ARGUMENTS</a>,</div>
<div class="line"><span class="lineno">  387</span>                         <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#ae5226f867ccd5073adc2df9140389ecb">DUK_HOBJECT_HAS_STRICT</a>(func) ? <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a51b66de8ae64a31c705a4da6154fa34e">DUK_PROPDESC_FLAGS_E</a> :   <span class="comment">/* strict: non-deletable, non-writable */</span></div>
<div class="line"><span class="lineno">  388</span>                                                        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a526d36cbd2d98fc8f1e04e0198e7dd31">DUK_PROPDESC_FLAGS_WE</a>);  <span class="comment">/* non-strict: non-deletable, writable */</span></div>
<div class="line"><span class="lineno">  389</span>    <span class="comment">/* [ ... arg1 ... argN envobj ] */</span></div>
<div class="line"><span class="lineno">  390</span>}</div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_a2238185c7d78755b307636a874abcfb5"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#a2238185c7d78755b307636a874abcfb5">DUK_STRIDX_LC_ARGUMENTS</a></div><div class="ttdeci">#define DUK_STRIDX_LC_ARGUMENTS</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l01080">duktape-1.5.2/src-noline/duktape.c:1080</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_a51b66de8ae64a31c705a4da6154fa34e"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#a51b66de8ae64a31c705a4da6154fa34e">DUK_PROPDESC_FLAGS_E</a></div><div class="ttdeci">#define DUK_PROPDESC_FLAGS_E</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l04882">duktape-1.5.2/src-noline/duktape.c:4882</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_a526d36cbd2d98fc8f1e04e0198e7dd31"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#a526d36cbd2d98fc8f1e04e0198e7dd31">DUK_PROPDESC_FLAGS_WE</a></div><div class="ttdeci">#define DUK_PROPDESC_FLAGS_WE</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l04884">duktape-1.5.2/src-noline/duktape.c:4884</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-separate_2duk__js__call_8c_html_a0e907083e0c0fef469fbf2c811353d71"><div class="ttname"><a href="#a0e907083e0c0fef469fbf2c811353d71">duk__create_arguments_object</a></div><div class="ttdeci">DUK_LOCAL void duk__create_arguments_object(duk_hthread *thr, duk_hobject *func, duk_hobject *varenv, duk_idx_t idx_argbase, duk_idx_t num_stack_args)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-separate_2duk__js__call_8c_source.html#l00109">duktape-1.5.2/src-separate/duk_js_call.c:109</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="duktape-1_85_82_2src-separate_2duk__js__call_8c_source.html#l00109">duk__create_arguments_object()</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07755">DUK_ASSERT</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07497">DUK_DDD</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07509">DUK_DDDPRINT</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l15204">duk_get_top()</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l04815">DUK_HOBJECT_HAS_CREATEARGS</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l04811">DUK_HOBJECT_HAS_STRICT</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l04882">DUK_PROPDESC_FLAGS_E</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l04884">DUK_PROPDESC_FLAGS_WE</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l01080">DUK_STRIDX_LC_ARGUMENTS</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l14559">duk_xdef_prop_stridx()</a>, and <a class="el" href="gmacros_8h_source.html#l00924">NULL</a>.</p>

<p class="reference">Referenced by <a class="el" href="duktape-1_85_82_2src-separate_2duk__js__call_8c_source.html#l01158">duk__handle_call_inner()</a>, and <a class="el" href="duktape-1_85_82_2src-separate_2duk__js__call_8c_source.html#l02290">duk_handle_ecma_call_setup()</a>.</p>

</div>
</div>
<a id="a208a38260dcc44fddbc4658759b71f08" name="a208a38260dcc44fddbc4658759b71f08"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a208a38260dcc44fddbc4658759b71f08">&#9670;&#160;</a></span>duk__handle_oldenv_for_call()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a245b431abb36cac1ac8d0eae054ed5c1">DUK_LOCAL</a> void duk__handle_oldenv_for_call </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structduk__hthread.html">duk_hthread</a> *</td>          <td class="paramname"><span class="paramname"><em>thr</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structduk__hobject.html">duk_hobject</a> *</td>          <td class="paramname"><span class="paramname"><em>func</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structduk__activation.html">duk_activation</a> *</td>          <td class="paramname"><span class="paramname"><em>act</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="duktape-1_85_82_2src-separate_2duk__js__call_8c_source.html#l00523">523</a> of file <a class="el" href="duktape-1_85_82_2src-separate_2duk__js__call_8c_source.html">duktape-1.5.2/src-separate/duk_js_call.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  525</span>                                                                {</div>
<div class="line"><span class="lineno">  526</span>    <a class="code hl_struct" href="structduk__tval__struct.html">duk_tval</a> *tv;</div>
<div class="line"><span class="lineno">  527</span> </div>
<div class="line"><span class="lineno">  528</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(thr != <a class="code hl_define" href="gmacros_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><span class="lineno">  529</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(func != <a class="code hl_define" href="gmacros_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><span class="lineno">  530</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(act != <a class="code hl_define" href="gmacros_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><span class="lineno">  531</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(!<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#abc40e3d6cc4e2c0c659abdb0bd5ab78b">DUK_HOBJECT_HAS_NEWENV</a>(func));</div>
<div class="line"><span class="lineno">  532</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(!<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a405107c06eacfb0b9b6e82aaaa609b9d">DUK_HOBJECT_HAS_CREATEARGS</a>(func));</div>
<div class="line"><span class="lineno">  533</span> </div>
<div class="line"><span class="lineno">  534</span>    tv = <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a673b9ceeb9130ed7ea44e7aae8a56ea7">duk_hobject_find_existing_entry_tval_ptr</a>(thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#a1c6d2e1f36b0b7011f0e52343ca5ed05">heap</a>, func, <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a5dcdbc7d8489c3a4537f29c42e8b5d95">DUK_HTHREAD_STRING_INT_LEXENV</a>(thr));</div>
<div class="line"><span class="lineno">  535</span>    <span class="keywordflow">if</span> (tv) {</div>
<div class="line"><span class="lineno">  536</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a3e6da5a54e90086602a9d6f44997d640">DUK_TVAL_IS_OBJECT</a>(tv));</div>
<div class="line"><span class="lineno">  537</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a631a8eb83880f16510fc4fbd34dd1347">DUK_HOBJECT_IS_ENV</a>(<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a2a196d761c3a7789fcc2ac3cf61ad601">DUK_TVAL_GET_OBJECT</a>(tv)));</div>
<div class="line"><span class="lineno">  538</span>        act-&gt;<a class="code hl_variable" href="structduk__activation.html#a2e3041f6643f991adf53a6a8d55ea3c3">lex_env</a> = <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a2a196d761c3a7789fcc2ac3cf61ad601">DUK_TVAL_GET_OBJECT</a>(tv);</div>
<div class="line"><span class="lineno">  539</span> </div>
<div class="line"><span class="lineno">  540</span>        tv = <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a673b9ceeb9130ed7ea44e7aae8a56ea7">duk_hobject_find_existing_entry_tval_ptr</a>(thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#a1c6d2e1f36b0b7011f0e52343ca5ed05">heap</a>, func, <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a59d32c12a8a9b5e1656b091c11aa807a">DUK_HTHREAD_STRING_INT_VARENV</a>(thr));</div>
<div class="line"><span class="lineno">  541</span>        <span class="keywordflow">if</span> (tv) {</div>
<div class="line"><span class="lineno">  542</span>            <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a3e6da5a54e90086602a9d6f44997d640">DUK_TVAL_IS_OBJECT</a>(tv));</div>
<div class="line"><span class="lineno">  543</span>            <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a631a8eb83880f16510fc4fbd34dd1347">DUK_HOBJECT_IS_ENV</a>(<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a2a196d761c3a7789fcc2ac3cf61ad601">DUK_TVAL_GET_OBJECT</a>(tv)));</div>
<div class="line"><span class="lineno">  544</span>            act-&gt;<a class="code hl_variable" href="structduk__activation.html#a92ea93909d22ddbd33cfc46f32726387">var_env</a> = <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a2a196d761c3a7789fcc2ac3cf61ad601">DUK_TVAL_GET_OBJECT</a>(tv);</div>
<div class="line"><span class="lineno">  545</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  546</span>            act-&gt;<a class="code hl_variable" href="structduk__activation.html#a92ea93909d22ddbd33cfc46f32726387">var_env</a> = act-&gt;<a class="code hl_variable" href="structduk__activation.html#a2e3041f6643f991adf53a6a8d55ea3c3">lex_env</a>;</div>
<div class="line"><span class="lineno">  547</span>        }</div>
<div class="line"><span class="lineno">  548</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  549</span>        act-&gt;<a class="code hl_variable" href="structduk__activation.html#a2e3041f6643f991adf53a6a8d55ea3c3">lex_env</a> = thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#a2411e86e6389e09885c986c311430c76">builtins</a>[<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a62e6f7d6be8c937e585625144533d4fd">DUK_BIDX_GLOBAL_ENV</a>];</div>
<div class="line"><span class="lineno">  550</span>        act-&gt;<a class="code hl_variable" href="structduk__activation.html#a92ea93909d22ddbd33cfc46f32726387">var_env</a> = act-&gt;<a class="code hl_variable" href="structduk__activation.html#a2e3041f6643f991adf53a6a8d55ea3c3">lex_env</a>;</div>
<div class="line"><span class="lineno">  551</span>    }</div>
<div class="line"><span class="lineno">  552</span> </div>
<div class="line"><span class="lineno">  553</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#aee2b028c473ecd0ac84f414e3ccaacd1">DUK_HOBJECT_INCREF_ALLOWNULL</a>(thr, act-&gt;<a class="code hl_variable" href="structduk__activation.html#a2e3041f6643f991adf53a6a8d55ea3c3">lex_env</a>);</div>
<div class="line"><span class="lineno">  554</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#aee2b028c473ecd0ac84f414e3ccaacd1">DUK_HOBJECT_INCREF_ALLOWNULL</a>(thr, act-&gt;<a class="code hl_variable" href="structduk__activation.html#a92ea93909d22ddbd33cfc46f32726387">var_env</a>);</div>
<div class="line"><span class="lineno">  555</span>}</div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_a59d32c12a8a9b5e1656b091c11aa807a"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#a59d32c12a8a9b5e1656b091c11aa807a">DUK_HTHREAD_STRING_INT_VARENV</a></div><div class="ttdeci">#define DUK_HTHREAD_STRING_INT_VARENV(thr)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l01193">duktape-1.5.2/src-noline/duktape.c:1193</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_a5dcdbc7d8489c3a4537f29c42e8b5d95"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#a5dcdbc7d8489c3a4537f29c42e8b5d95">DUK_HTHREAD_STRING_INT_LEXENV</a></div><div class="ttdeci">#define DUK_HTHREAD_STRING_INT_LEXENV(thr)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l01190">duktape-1.5.2/src-noline/duktape.c:1190</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_a62e6f7d6be8c937e585625144533d4fd"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#a62e6f7d6be8c937e585625144533d4fd">DUK_BIDX_GLOBAL_ENV</a></div><div class="ttdeci">#define DUK_BIDX_GLOBAL_ENV</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l01630">duktape-1.5.2/src-noline/duktape.c:1630</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_a631a8eb83880f16510fc4fbd34dd1347"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#a631a8eb83880f16510fc4fbd34dd1347">DUK_HOBJECT_IS_ENV</a></div><div class="ttdeci">#define DUK_HOBJECT_IS_ENV(h)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l04772">duktape-1.5.2/src-noline/duktape.c:4772</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_a673b9ceeb9130ed7ea44e7aae8a56ea7"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#a673b9ceeb9130ed7ea44e7aae8a56ea7">duk_hobject_find_existing_entry_tval_ptr</a></div><div class="ttdeci">DUK_INTERNAL_DECL duk_tval * duk_hobject_find_existing_entry_tval_ptr(duk_heap *heap, duk_hobject *obj, duk_hstring *key)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l48263">duktape-1.5.2/src-noline/duktape.c:48263</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06274">duk_hthread::builtins</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07755">DUK_ASSERT</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l01630">DUK_BIDX_GLOBAL_ENV</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l48263">duk_hobject_find_existing_entry_tval_ptr()</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l04815">DUK_HOBJECT_HAS_CREATEARGS</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l04813">DUK_HOBJECT_HAS_NEWENV</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l03838">DUK_HOBJECT_INCREF_ALLOWNULL</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l04772">DUK_HOBJECT_IS_ENV</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l01190">DUK_HTHREAD_STRING_INT_LEXENV</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l01193">DUK_HTHREAD_STRING_INT_VARENV</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l00787">DUK_TVAL_GET_OBJECT</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l00811">DUK_TVAL_IS_OBJECT</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06202">duk_hthread::heap</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06133">duk_activation::lex_env</a>, <a class="el" href="gmacros_8h_source.html#l00924">NULL</a>, and <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06132">duk_activation::var_env</a>.</p>

<p class="reference">Referenced by <a class="el" href="duktape-1_85_82_2src-separate_2duk__js__call_8c_source.html#l01158">duk__handle_call_inner()</a>, and <a class="el" href="duktape-1_85_82_2src-separate_2duk__js__call_8c_source.html#l02290">duk_handle_ecma_call_setup()</a>.</p>

</div>
</div>
<a id="a64be23b7667a71988e004d51b0bc692f" name="a64be23b7667a71988e004d51b0bc692f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a64be23b7667a71988e004d51b0bc692f">&#9670;&#160;</a></span>duk__handle_safe_call_error()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a245b431abb36cac1ac8d0eae054ed5c1">DUK_LOCAL</a> void duk__handle_safe_call_error </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structduk__hthread.html">duk_hthread</a> *</td>          <td class="paramname"><span class="paramname"><em>thr</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a3e3bb369382aab50155c1d18bdf73923">duk_idx_t</a></td>          <td class="paramname"><span class="paramname"><em>idx_retbase</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a3e3bb369382aab50155c1d18bdf73923">duk_idx_t</a></td>          <td class="paramname"><span class="paramname"><em>num_stack_rets</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#ab0a71934d59f38f195fea2f353032392">duk_size_t</a></td>          <td class="paramname"><span class="paramname"><em>entry_valstack_bottom_index</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#ab0a71934d59f38f195fea2f353032392">duk_size_t</a></td>          <td class="paramname"><span class="paramname"><em>entry_callstack_top</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#ab0a71934d59f38f195fea2f353032392">duk_size_t</a></td>          <td class="paramname"><span class="paramname"><em>entry_catchstack_top</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structduk__jmpbuf.html">duk_jmpbuf</a> *</td>          <td class="paramname"><span class="paramname"><em>old_jmpbuf_ptr</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="duktape-1_85_82_2src-separate_2duk__js__call_8c_source.html#l02147">2147</a> of file <a class="el" href="duktape-1_85_82_2src-separate_2duk__js__call_8c_source.html">duktape-1.5.2/src-separate/duk_js_call.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2153</span>                                                                       {</div>
<div class="line"><span class="lineno"> 2154</span>    <a class="code hl_struct" href="structduk__hthread.html">duk_context</a> *ctx;</div>
<div class="line"><span class="lineno"> 2155</span> </div>
<div class="line"><span class="lineno"> 2156</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(thr != <a class="code hl_define" href="gmacros_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><span class="lineno"> 2157</span>    ctx = (<a class="code hl_struct" href="structduk__hthread.html">duk_context</a> *) thr;</div>
<div class="line"><span class="lineno"> 2158</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a06fc3069d0dbc1b0d9d28c15bb07e1ce">DUK_ASSERT_CTX_VALID</a>(ctx);</div>
<div class="line"><span class="lineno"> 2159</span> </div>
<div class="line"><span class="lineno"> 2160</span>    <span class="comment">/*</span></div>
<div class="line"><span class="lineno"> 2161</span><span class="comment">     *  Error during call.  The error value is at heap-&gt;lj.value1.</span></div>
<div class="line"><span class="lineno"> 2162</span><span class="comment">     *</span></div>
<div class="line"><span class="lineno"> 2163</span><span class="comment">     *  The very first thing we do is restore the previous setjmp catcher.</span></div>
<div class="line"><span class="lineno"> 2164</span><span class="comment">     *  This means that any error in error handling will propagate outwards</span></div>
<div class="line"><span class="lineno"> 2165</span><span class="comment">     *  instead of causing a setjmp() re-entry above.</span></div>
<div class="line"><span class="lineno"> 2166</span><span class="comment">     */</span></div>
<div class="line"><span class="lineno"> 2167</span> </div>
<div class="line"><span class="lineno"> 2168</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a2db20d2d3b36d8491ed171cf503488bb">DUK_DDD</a>(<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#aa6e5d41ceaba6832e5ede737f0a35fb9">DUK_DDDPRINT</a>(<span class="stringliteral">&quot;error caught during protected duk_handle_safe_call()&quot;</span>));</div>
<div class="line"><span class="lineno"> 2169</span> </div>
<div class="line"><span class="lineno"> 2170</span>    <span class="comment">/* Other longjmp types are handled by executor before propagating</span></div>
<div class="line"><span class="lineno"> 2171</span><span class="comment">     * the error here.</span></div>
<div class="line"><span class="lineno"> 2172</span><span class="comment">     */</span></div>
<div class="line"><span class="lineno"> 2173</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#a1c6d2e1f36b0b7011f0e52343ca5ed05">heap</a>-&gt;<a class="code hl_variable" href="structduk__heap.html#ab564d681186a71065b5d36d4c61c2362">lj</a>.<a class="code hl_variable" href="structduk__ljstate.html#a3d4e166347f12121174d04b9ed93dbf5">type</a> == <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a01491eeb67c7b39eb79b036bc1e17c16">DUK_LJ_TYPE_THROW</a>);</div>
<div class="line"><span class="lineno"> 2174</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#aea2cca88da9187f43fb2b925ef7f5ee4">callstack_top</a> &gt;= entry_callstack_top);</div>
<div class="line"><span class="lineno"> 2175</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#a52794290185255eb48736c942b07ae04">catchstack_top</a> &gt;= entry_catchstack_top);</div>
<div class="line"><span class="lineno"> 2176</span> </div>
<div class="line"><span class="lineno"> 2177</span>    <span class="comment">/* Note: either pointer may be NULL (at entry), so don&#39;t assert. */</span></div>
<div class="line"><span class="lineno"> 2178</span>    thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#a1c6d2e1f36b0b7011f0e52343ca5ed05">heap</a>-&gt;<a class="code hl_variable" href="structduk__heap.html#ab564d681186a71065b5d36d4c61c2362">lj</a>.<a class="code hl_variable" href="structduk__ljstate.html#a035175485b99338b27871a1b4925b7d8">jmpbuf_ptr</a> = old_jmpbuf_ptr;</div>
<div class="line"><span class="lineno"> 2179</span> </div>
<div class="line"><span class="lineno"> 2180</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#a52794290185255eb48736c942b07ae04">catchstack_top</a> &gt;= entry_catchstack_top);</div>
<div class="line"><span class="lineno"> 2181</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#aea2cca88da9187f43fb2b925ef7f5ee4">callstack_top</a> &gt;= entry_callstack_top);</div>
<div class="line"><span class="lineno"> 2182</span>    <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a293c800100000f744f86bd30ddedaae3">duk_hthread_catchstack_unwind</a>(thr, entry_catchstack_top);</div>
<div class="line"><span class="lineno"> 2183</span>    <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a2280c7ff345d34b3b66982df21218c47">duk_hthread_catchstack_shrink_check</a>(thr);</div>
<div class="line"><span class="lineno"> 2184</span>    <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a6b0424c9d50c491ab32e7605cd9fdae2">duk_hthread_callstack_unwind</a>(thr, entry_callstack_top);</div>
<div class="line"><span class="lineno"> 2185</span>    <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#ab1328365d06bb689313bd28bdc006fbe">duk_hthread_callstack_shrink_check</a>(thr);</div>
<div class="line"><span class="lineno"> 2186</span>    thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#ad39b6c03b81eb0f4d3eefda5083988d3">valstack_bottom</a> = thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#a08f58ff5b9fa5927891c2e08712e3971">valstack</a> + entry_valstack_bottom_index;</div>
<div class="line"><span class="lineno"> 2187</span> </div>
<div class="line"><span class="lineno"> 2188</span>    <span class="comment">/* [ ... | (crud) ] */</span></div>
<div class="line"><span class="lineno"> 2189</span> </div>
<div class="line"><span class="lineno"> 2190</span>    <span class="comment">/* XXX: space in valstack?  see discussion in duk_handle_call_xxx(). */</span></div>
<div class="line"><span class="lineno"> 2191</span>    <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a91eb3e96b01fcf7f57063da227eba654">duk_push_tval</a>(ctx, &amp;thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#a1c6d2e1f36b0b7011f0e52343ca5ed05">heap</a>-&gt;<a class="code hl_variable" href="structduk__heap.html#ab564d681186a71065b5d36d4c61c2362">lj</a>.<a class="code hl_variable" href="structduk__ljstate.html#ae1deaf697aee46f178dafbaf5638d438">value1</a>);</div>
<div class="line"><span class="lineno"> 2192</span> </div>
<div class="line"><span class="lineno"> 2193</span>    <span class="comment">/* [ ... | (crud) errobj ] */</span></div>
<div class="line"><span class="lineno"> 2194</span> </div>
<div class="line"><span class="lineno"> 2195</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(<a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a8c8653fcd951809042c23c42e534c421">duk_get_top</a>(ctx) &gt;= 1);  <span class="comment">/* at least errobj must be on stack */</span></div>
<div class="line"><span class="lineno"> 2196</span> </div>
<div class="line"><span class="lineno"> 2197</span>    <span class="comment">/* check that the valstack has space for the final amount and any</span></div>
<div class="line"><span class="lineno"> 2198</span><span class="comment">     * intermediate space needed; this is unoptimal but should be safe</span></div>
<div class="line"><span class="lineno"> 2199</span><span class="comment">     */</span></div>
<div class="line"><span class="lineno"> 2200</span>    <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a6fb7c9c1185f4a5469db202b63a905c0">duk_require_stack_top</a>(ctx, idx_retbase + num_stack_rets);  <span class="comment">/* final configuration */</span></div>
<div class="line"><span class="lineno"> 2201</span>    <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a47979f7fbd8af168f735efc020c09d62">duk_require_stack</a>(ctx, num_stack_rets);</div>
<div class="line"><span class="lineno"> 2202</span> </div>
<div class="line"><span class="lineno"> 2203</span>    <a class="code hl_function" href="#a0a5f9e173b495524116abe7aa167026a">duk__safe_call_adjust_valstack</a>(thr, idx_retbase, num_stack_rets, 1);  <span class="comment">/* 1 = num actual &#39;return values&#39; */</span></div>
<div class="line"><span class="lineno"> 2204</span> </div>
<div class="line"><span class="lineno"> 2205</span>    <span class="comment">/* [ ... | ] or [ ... | errobj (M * undefined)] where M = num_stack_rets - 1 */</span></div>
<div class="line"><span class="lineno"> 2206</span> </div>
<div class="line"><span class="lineno"> 2207</span>    <span class="comment">/* These are just convenience &quot;wiping&quot; of state.  Side effects should</span></div>
<div class="line"><span class="lineno"> 2208</span><span class="comment">     * not be an issue here: thr-&gt;heap and thr-&gt;heap-&gt;lj have a stable</span></div>
<div class="line"><span class="lineno"> 2209</span><span class="comment">     * pointer.  Finalizer runs etc capture even out-of-memory errors so</span></div>
<div class="line"><span class="lineno"> 2210</span><span class="comment">     * nothing should throw here.</span></div>
<div class="line"><span class="lineno"> 2211</span><span class="comment">     */</span></div>
<div class="line"><span class="lineno"> 2212</span>    thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#a1c6d2e1f36b0b7011f0e52343ca5ed05">heap</a>-&gt;<a class="code hl_variable" href="structduk__heap.html#ab564d681186a71065b5d36d4c61c2362">lj</a>.<a class="code hl_variable" href="structduk__ljstate.html#a3d4e166347f12121174d04b9ed93dbf5">type</a> = <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a6af5993d9334f7a01bbc1219671ca5ea">DUK_LJ_TYPE_UNKNOWN</a>;</div>
<div class="line"><span class="lineno"> 2213</span>    thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#a1c6d2e1f36b0b7011f0e52343ca5ed05">heap</a>-&gt;<a class="code hl_variable" href="structduk__heap.html#ab564d681186a71065b5d36d4c61c2362">lj</a>.<a class="code hl_variable" href="structduk__ljstate.html#a6ec0311d74ac88b57bc24ab5b149e3f9">iserror</a> = 0;</div>
<div class="line"><span class="lineno"> 2214</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#acb7d8467c90d4c8f1c772eaff56f70e9">DUK_TVAL_SET_UNDEFINED_UPDREF</a>(thr, &amp;thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#a1c6d2e1f36b0b7011f0e52343ca5ed05">heap</a>-&gt;<a class="code hl_variable" href="structduk__heap.html#ab564d681186a71065b5d36d4c61c2362">lj</a>.<a class="code hl_variable" href="structduk__ljstate.html#ae1deaf697aee46f178dafbaf5638d438">value1</a>);  <span class="comment">/* side effects */</span></div>
<div class="line"><span class="lineno"> 2215</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#acb7d8467c90d4c8f1c772eaff56f70e9">DUK_TVAL_SET_UNDEFINED_UPDREF</a>(thr, &amp;thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#a1c6d2e1f36b0b7011f0e52343ca5ed05">heap</a>-&gt;<a class="code hl_variable" href="structduk__heap.html#ab564d681186a71065b5d36d4c61c2362">lj</a>.<a class="code hl_variable" href="structduk__ljstate.html#a8d28969876a04123a2206617267c1384">value2</a>);  <span class="comment">/* side effects */</span></div>
<div class="line"><span class="lineno"> 2216</span>}</div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_a47979f7fbd8af168f735efc020c09d62"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#a47979f7fbd8af168f735efc020c09d62">duk_require_stack</a></div><div class="ttdeci">DUK_EXTERNAL void duk_require_stack(duk_context *ctx, duk_idx_t extra)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l15612">duktape-1.5.2/src-noline/duktape.c:15612</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_a6fb7c9c1185f4a5469db202b63a905c0"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#a6fb7c9c1185f4a5469db202b63a905c0">duk_require_stack_top</a></div><div class="ttdeci">DUK_EXTERNAL void duk_require_stack_top(duk_context *ctx, duk_idx_t top)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l15654">duktape-1.5.2/src-noline/duktape.c:15654</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_a91eb3e96b01fcf7f57063da227eba654"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#a91eb3e96b01fcf7f57063da227eba654">duk_push_tval</a></div><div class="ttdeci">DUK_INTERNAL_DECL void duk_push_tval(duk_context *ctx, duk_tval *tv)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l17835">duktape-1.5.2/src-noline/duktape.c:17835</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-separate_2duk__js__call_8c_html_a0a5f9e173b495524116abe7aa167026a"><div class="ttname"><a href="#a0a5f9e173b495524116abe7aa167026a">duk__safe_call_adjust_valstack</a></div><div class="ttdeci">DUK_LOCAL void duk__safe_call_adjust_valstack(duk_hthread *thr, duk_idx_t idx_retbase, duk_idx_t num_stack_rets, duk_idx_t num_actual_rets)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-separate_2duk__js__call_8c_source.html#l00851">duktape-1.5.2/src-separate/duk_js_call.c:851</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06237">duk_hthread::callstack_top</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06243">duk_hthread::catchstack_top</a>, <a class="el" href="duktape-1_85_82_2src-separate_2duk__js__call_8c_source.html#l00851">duk__safe_call_adjust_valstack()</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07755">DUK_ASSERT</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06106">DUK_ASSERT_CTX_VALID</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07497">DUK_DDD</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07509">DUK_DDDPRINT</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l15204">duk_get_top()</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l54217">duk_hthread_callstack_shrink_check()</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l54255">duk_hthread_callstack_unwind()</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l54522">duk_hthread_catchstack_shrink_check()</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l54560">duk_hthread_catchstack_unwind()</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06702">DUK_LJ_TYPE_THROW</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06701">DUK_LJ_TYPE_UNKNOWN</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l17835">duk_push_tval()</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l15612">duk_require_stack()</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l15654">duk_require_stack_top()</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l04004">DUK_TVAL_SET_UNDEFINED_UPDREF</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06202">duk_hthread::heap</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06950">duk_ljstate::iserror</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06948">duk_ljstate::jmpbuf_ptr</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07035">duk_heap::lj</a>, <a class="el" href="gmacros_8h_source.html#l00924">NULL</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06949">duk_ljstate::type</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06226">duk_hthread::valstack</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06228">duk_hthread::valstack_bottom</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06951">duk_ljstate::value1</a>, and <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06952">duk_ljstate::value2</a>.</p>

<p class="reference">Referenced by <a class="el" href="duktape-1_85_82_2src-separate_2duk__js__call_8c_source.html#l01872">duk_handle_safe_call()</a>.</p>

</div>
</div>
<a id="ad89d6a1dfcd3eeaa30276a032d922f93" name="ad89d6a1dfcd3eeaa30276a032d922f93"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad89d6a1dfcd3eeaa30276a032d922f93">&#9670;&#160;</a></span>duk__handle_safe_call_inner()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a245b431abb36cac1ac8d0eae054ed5c1">DUK_LOCAL</a> void duk__handle_safe_call_inner </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structduk__hthread.html">duk_hthread</a> *</td>          <td class="paramname"><span class="paramname"><em>thr</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="duktape-1_85_82_2src-noline_2duktape_8h.html#af73ef474ce4eaa5f69994410c81c33db">duk_safe_call_function</a></td>          <td class="paramname"><span class="paramname"><em>func</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a3e3bb369382aab50155c1d18bdf73923">duk_idx_t</a></td>          <td class="paramname"><span class="paramname"><em>idx_retbase</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a3e3bb369382aab50155c1d18bdf73923">duk_idx_t</a></td>          <td class="paramname"><span class="paramname"><em>num_stack_rets</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#ab0a71934d59f38f195fea2f353032392">duk_size_t</a></td>          <td class="paramname"><span class="paramname"><em>entry_valstack_bottom_index</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#ab0a71934d59f38f195fea2f353032392">duk_size_t</a></td>          <td class="paramname"><span class="paramname"><em>entry_callstack_top</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#ab0a71934d59f38f195fea2f353032392">duk_size_t</a></td>          <td class="paramname"><span class="paramname"><em>entry_catchstack_top</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="duktape-1_85_82_2src-separate_2duk__js__call_8c_source.html#l02038">2038</a> of file <a class="el" href="duktape-1_85_82_2src-separate_2duk__js__call_8c_source.html">duktape-1.5.2/src-separate/duk_js_call.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2044</span>                                                                            {</div>
<div class="line"><span class="lineno"> 2045</span>    <a class="code hl_struct" href="structduk__hthread.html">duk_context</a> *ctx;</div>
<div class="line"><span class="lineno"> 2046</span>    <a class="code hl_typedef" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a3cd45ada834d9a7fcfcaf2d654435c6c">duk_ret_t</a> rc;</div>
<div class="line"><span class="lineno"> 2047</span> </div>
<div class="line"><span class="lineno"> 2048</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(thr != <a class="code hl_define" href="gmacros_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><span class="lineno"> 2049</span>    ctx = (<a class="code hl_struct" href="structduk__hthread.html">duk_context</a> *) thr;</div>
<div class="line"><span class="lineno"> 2050</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a06fc3069d0dbc1b0d9d28c15bb07e1ce">DUK_ASSERT_CTX_VALID</a>(ctx);</div>
<div class="line"><span class="lineno"> 2051</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a9170138f330dbcaabfae9d2c59cc9684">DUK_UNREF</a>(entry_valstack_bottom_index);</div>
<div class="line"><span class="lineno"> 2052</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a9170138f330dbcaabfae9d2c59cc9684">DUK_UNREF</a>(entry_callstack_top);</div>
<div class="line"><span class="lineno"> 2053</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a9170138f330dbcaabfae9d2c59cc9684">DUK_UNREF</a>(entry_catchstack_top);</div>
<div class="line"><span class="lineno"> 2054</span> </div>
<div class="line"><span class="lineno"> 2055</span>    <span class="comment">/*</span></div>
<div class="line"><span class="lineno"> 2056</span><span class="comment">     *  Thread state check and book-keeping.</span></div>
<div class="line"><span class="lineno"> 2057</span><span class="comment">     */</span></div>
<div class="line"><span class="lineno"> 2058</span> </div>
<div class="line"><span class="lineno"> 2059</span>    <span class="keywordflow">if</span> (thr == thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#a1c6d2e1f36b0b7011f0e52343ca5ed05">heap</a>-&gt;<a class="code hl_variable" href="structduk__heap.html#a1f913439bf8af92c753891bea8abda78">curr_thread</a>) {</div>
<div class="line"><span class="lineno"> 2060</span>        <span class="comment">/* same thread */</span></div>
<div class="line"><span class="lineno"> 2061</span>        <span class="keywordflow">if</span> (thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#a4dc5dc48406aa6240185468557d154dc">state</a> != <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a82ed1e61fa4a768cbc65401274bfd89a">DUK_HTHREAD_STATE_RUNNING</a>) {</div>
<div class="line"><span class="lineno"> 2062</span>            <span class="comment">/* should actually never happen, but check anyway */</span></div>
<div class="line"><span class="lineno"> 2063</span>            <span class="keywordflow">goto</span> thread_state_error;</div>
<div class="line"><span class="lineno"> 2064</span>        }</div>
<div class="line"><span class="lineno"> 2065</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2066</span>        <span class="comment">/* different thread */</span></div>
<div class="line"><span class="lineno"> 2067</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#a1c6d2e1f36b0b7011f0e52343ca5ed05">heap</a>-&gt;<a class="code hl_variable" href="structduk__heap.html#a1f913439bf8af92c753891bea8abda78">curr_thread</a> == <a class="code hl_define" href="gmacros_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> ||</div>
<div class="line"><span class="lineno"> 2068</span>                   thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#a1c6d2e1f36b0b7011f0e52343ca5ed05">heap</a>-&gt;<a class="code hl_variable" href="structduk__heap.html#a1f913439bf8af92c753891bea8abda78">curr_thread</a>-&gt;<a class="code hl_variable" href="structduk__hthread.html#a4dc5dc48406aa6240185468557d154dc">state</a> == <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a82ed1e61fa4a768cbc65401274bfd89a">DUK_HTHREAD_STATE_RUNNING</a>);</div>
<div class="line"><span class="lineno"> 2069</span>        <span class="keywordflow">if</span> (thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#a4dc5dc48406aa6240185468557d154dc">state</a> != <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a60d14816853d0b43d8f6e2d033a9df60">DUK_HTHREAD_STATE_INACTIVE</a>) {</div>
<div class="line"><span class="lineno"> 2070</span>            <span class="keywordflow">goto</span> thread_state_error;</div>
<div class="line"><span class="lineno"> 2071</span>        }</div>
<div class="line"><span class="lineno"> 2072</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#ada39afa145c10879d68bc705850edcd7">DUK_HEAP_SWITCH_THREAD</a>(thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#a1c6d2e1f36b0b7011f0e52343ca5ed05">heap</a>, thr);</div>
<div class="line"><span class="lineno"> 2073</span>        thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#a4dc5dc48406aa6240185468557d154dc">state</a> = <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a82ed1e61fa4a768cbc65401274bfd89a">DUK_HTHREAD_STATE_RUNNING</a>;</div>
<div class="line"><span class="lineno"> 2074</span> </div>
<div class="line"><span class="lineno"> 2075</span>        <span class="comment">/* Note: multiple threads may be simultaneously in the RUNNING</span></div>
<div class="line"><span class="lineno"> 2076</span><span class="comment">         * state, but not in the same &quot;resume chain&quot;.</span></div>
<div class="line"><span class="lineno"> 2077</span><span class="comment">         */</span></div>
<div class="line"><span class="lineno"> 2078</span>    }</div>
<div class="line"><span class="lineno"> 2079</span> </div>
<div class="line"><span class="lineno"> 2080</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#a1c6d2e1f36b0b7011f0e52343ca5ed05">heap</a>-&gt;<a class="code hl_variable" href="structduk__heap.html#a1f913439bf8af92c753891bea8abda78">curr_thread</a> == thr);</div>
<div class="line"><span class="lineno"> 2081</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#a4dc5dc48406aa6240185468557d154dc">state</a> == <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a82ed1e61fa4a768cbc65401274bfd89a">DUK_HTHREAD_STATE_RUNNING</a>);</div>
<div class="line"><span class="lineno"> 2082</span> </div>
<div class="line"><span class="lineno"> 2083</span>    <span class="comment">/*</span></div>
<div class="line"><span class="lineno"> 2084</span><span class="comment">     *  Recursion limit check.</span></div>
<div class="line"><span class="lineno"> 2085</span><span class="comment">     *</span></div>
<div class="line"><span class="lineno"> 2086</span><span class="comment">     *  Note: there is no need for an &quot;ignore recursion limit&quot; flag</span></div>
<div class="line"><span class="lineno"> 2087</span><span class="comment">     *  for duk_handle_safe_call now.</span></div>
<div class="line"><span class="lineno"> 2088</span><span class="comment">     */</span></div>
<div class="line"><span class="lineno"> 2089</span> </div>
<div class="line"><span class="lineno"> 2090</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#a1c6d2e1f36b0b7011f0e52343ca5ed05">heap</a>-&gt;<a class="code hl_variable" href="structduk__heap.html#ab229eef9c6b0d7fcd267527a4b107fe5">call_recursion_depth</a> &gt;= 0);</div>
<div class="line"><span class="lineno"> 2091</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#a1c6d2e1f36b0b7011f0e52343ca5ed05">heap</a>-&gt;<a class="code hl_variable" href="structduk__heap.html#ab229eef9c6b0d7fcd267527a4b107fe5">call_recursion_depth</a> &lt;= thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#a1c6d2e1f36b0b7011f0e52343ca5ed05">heap</a>-&gt;<a class="code hl_variable" href="structduk__heap.html#a1af957e1af60fa05e2d84f489b722ed3">call_recursion_limit</a>);</div>
<div class="line"><span class="lineno"> 2092</span>    <span class="keywordflow">if</span> (thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#a1c6d2e1f36b0b7011f0e52343ca5ed05">heap</a>-&gt;<a class="code hl_variable" href="structduk__heap.html#ab229eef9c6b0d7fcd267527a4b107fe5">call_recursion_depth</a> &gt;= thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#a1c6d2e1f36b0b7011f0e52343ca5ed05">heap</a>-&gt;<a class="code hl_variable" href="structduk__heap.html#a1af957e1af60fa05e2d84f489b722ed3">call_recursion_limit</a>) {</div>
<div class="line"><span class="lineno"> 2093</span>        <span class="comment">/* XXX: error message is a bit misleading: we reached a recursion</span></div>
<div class="line"><span class="lineno"> 2094</span><span class="comment">         * limit which is also essentially the same as a C callstack limit</span></div>
<div class="line"><span class="lineno"> 2095</span><span class="comment">         * (except perhaps with some relaxed threading assumptions).</span></div>
<div class="line"><span class="lineno"> 2096</span><span class="comment">         */</span></div>
<div class="line"><span class="lineno"> 2097</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a058cd56ed742ea766d26976d56c159d4">DUK_ERROR_RANGE</a>(thr, <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#aa065bcb3f7f1d242bd6baa3a285dc0d8">DUK_STR_C_CALLSTACK_LIMIT</a>);</div>
<div class="line"><span class="lineno"> 2098</span>    }</div>
<div class="line"><span class="lineno"> 2099</span>    thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#a1c6d2e1f36b0b7011f0e52343ca5ed05">heap</a>-&gt;<a class="code hl_variable" href="structduk__heap.html#ab229eef9c6b0d7fcd267527a4b107fe5">call_recursion_depth</a>++;</div>
<div class="line"><span class="lineno"> 2100</span> </div>
<div class="line"><span class="lineno"> 2101</span>    <span class="comment">/*</span></div>
<div class="line"><span class="lineno"> 2102</span><span class="comment">     *  Valstack spare check</span></div>
<div class="line"><span class="lineno"> 2103</span><span class="comment">     */</span></div>
<div class="line"><span class="lineno"> 2104</span> </div>
<div class="line"><span class="lineno"> 2105</span>    <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a47979f7fbd8af168f735efc020c09d62">duk_require_stack</a>(ctx, 0);  <span class="comment">/* internal spare */</span></div>
<div class="line"><span class="lineno"> 2106</span> </div>
<div class="line"><span class="lineno"> 2107</span>    <span class="comment">/*</span></div>
<div class="line"><span class="lineno"> 2108</span><span class="comment">     *  Make the C call</span></div>
<div class="line"><span class="lineno"> 2109</span><span class="comment">     */</span></div>
<div class="line"><span class="lineno"> 2110</span> </div>
<div class="line"><span class="lineno"> 2111</span>    rc = func(ctx);</div>
<div class="line"><span class="lineno"> 2112</span> </div>
<div class="line"><span class="lineno"> 2113</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a2db20d2d3b36d8491ed171cf503488bb">DUK_DDD</a>(<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#aa6e5d41ceaba6832e5ede737f0a35fb9">DUK_DDDPRINT</a>(<span class="stringliteral">&quot;safe_call, func rc=%ld&quot;</span>, (<span class="keywordtype">long</span>) rc));</div>
<div class="line"><span class="lineno"> 2114</span> </div>
<div class="line"><span class="lineno"> 2115</span>    <span class="comment">/*</span></div>
<div class="line"><span class="lineno"> 2116</span><span class="comment">     *  Valstack manipulation for results.</span></div>
<div class="line"><span class="lineno"> 2117</span><span class="comment">     */</span></div>
<div class="line"><span class="lineno"> 2118</span> </div>
<div class="line"><span class="lineno"> 2119</span>    <span class="comment">/* we&#39;re running inside the caller&#39;s activation, so no change in call/catch stack or valstack bottom */</span></div>
<div class="line"><span class="lineno"> 2120</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#aea2cca88da9187f43fb2b925ef7f5ee4">callstack_top</a> == entry_callstack_top);</div>
<div class="line"><span class="lineno"> 2121</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#a52794290185255eb48736c942b07ae04">catchstack_top</a> == entry_catchstack_top);</div>
<div class="line"><span class="lineno"> 2122</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#ad39b6c03b81eb0f4d3eefda5083988d3">valstack_bottom</a> &gt;= thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#a08f58ff5b9fa5927891c2e08712e3971">valstack</a>);</div>
<div class="line"><span class="lineno"> 2123</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>((<a class="code hl_typedef" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#ab0a71934d59f38f195fea2f353032392">duk_size_t</a>) (thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#ad39b6c03b81eb0f4d3eefda5083988d3">valstack_bottom</a> - thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#a08f58ff5b9fa5927891c2e08712e3971">valstack</a>) == entry_valstack_bottom_index);</div>
<div class="line"><span class="lineno"> 2124</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#aec793ffa71623d879a5849bee26687f2">valstack_top</a> &gt;= thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#ad39b6c03b81eb0f4d3eefda5083988d3">valstack_bottom</a>);</div>
<div class="line"><span class="lineno"> 2125</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#a09749b7b70f6fd8ad3661adfac3316b5">valstack_end</a> &gt;= thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#aec793ffa71623d879a5849bee26687f2">valstack_top</a>);</div>
<div class="line"><span class="lineno"> 2126</span> </div>
<div class="line"><span class="lineno"> 2127</span>    <span class="keywordflow">if</span> (rc &lt; 0) {</div>
<div class="line"><span class="lineno"> 2128</span>        <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#abe3b9bb1677d53303510b06244c27f26">duk_error_throw_from_negative_rc</a>(thr, rc);</div>
<div class="line"><span class="lineno"> 2129</span>    }</div>
<div class="line"><span class="lineno"> 2130</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(rc &gt;= 0);</div>
<div class="line"><span class="lineno"> 2131</span> </div>
<div class="line"><span class="lineno"> 2132</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a8c8653fcd951809042c23c42e534c421">duk_get_top</a>(ctx) &lt; rc) {</div>
<div class="line"><span class="lineno"> 2133</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a5d7ecc05e08a0af8396793c7d6d9d916">DUK_ERROR_API</a>(thr, <span class="stringliteral">&quot;not enough stack values for safe_call rc&quot;</span>);</div>
<div class="line"><span class="lineno"> 2134</span>    }</div>
<div class="line"><span class="lineno"> 2135</span> </div>
<div class="line"><span class="lineno"> 2136</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#a52794290185255eb48736c942b07ae04">catchstack_top</a> == entry_catchstack_top);  <span class="comment">/* no need to unwind */</span></div>
<div class="line"><span class="lineno"> 2137</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#aea2cca88da9187f43fb2b925ef7f5ee4">callstack_top</a> == entry_callstack_top);</div>
<div class="line"><span class="lineno"> 2138</span> </div>
<div class="line"><span class="lineno"> 2139</span>    <a class="code hl_function" href="#a0a5f9e173b495524116abe7aa167026a">duk__safe_call_adjust_valstack</a>(thr, idx_retbase, num_stack_rets, rc);</div>
<div class="line"><span class="lineno"> 2140</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 2141</span> </div>
<div class="line"><span class="lineno"> 2142</span> thread_state_error:</div>
<div class="line"><span class="lineno"> 2143</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#af27bb9bfb183631e8c068865a8270012">DUK_ERROR_FMT1</a>(thr, <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8h.html#a02cde94a668a996bb017286a38c7e658">DUK_ERR_TYPE_ERROR</a>, <span class="stringliteral">&quot;invalid thread state for safe_call (%ld)&quot;</span>, (<span class="keywordtype">long</span>) thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#a4dc5dc48406aa6240185468557d154dc">state</a>);</div>
<div class="line"><span class="lineno"> 2144</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a0f457284c000920f86441b7ca7cbfe08">DUK_UNREACHABLE</a>();</div>
<div class="line"><span class="lineno"> 2145</span>}</div>
<div class="ttc" id="astructduk__heap_html_a1af957e1af60fa05e2d84f489b722ed3"><div class="ttname"><a href="structduk__heap.html#a1af957e1af60fa05e2d84f489b722ed3">duk_heap::call_recursion_limit</a></div><div class="ttdeci">duk_int_t call_recursion_limit</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07051">duktape-1.5.2/src-noline/duktape.c:7051</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07050">duk_heap::call_recursion_depth</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07051">duk_heap::call_recursion_limit</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06237">duk_hthread::callstack_top</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06243">duk_hthread::catchstack_top</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07044">duk_heap::curr_thread</a>, <a class="el" href="duktape-1_85_82_2src-separate_2duk__js__call_8c_source.html#l00851">duk__safe_call_adjust_valstack()</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07755">DUK_ASSERT</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06106">DUK_ASSERT_CTX_VALID</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07497">DUK_DDD</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07509">DUK_DDDPRINT</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8h_source.html#l00345">DUK_ERR_TYPE_ERROR</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07869">DUK_ERROR_API</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07628">DUK_ERROR_FMT1</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07875">DUK_ERROR_RANGE</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l40421">duk_error_throw_from_negative_rc()</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l15204">duk_get_top()</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06735">DUK_HEAP_SWITCH_THREAD</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06076">DUK_HTHREAD_STATE_INACTIVE</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06077">DUK_HTHREAD_STATE_RUNNING</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l15612">duk_require_stack()</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l02472">DUK_STR_C_CALLSTACK_LIMIT</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h_source.html#l02504">DUK_UNREACHABLE</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h_source.html#l02494">DUK_UNREF</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06202">duk_hthread::heap</a>, <a class="el" href="gmacros_8h_source.html#l00924">NULL</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06208">duk_hthread::state</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06226">duk_hthread::valstack</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06228">duk_hthread::valstack_bottom</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06227">duk_hthread::valstack_end</a>, and <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06229">duk_hthread::valstack_top</a>.</p>

<p class="reference">Referenced by <a class="el" href="duktape-1_85_82_2src-separate_2duk__js__call_8c_source.html#l01872">duk_handle_safe_call()</a>.</p>

</div>
</div>
<a id="a76056ac76a6e7dee82dbff39c88a3213" name="a76056ac76a6e7dee82dbff39c88a3213"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a76056ac76a6e7dee82dbff39c88a3213">&#9670;&#160;</a></span>duk__handle_safe_call_shared()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a245b431abb36cac1ac8d0eae054ed5c1">DUK_LOCAL</a> void duk__handle_safe_call_shared </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structduk__hthread.html">duk_hthread</a> *</td>          <td class="paramname"><span class="paramname"><em>thr</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a3e3bb369382aab50155c1d18bdf73923">duk_idx_t</a></td>          <td class="paramname"><span class="paramname"><em>idx_retbase</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a3e3bb369382aab50155c1d18bdf73923">duk_idx_t</a></td>          <td class="paramname"><span class="paramname"><em>num_stack_rets</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a9dbc0fdd27e7326d21cbf56e6d40d8a5">duk_int_t</a></td>          <td class="paramname"><span class="paramname"><em>entry_call_recursion_depth</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structduk__hthread.html">duk_hthread</a> *</td>          <td class="paramname"><span class="paramname"><em>entry_curr_thread</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a7ce35d12b12e3eea5f8d46c6195650d1">duk_uint_fast8_t</a></td>          <td class="paramname"><span class="paramname"><em>entry_thread_state</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a9231b6cd154afc387b6282e9bb8e0c6e">duk_instr_t</a> **</td>          <td class="paramname"><span class="paramname"><em>entry_ptr_curr_pc</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="duktape-1_85_82_2src-separate_2duk__js__call_8c_source.html#l02218">2218</a> of file <a class="el" href="duktape-1_85_82_2src-separate_2duk__js__call_8c_source.html">duktape-1.5.2/src-separate/duk_js_call.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2224</span>                                                                             {</div>
<div class="line"><span class="lineno"> 2225</span>    <a class="code hl_struct" href="structduk__hthread.html">duk_context</a> *ctx;</div>
<div class="line"><span class="lineno"> 2226</span> </div>
<div class="line"><span class="lineno"> 2227</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(thr != <a class="code hl_define" href="gmacros_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><span class="lineno"> 2228</span>    ctx = (<a class="code hl_struct" href="structduk__hthread.html">duk_context</a> *) thr;</div>
<div class="line"><span class="lineno"> 2229</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a06fc3069d0dbc1b0d9d28c15bb07e1ce">DUK_ASSERT_CTX_VALID</a>(ctx);</div>
<div class="line"><span class="lineno"> 2230</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a9170138f330dbcaabfae9d2c59cc9684">DUK_UNREF</a>(ctx);</div>
<div class="line"><span class="lineno"> 2231</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a9170138f330dbcaabfae9d2c59cc9684">DUK_UNREF</a>(idx_retbase);</div>
<div class="line"><span class="lineno"> 2232</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a9170138f330dbcaabfae9d2c59cc9684">DUK_UNREF</a>(num_stack_rets);</div>
<div class="line"><span class="lineno"> 2233</span> </div>
<div class="line"><span class="lineno"> 2234</span>    <span class="comment">/* Restore entry thread executor curr_pc stack frame pointer. */</span></div>
<div class="line"><span class="lineno"> 2235</span>    thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#a9ceabe6e4ac27d8e61e8f33d4eab55a6">ptr_curr_pc</a> = entry_ptr_curr_pc;</div>
<div class="line"><span class="lineno"> 2236</span> </div>
<div class="line"><span class="lineno"> 2237</span>    <span class="comment">/* XXX: because we unwind stacks above, thr-&gt;heap-&gt;curr_thread is at</span></div>
<div class="line"><span class="lineno"> 2238</span><span class="comment">     * risk of pointing to an already freed thread.  This was indeed the</span></div>
<div class="line"><span class="lineno"> 2239</span><span class="comment">     * case in test-bug-multithread-valgrind.c, until duk_handle_call()</span></div>
<div class="line"><span class="lineno"> 2240</span><span class="comment">     * was fixed to restore thr-&gt;heap-&gt;curr_thread before rethrowing an</span></div>
<div class="line"><span class="lineno"> 2241</span><span class="comment">     * uncaught error.</span></div>
<div class="line"><span class="lineno"> 2242</span><span class="comment">     */</span></div>
<div class="line"><span class="lineno"> 2243</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#ada39afa145c10879d68bc705850edcd7">DUK_HEAP_SWITCH_THREAD</a>(thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#a1c6d2e1f36b0b7011f0e52343ca5ed05">heap</a>, entry_curr_thread);  <span class="comment">/* may be NULL */</span></div>
<div class="line"><span class="lineno"> 2244</span>    thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#a4dc5dc48406aa6240185468557d154dc">state</a> = (duk_uint8_t) entry_thread_state;</div>
<div class="line"><span class="lineno"> 2245</span> </div>
<div class="line"><span class="lineno"> 2246</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>((thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#a4dc5dc48406aa6240185468557d154dc">state</a> == <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a60d14816853d0b43d8f6e2d033a9df60">DUK_HTHREAD_STATE_INACTIVE</a> &amp;&amp; thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#a1c6d2e1f36b0b7011f0e52343ca5ed05">heap</a>-&gt;<a class="code hl_variable" href="structduk__heap.html#a1f913439bf8af92c753891bea8abda78">curr_thread</a> == <a class="code hl_define" href="gmacros_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) ||  <span class="comment">/* first call */</span></div>
<div class="line"><span class="lineno"> 2247</span>               (thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#a4dc5dc48406aa6240185468557d154dc">state</a> == <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a60d14816853d0b43d8f6e2d033a9df60">DUK_HTHREAD_STATE_INACTIVE</a> &amp;&amp; thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#a1c6d2e1f36b0b7011f0e52343ca5ed05">heap</a>-&gt;<a class="code hl_variable" href="structduk__heap.html#a1f913439bf8af92c753891bea8abda78">curr_thread</a> != <a class="code hl_define" href="gmacros_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) ||  <span class="comment">/* other call */</span></div>
<div class="line"><span class="lineno"> 2248</span>               (thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#a4dc5dc48406aa6240185468557d154dc">state</a> == <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a82ed1e61fa4a768cbc65401274bfd89a">DUK_HTHREAD_STATE_RUNNING</a> &amp;&amp; thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#a1c6d2e1f36b0b7011f0e52343ca5ed05">heap</a>-&gt;<a class="code hl_variable" href="structduk__heap.html#a1f913439bf8af92c753891bea8abda78">curr_thread</a> == thr));     <span class="comment">/* current thread */</span></div>
<div class="line"><span class="lineno"> 2249</span> </div>
<div class="line"><span class="lineno"> 2250</span>    thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#a1c6d2e1f36b0b7011f0e52343ca5ed05">heap</a>-&gt;<a class="code hl_variable" href="structduk__heap.html#ab229eef9c6b0d7fcd267527a4b107fe5">call_recursion_depth</a> = entry_call_recursion_depth;</div>
<div class="line"><span class="lineno"> 2251</span> </div>
<div class="line"><span class="lineno"> 2252</span>    <span class="comment">/* stack discipline consistency check */</span></div>
<div class="line"><span class="lineno"> 2253</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(<a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a8c8653fcd951809042c23c42e534c421">duk_get_top</a>(ctx) == idx_retbase + num_stack_rets);</div>
<div class="line"><span class="lineno"> 2254</span> </div>
<div class="line"><span class="lineno"> 2255</span>    <span class="comment">/* A debugger forced interrupt check is not needed here, as</span></div>
<div class="line"><span class="lineno"> 2256</span><span class="comment">     * problematic safe calls are not caused by side effects.</span></div>
<div class="line"><span class="lineno"> 2257</span><span class="comment">     */</span></div>
<div class="line"><span class="lineno"> 2258</span> </div>
<div class="line"><span class="lineno"> 2259</span><span class="preprocessor">#if defined(DUK_USE_INTERRUPT_COUNTER) &amp;&amp; defined(DUK_USE_DEBUG)</span></div>
<div class="line"><span class="lineno"> 2260</span>    duk__interrupt_fixup(thr, entry_curr_thread);</div>
<div class="line"><span class="lineno"> 2261</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 2262</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07050">duk_heap::call_recursion_depth</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07044">duk_heap::curr_thread</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07755">DUK_ASSERT</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06106">DUK_ASSERT_CTX_VALID</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l15204">duk_get_top()</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06735">DUK_HEAP_SWITCH_THREAD</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06076">DUK_HTHREAD_STATE_INACTIVE</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06077">DUK_HTHREAD_STATE_RUNNING</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h_source.html#l02494">DUK_UNREF</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06202">duk_hthread::heap</a>, <a class="el" href="gmacros_8h_source.html#l00924">NULL</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06199">duk_hthread::ptr_curr_pc</a>, and <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06208">duk_hthread::state</a>.</p>

<p class="reference">Referenced by <a class="el" href="duktape-1_85_82_2src-separate_2duk__js__call_8c_source.html#l01872">duk_handle_safe_call()</a>.</p>

</div>
</div>
<a id="a0d5042617a44a3204d4839319683aeb2" name="a0d5042617a44a3204d4839319683aeb2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0d5042617a44a3204d4839319683aeb2">&#9670;&#160;</a></span>duk__nonbound_func_lookup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a245b431abb36cac1ac8d0eae054ed5c1">DUK_LOCAL</a> <a class="el" href="structduk__hobject.html">duk_hobject</a> * duk__nonbound_func_lookup </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#aedf99a449ea72d41f16606f6c8ced70d">duk_context</a> *</td>          <td class="paramname"><span class="paramname"><em>ctx</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a3e3bb369382aab50155c1d18bdf73923">duk_idx_t</a></td>          <td class="paramname"><span class="paramname"><em>idx_func</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a3e3bb369382aab50155c1d18bdf73923">duk_idx_t</a> *</td>          <td class="paramname"><span class="paramname"><em>out_num_stack_args</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a9ad3133ae87f4653a6e6183262a5ca3c">duk_tval</a> **</td>          <td class="paramname"><span class="paramname"><em>out_tv_func</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a2b7ba45bf826058a9b7720b5e258efc6">duk_small_uint_t</a></td>          <td class="paramname"><span class="paramname"><em>call_flags</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="duktape-1_85_82_2src-separate_2duk__js__call_8c_source.html#l00717">717</a> of file <a class="el" href="duktape-1_85_82_2src-separate_2duk__js__call_8c_source.html">duktape-1.5.2/src-separate/duk_js_call.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  721</span>                                                                              {</div>
<div class="line"><span class="lineno">  722</span>    <a class="code hl_struct" href="structduk__hthread.html">duk_hthread</a> *thr = (<a class="code hl_struct" href="structduk__hthread.html">duk_hthread</a> *) ctx;</div>
<div class="line"><span class="lineno">  723</span>    <a class="code hl_struct" href="structduk__tval__struct.html">duk_tval</a> *tv_func;</div>
<div class="line"><span class="lineno">  724</span>    <a class="code hl_struct" href="structduk__hobject.html">duk_hobject</a> *func;</div>
<div class="line"><span class="lineno">  725</span> </div>
<div class="line"><span class="lineno">  726</span>    <span class="keywordflow">for</span> (;;) {</div>
<div class="line"><span class="lineno">  727</span>        <span class="comment">/* Use loop to minimize code size of relookup after bound function case */</span></div>
<div class="line"><span class="lineno">  728</span>        tv_func = <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#ac68be5e45bda626b6887583a3352e995">DUK_GET_TVAL_POSIDX</a>(ctx, idx_func);</div>
<div class="line"><span class="lineno">  729</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(tv_func != <a class="code hl_define" href="gmacros_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><span class="lineno">  730</span> </div>
<div class="line"><span class="lineno">  731</span>        <span class="keywordflow">if</span> (<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a3e6da5a54e90086602a9d6f44997d640">DUK_TVAL_IS_OBJECT</a>(tv_func)) {</div>
<div class="line"><span class="lineno">  732</span>            func = <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a2a196d761c3a7789fcc2ac3cf61ad601">DUK_TVAL_GET_OBJECT</a>(tv_func);</div>
<div class="line"><span class="lineno">  733</span>            <span class="keywordflow">if</span> (!<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a5cddbda72ae6a410b02df36ca04b1897">DUK_HOBJECT_IS_CALLABLE</a>(func)) {</div>
<div class="line"><span class="lineno">  734</span>                <span class="keywordflow">goto</span> not_callable_error;</div>
<div class="line"><span class="lineno">  735</span>            }</div>
<div class="line"><span class="lineno">  736</span>            <span class="keywordflow">if</span> (<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a1405011142963f5c45c82eb2a881e385">DUK_HOBJECT_HAS_BOUND</a>(func)) {</div>
<div class="line"><span class="lineno">  737</span>                <a class="code hl_function" href="#a115e6a9a6b1b429b9b2df7e546ba8d9c">duk__handle_bound_chain_for_call</a>(thr, idx_func, out_num_stack_args, call_flags &amp; <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a19a9d6a4b52e03c7f42e925cfe76992f">DUK_CALL_FLAG_CONSTRUCTOR_CALL</a>);</div>
<div class="line"><span class="lineno">  738</span> </div>
<div class="line"><span class="lineno">  739</span>                <span class="comment">/* The final object may be a normal function or a lightfunc.</span></div>
<div class="line"><span class="lineno">  740</span><span class="comment">                 * We need to re-lookup tv_func because it may have changed</span></div>
<div class="line"><span class="lineno">  741</span><span class="comment">                 * (also value stack may have been resized).  Loop again to</span></div>
<div class="line"><span class="lineno">  742</span><span class="comment">                 * do that; we&#39;re guaranteed not to come here again.</span></div>
<div class="line"><span class="lineno">  743</span><span class="comment">                 */</span></div>
<div class="line"><span class="lineno">  744</span>                <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a3e6da5a54e90086602a9d6f44997d640">DUK_TVAL_IS_OBJECT</a>(<a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#aae4918883d66d1a21907da22171fb1c6">duk_require_tval</a>(ctx, idx_func)) ||</div>
<div class="line"><span class="lineno">  745</span>                           <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a803cbfe1e33fe5c591d7bec4fd3a6a93">DUK_TVAL_IS_LIGHTFUNC</a>(<a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#aae4918883d66d1a21907da22171fb1c6">duk_require_tval</a>(ctx, idx_func)));</div>
<div class="line"><span class="lineno">  746</span>                <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  747</span>            }</div>
<div class="line"><span class="lineno">  748</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a803cbfe1e33fe5c591d7bec4fd3a6a93">DUK_TVAL_IS_LIGHTFUNC</a>(tv_func)) {</div>
<div class="line"><span class="lineno">  749</span>            func = <a class="code hl_define" href="gmacros_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><span class="lineno">  750</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  751</span>            <span class="keywordflow">goto</span> not_callable_error;</div>
<div class="line"><span class="lineno">  752</span>        }</div>
<div class="line"><span class="lineno">  753</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  754</span>    }</div>
<div class="line"><span class="lineno">  755</span> </div>
<div class="line"><span class="lineno">  756</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>((<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a3e6da5a54e90086602a9d6f44997d640">DUK_TVAL_IS_OBJECT</a>(tv_func) &amp;&amp; <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a5cddbda72ae6a410b02df36ca04b1897">DUK_HOBJECT_IS_CALLABLE</a>(<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a2a196d761c3a7789fcc2ac3cf61ad601">DUK_TVAL_GET_OBJECT</a>(tv_func))) ||</div>
<div class="line"><span class="lineno">  757</span>               <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a803cbfe1e33fe5c591d7bec4fd3a6a93">DUK_TVAL_IS_LIGHTFUNC</a>(tv_func));</div>
<div class="line"><span class="lineno">  758</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(func == <a class="code hl_define" href="gmacros_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> || !<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a1405011142963f5c45c82eb2a881e385">DUK_HOBJECT_HAS_BOUND</a>(func));</div>
<div class="line"><span class="lineno">  759</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(func == <a class="code hl_define" href="gmacros_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> || (<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a3b446d4cd53f63e5e57b80041eb0d598">DUK_HOBJECT_IS_COMPILEDFUNCTION</a>(func) ||</div>
<div class="line"><span class="lineno">  760</span>                                <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a70ce6873e608ce9399d8c7e2e45af92f">DUK_HOBJECT_IS_NATIVEFUNCTION</a>(func)));</div>
<div class="line"><span class="lineno">  761</span> </div>
<div class="line"><span class="lineno">  762</span>    *out_tv_func = tv_func;</div>
<div class="line"><span class="lineno">  763</span>    <span class="keywordflow">return</span> func;</div>
<div class="line"><span class="lineno">  764</span> </div>
<div class="line"><span class="lineno">  765</span> not_callable_error:</div>
<div class="line"><span class="lineno">  766</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(tv_func != <a class="code hl_define" href="gmacros_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><span class="lineno">  767</span><span class="preprocessor">#if defined(DUK_USE_PARANOID_ERRORS)</span></div>
<div class="line"><span class="lineno">  768</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a13623e5d472d92f656ad1d9a2875d277">DUK_ERROR_TYPE</a>(thr, <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a0face1475afe4e3efae57c1386b88c32">DUK_STR_NOT_CALLABLE</a>);</div>
<div class="line"><span class="lineno">  769</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno">  770</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#af27bb9bfb183631e8c068865a8270012">DUK_ERROR_FMT1</a>(thr, <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8h.html#a02cde94a668a996bb017286a38c7e658">DUK_ERR_TYPE_ERROR</a>, <span class="stringliteral">&quot;%s not callable&quot;</span>, <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#ae4a6a93c79e49f159b46118f7cc86124">duk_push_string_tval_readable</a>(ctx, tv_func));</div>
<div class="line"><span class="lineno">  771</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  772</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a0f457284c000920f86441b7ca7cbfe08">DUK_UNREACHABLE</a>();</div>
<div class="line"><span class="lineno">  773</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="gmacros_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;  <span class="comment">/* never executed */</span></div>
<div class="line"><span class="lineno">  774</span>}</div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_a5cddbda72ae6a410b02df36ca04b1897"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#a5cddbda72ae6a410b02df36ca04b1897">DUK_HOBJECT_IS_CALLABLE</a></div><div class="ttdeci">#define DUK_HOBJECT_IS_CALLABLE(h)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l04788">duktape-1.5.2/src-noline/duktape.c:4788</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_ac68be5e45bda626b6887583a3352e995"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#ac68be5e45bda626b6887583a3352e995">DUK_GET_TVAL_POSIDX</a></div><div class="ttdeci">#define DUK_GET_TVAL_POSIDX(ctx, idx)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l04388">duktape-1.5.2/src-noline/duktape.c:4388</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_ae4a6a93c79e49f159b46118f7cc86124"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#ae4a6a93c79e49f159b46118f7cc86124">duk_push_string_tval_readable</a></div><div class="ttdeci">DUK_INTERNAL_DECL const char * duk_push_string_tval_readable(duk_context *ctx, duk_tval *tv)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l19476">duktape-1.5.2/src-noline/duktape.c:19476</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-separate_2duk__js__call_8c_html_a115e6a9a6b1b429b9b2df7e546ba8d9c"><div class="ttname"><a href="#a115e6a9a6b1b429b9b2df7e546ba8d9c">duk__handle_bound_chain_for_call</a></div><div class="ttdeci">DUK_LOCAL void duk__handle_bound_chain_for_call(duk_hthread *thr, duk_idx_t idx_func, duk_idx_t *p_num_stack_args, duk_bool_t is_constructor_call)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-separate_2duk__js__call_8c_source.html#l00406">duktape-1.5.2/src-separate/duk_js_call.c:406</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="duktape-1_85_82_2src-separate_2duk__js__call_8c_source.html#l00406">duk__handle_bound_chain_for_call()</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07755">DUK_ASSERT</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l08344">DUK_CALL_FLAG_CONSTRUCTOR_CALL</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8h_source.html#l00345">DUK_ERR_TYPE_ERROR</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07628">DUK_ERROR_FMT1</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07882">DUK_ERROR_TYPE</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l04388">DUK_GET_TVAL_POSIDX</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l04805">DUK_HOBJECT_HAS_BOUND</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l04788">DUK_HOBJECT_IS_CALLABLE</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l04774">DUK_HOBJECT_IS_COMPILEDFUNCTION</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l04775">DUK_HOBJECT_IS_NATIVEFUNCTION</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l19476">duk_push_string_tval_readable()</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l15149">duk_require_tval()</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l02281">DUK_STR_NOT_CALLABLE</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l00787">DUK_TVAL_GET_OBJECT</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l00809">DUK_TVAL_IS_LIGHTFUNC</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l00811">DUK_TVAL_IS_OBJECT</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h_source.html#l02504">DUK_UNREACHABLE</a>, and <a class="el" href="gmacros_8h_source.html#l00924">NULL</a>.</p>

<p class="reference">Referenced by <a class="el" href="duktape-1_85_82_2src-separate_2duk__js__call_8c_source.html#l01158">duk__handle_call_inner()</a>, and <a class="el" href="duktape-1_85_82_2src-separate_2duk__js__call_8c_source.html#l02290">duk_handle_ecma_call_setup()</a>.</p>

</div>
</div>
<a id="a0a5f9e173b495524116abe7aa167026a" name="a0a5f9e173b495524116abe7aa167026a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0a5f9e173b495524116abe7aa167026a">&#9670;&#160;</a></span>duk__safe_call_adjust_valstack()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a245b431abb36cac1ac8d0eae054ed5c1">DUK_LOCAL</a> void duk__safe_call_adjust_valstack </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structduk__hthread.html">duk_hthread</a> *</td>          <td class="paramname"><span class="paramname"><em>thr</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a3e3bb369382aab50155c1d18bdf73923">duk_idx_t</a></td>          <td class="paramname"><span class="paramname"><em>idx_retbase</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a3e3bb369382aab50155c1d18bdf73923">duk_idx_t</a></td>          <td class="paramname"><span class="paramname"><em>num_stack_rets</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a3e3bb369382aab50155c1d18bdf73923">duk_idx_t</a></td>          <td class="paramname"><span class="paramname"><em>num_actual_rets</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="duktape-1_85_82_2src-separate_2duk__js__call_8c_source.html#l00851">851</a> of file <a class="el" href="duktape-1_85_82_2src-separate_2duk__js__call_8c_source.html">duktape-1.5.2/src-separate/duk_js_call.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  851</span>                                                                                                                                            {</div>
<div class="line"><span class="lineno">  852</span>    <a class="code hl_struct" href="structduk__hthread.html">duk_context</a> *ctx = (<a class="code hl_struct" href="structduk__hthread.html">duk_context</a> *) thr;</div>
<div class="line"><span class="lineno">  853</span>    <a class="code hl_typedef" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a3e3bb369382aab50155c1d18bdf73923">duk_idx_t</a> idx_rcbase;</div>
<div class="line"><span class="lineno">  854</span> </div>
<div class="line"><span class="lineno">  855</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(thr != <a class="code hl_define" href="gmacros_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><span class="lineno">  856</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(idx_retbase &gt;= 0);</div>
<div class="line"><span class="lineno">  857</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(num_stack_rets &gt;= 0);</div>
<div class="line"><span class="lineno">  858</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(num_actual_rets &gt;= 0);</div>
<div class="line"><span class="lineno">  859</span> </div>
<div class="line"><span class="lineno">  860</span>    idx_rcbase = <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a8c8653fcd951809042c23c42e534c421">duk_get_top</a>(ctx) - num_actual_rets;  <span class="comment">/* base of known return values */</span></div>
<div class="line"><span class="lineno">  861</span> </div>
<div class="line"><span class="lineno">  862</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a2db20d2d3b36d8491ed171cf503488bb">DUK_DDD</a>(<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#aa6e5d41ceaba6832e5ede737f0a35fb9">DUK_DDDPRINT</a>(<span class="stringliteral">&quot;adjust valstack after func call: &quot;</span></div>
<div class="line"><span class="lineno">  863</span>                         <span class="stringliteral">&quot;num_stack_rets=%ld, num_actual_rets=%ld, stack_top=%ld, idx_retbase=%ld, idx_rcbase=%ld&quot;</span>,</div>
<div class="line"><span class="lineno">  864</span>                         (<span class="keywordtype">long</span>) num_stack_rets, (<span class="keywordtype">long</span>) num_actual_rets, (<span class="keywordtype">long</span>) <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a8c8653fcd951809042c23c42e534c421">duk_get_top</a>(ctx),</div>
<div class="line"><span class="lineno">  865</span>                         (<span class="keywordtype">long</span>) idx_retbase, (<span class="keywordtype">long</span>) idx_rcbase));</div>
<div class="line"><span class="lineno">  866</span> </div>
<div class="line"><span class="lineno">  867</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(idx_rcbase &gt;= 0);  <span class="comment">/* caller must check */</span></div>
<div class="line"><span class="lineno">  868</span> </div>
<div class="line"><span class="lineno">  869</span>    <span class="comment">/* Ensure space for final configuration (idx_retbase + num_stack_rets)</span></div>
<div class="line"><span class="lineno">  870</span><span class="comment">     * and intermediate configurations.</span></div>
<div class="line"><span class="lineno">  871</span><span class="comment">     */</span></div>
<div class="line"><span class="lineno">  872</span>    <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a6fb7c9c1185f4a5469db202b63a905c0">duk_require_stack_top</a>(ctx,</div>
<div class="line"><span class="lineno">  873</span>                          (idx_rcbase &gt; idx_retbase ? idx_rcbase : idx_retbase) +</div>
<div class="line"><span class="lineno">  874</span>                          num_stack_rets);</div>
<div class="line"><span class="lineno">  875</span> </div>
<div class="line"><span class="lineno">  876</span>    <span class="comment">/* Chop extra retvals away / extend with undefined. */</span></div>
<div class="line"><span class="lineno">  877</span>    <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a808471cbdda897175b2e4d50528c430d">duk_set_top</a>(ctx, idx_rcbase + num_stack_rets);</div>
<div class="line"><span class="lineno">  878</span> </div>
<div class="line"><span class="lineno">  879</span>    <span class="keywordflow">if</span> (idx_rcbase &gt;= idx_retbase) {</div>
<div class="line"><span class="lineno">  880</span>        <a class="code hl_typedef" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a3e3bb369382aab50155c1d18bdf73923">duk_idx_t</a> count = idx_rcbase - idx_retbase;</div>
<div class="line"><span class="lineno">  881</span>        <a class="code hl_typedef" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a3e3bb369382aab50155c1d18bdf73923">duk_idx_t</a> i;</div>
<div class="line"><span class="lineno">  882</span> </div>
<div class="line"><span class="lineno">  883</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a2db20d2d3b36d8491ed171cf503488bb">DUK_DDD</a>(<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#aa6e5d41ceaba6832e5ede737f0a35fb9">DUK_DDDPRINT</a>(<span class="stringliteral">&quot;elements at/after idx_retbase have enough to cover func retvals &quot;</span></div>
<div class="line"><span class="lineno">  884</span>                             <span class="stringliteral">&quot;(idx_retbase=%ld, idx_rcbase=%ld)&quot;</span>, (<span class="keywordtype">long</span>) idx_retbase, (<span class="keywordtype">long</span>) idx_rcbase));</div>
<div class="line"><span class="lineno">  885</span> </div>
<div class="line"><span class="lineno">  886</span>        <span class="comment">/* nuke values at idx_retbase to get the first retval (initially</span></div>
<div class="line"><span class="lineno">  887</span><span class="comment">         * at idx_rcbase) to idx_retbase</span></div>
<div class="line"><span class="lineno">  888</span><span class="comment">         */</span></div>
<div class="line"><span class="lineno">  889</span> </div>
<div class="line"><span class="lineno">  890</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(count &gt;= 0);</div>
<div class="line"><span class="lineno">  891</span> </div>
<div class="line"><span class="lineno">  892</span>        <span class="keywordflow">for</span> (i = 0; i &lt; count; i++) {</div>
<div class="line"><span class="lineno">  893</span>            <span class="comment">/* XXX: inefficient; block remove primitive */</span></div>
<div class="line"><span class="lineno">  894</span>            <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52f537d78760f69d0d94d21728279b50">duk_remove</a>(ctx, idx_retbase);</div>
<div class="line"><span class="lineno">  895</span>        }</div>
<div class="line"><span class="lineno">  896</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  897</span>        <a class="code hl_typedef" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a3e3bb369382aab50155c1d18bdf73923">duk_idx_t</a> count = idx_retbase - idx_rcbase;</div>
<div class="line"><span class="lineno">  898</span>        <a class="code hl_typedef" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a3e3bb369382aab50155c1d18bdf73923">duk_idx_t</a> i;</div>
<div class="line"><span class="lineno">  899</span> </div>
<div class="line"><span class="lineno">  900</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a2db20d2d3b36d8491ed171cf503488bb">DUK_DDD</a>(<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#aa6e5d41ceaba6832e5ede737f0a35fb9">DUK_DDDPRINT</a>(<span class="stringliteral">&quot;not enough elements at/after idx_retbase to cover func retvals &quot;</span></div>
<div class="line"><span class="lineno">  901</span>                             <span class="stringliteral">&quot;(idx_retbase=%ld, idx_rcbase=%ld)&quot;</span>, (<span class="keywordtype">long</span>) idx_retbase, (<span class="keywordtype">long</span>) idx_rcbase));</div>
<div class="line"><span class="lineno">  902</span> </div>
<div class="line"><span class="lineno">  903</span>        <span class="comment">/* insert &#39;undefined&#39; values at idx_rcbase to get the</span></div>
<div class="line"><span class="lineno">  904</span><span class="comment">         * return values to idx_retbase</span></div>
<div class="line"><span class="lineno">  905</span><span class="comment">         */</span></div>
<div class="line"><span class="lineno">  906</span> </div>
<div class="line"><span class="lineno">  907</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(count &gt; 0);</div>
<div class="line"><span class="lineno">  908</span> </div>
<div class="line"><span class="lineno">  909</span>        <span class="keywordflow">for</span> (i = 0; i &lt; count; i++) {</div>
<div class="line"><span class="lineno">  910</span>            <span class="comment">/* XXX: inefficient; block insert primitive */</span></div>
<div class="line"><span class="lineno">  911</span>            <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a9e54c2f552800058d06a34af260ead0f">duk_push_undefined</a>(ctx);</div>
<div class="line"><span class="lineno">  912</span>            <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a86e82045aad43776c7280e8e689c5158">duk_insert</a>(ctx, idx_rcbase);</div>
<div class="line"><span class="lineno">  913</span>        }</div>
<div class="line"><span class="lineno">  914</span>    }</div>
<div class="line"><span class="lineno">  915</span>}</div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_a9e54c2f552800058d06a34af260ead0f"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#a9e54c2f552800058d06a34af260ead0f">duk_push_undefined</a></div><div class="ttdeci">DUK_EXTERNAL void duk_push_undefined(duk_context *ctx)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l17848">duktape-1.5.2/src-noline/duktape.c:17848</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07755">DUK_ASSERT</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07497">DUK_DDD</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07509">DUK_DDDPRINT</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l15204">duk_get_top()</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l15740">duk_insert()</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l17848">duk_push_undefined()</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l15820">duk_remove()</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l15654">duk_require_stack_top()</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l15216">duk_set_top()</a>, and <a class="el" href="gmacros_8h_source.html#l00924">NULL</a>.</p>

<p class="reference">Referenced by <a class="el" href="duktape-1_85_82_2src-separate_2duk__js__call_8c_source.html#l02147">duk__handle_safe_call_error()</a>, and <a class="el" href="duktape-1_85_82_2src-separate_2duk__js__call_8c_source.html#l02038">duk__handle_safe_call_inner()</a>.</p>

</div>
</div>
<a id="ac11145b57956e2a80e4d3a816487ecdc" name="ac11145b57956e2a80e4d3a816487ecdc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac11145b57956e2a80e4d3a816487ecdc">&#9670;&#160;</a></span>duk_handle_call_protected()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a19032f251b36af6bfb17f4450b829521">DUK_INTERNAL</a> <a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a9dbc0fdd27e7326d21cbf56e6d40d8a5">duk_int_t</a> duk_handle_call_protected </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structduk__hthread.html">duk_hthread</a> *</td>          <td class="paramname"><span class="paramname"><em>thr</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a3e3bb369382aab50155c1d18bdf73923">duk_idx_t</a></td>          <td class="paramname"><span class="paramname"><em>num_stack_args</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a2b7ba45bf826058a9b7720b5e258efc6">duk_small_uint_t</a></td>          <td class="paramname"><span class="paramname"><em>call_flags</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="duktape-1_85_82_2src-separate_2duk__js__call_8c_source.html#l00966">966</a> of file <a class="el" href="duktape-1_85_82_2src-separate_2duk__js__call_8c_source.html">duktape-1.5.2/src-separate/duk_js_call.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  968</span>                                                                              {</div>
<div class="line"><span class="lineno">  969</span>    <a class="code hl_struct" href="structduk__hthread.html">duk_context</a> *ctx;</div>
<div class="line"><span class="lineno">  970</span>    <a class="code hl_typedef" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#ab0a71934d59f38f195fea2f353032392">duk_size_t</a> entry_valstack_bottom_index;</div>
<div class="line"><span class="lineno">  971</span>    <a class="code hl_typedef" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#ab0a71934d59f38f195fea2f353032392">duk_size_t</a> entry_valstack_end;</div>
<div class="line"><span class="lineno">  972</span>    <a class="code hl_typedef" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#ab0a71934d59f38f195fea2f353032392">duk_size_t</a> entry_callstack_top;</div>
<div class="line"><span class="lineno">  973</span>    <a class="code hl_typedef" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#ab0a71934d59f38f195fea2f353032392">duk_size_t</a> entry_catchstack_top;</div>
<div class="line"><span class="lineno">  974</span>    <a class="code hl_typedef" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a9dbc0fdd27e7326d21cbf56e6d40d8a5">duk_int_t</a> entry_call_recursion_depth;</div>
<div class="line"><span class="lineno">  975</span>    <a class="code hl_struct" href="structduk__hthread.html">duk_hthread</a> *entry_curr_thread;</div>
<div class="line"><span class="lineno">  976</span>    <a class="code hl_typedef" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a7ce35d12b12e3eea5f8d46c6195650d1">duk_uint_fast8_t</a> entry_thread_state;</div>
<div class="line"><span class="lineno">  977</span>    <a class="code hl_typedef" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a9231b6cd154afc387b6282e9bb8e0c6e">duk_instr_t</a> **entry_ptr_curr_pc;</div>
<div class="line"><span class="lineno">  978</span>    <a class="code hl_struct" href="structduk__jmpbuf.html">duk_jmpbuf</a> *old_jmpbuf_ptr = <a class="code hl_define" href="gmacros_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><span class="lineno">  979</span>    <a class="code hl_struct" href="structduk__jmpbuf.html">duk_jmpbuf</a> our_jmpbuf;</div>
<div class="line"><span class="lineno">  980</span>    <a class="code hl_typedef" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a3e3bb369382aab50155c1d18bdf73923">duk_idx_t</a> idx_func;  <span class="comment">/* valstack index of &#39;func&#39; and retval (relative to entry valstack_bottom) */</span></div>
<div class="line"><span class="lineno">  981</span> </div>
<div class="line"><span class="lineno">  982</span>    <span class="comment">/* XXX: Multiple tv_func lookups are now avoided by making a local</span></div>
<div class="line"><span class="lineno">  983</span><span class="comment">     * copy of tv_func.  Another approach would be to compute an offset</span></div>
<div class="line"><span class="lineno">  984</span><span class="comment">     * for tv_func from valstack bottom and recomputing the tv_func</span></div>
<div class="line"><span class="lineno">  985</span><span class="comment">     * pointer quickly as valstack + offset instead of calling duk_get_tval().</span></div>
<div class="line"><span class="lineno">  986</span><span class="comment">     */</span></div>
<div class="line"><span class="lineno">  987</span> </div>
<div class="line"><span class="lineno">  988</span>    ctx = (<a class="code hl_struct" href="structduk__hthread.html">duk_context</a> *) thr;</div>
<div class="line"><span class="lineno">  989</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a9170138f330dbcaabfae9d2c59cc9684">DUK_UNREF</a>(ctx);</div>
<div class="line"><span class="lineno">  990</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(thr != <a class="code hl_define" href="gmacros_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><span class="lineno">  991</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a06fc3069d0dbc1b0d9d28c15bb07e1ce">DUK_ASSERT_CTX_VALID</a>(ctx);</div>
<div class="line"><span class="lineno">  992</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(num_stack_args &gt;= 0);</div>
<div class="line"><span class="lineno">  993</span>    <span class="comment">/* XXX: currently NULL allocations are not supported; remove if later allowed */</span></div>
<div class="line"><span class="lineno">  994</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#a08f58ff5b9fa5927891c2e08712e3971">valstack</a> != <a class="code hl_define" href="gmacros_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><span class="lineno">  995</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#ac03631b2f8ff5bab23d409f0bb966579">callstack</a> != <a class="code hl_define" href="gmacros_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><span class="lineno">  996</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#af6ad1a5c8500ffe6443be8fec677a775">catchstack</a> != <a class="code hl_define" href="gmacros_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><span class="lineno">  997</span> </div>
<div class="line"><span class="lineno">  998</span>    <span class="comment">/* Argument validation and func/args offset. */</span></div>
<div class="line"><span class="lineno">  999</span>    idx_func = <a class="code hl_function" href="#a0ee6d00b24673db60bd1f2df3700c1e2">duk__get_idx_func</a>(thr, num_stack_args);</div>
<div class="line"><span class="lineno"> 1000</span> </div>
<div class="line"><span class="lineno"> 1001</span>    <span class="comment">/* Preliminaries, required by setjmp() handler.  Must be careful not</span></div>
<div class="line"><span class="lineno"> 1002</span><span class="comment">     * to throw an unintended error here.</span></div>
<div class="line"><span class="lineno"> 1003</span><span class="comment">     */</span></div>
<div class="line"><span class="lineno"> 1004</span> </div>
<div class="line"><span class="lineno"> 1005</span>    entry_valstack_bottom_index = (<a class="code hl_typedef" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#ab0a71934d59f38f195fea2f353032392">duk_size_t</a>) (thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#ad39b6c03b81eb0f4d3eefda5083988d3">valstack_bottom</a> - thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#a08f58ff5b9fa5927891c2e08712e3971">valstack</a>);</div>
<div class="line"><span class="lineno"> 1006</span><span class="preprocessor">#if defined(DUK_USE_PREFER_SIZE)</span></div>
<div class="line"><span class="lineno"> 1007</span>    entry_valstack_end = (<a class="code hl_typedef" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#ab0a71934d59f38f195fea2f353032392">duk_size_t</a>) (thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#a09749b7b70f6fd8ad3661adfac3316b5">valstack_end</a> - thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#a08f58ff5b9fa5927891c2e08712e3971">valstack</a>);</div>
<div class="line"><span class="lineno"> 1008</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno"> 1009</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>((<a class="code hl_typedef" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#ab0a71934d59f38f195fea2f353032392">duk_size_t</a>) (thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#a09749b7b70f6fd8ad3661adfac3316b5">valstack_end</a> - thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#a08f58ff5b9fa5927891c2e08712e3971">valstack</a>) == thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#ad195c4cbdb413aa9c6d4144a3959e749">valstack_size</a>);</div>
<div class="line"><span class="lineno"> 1010</span>    entry_valstack_end = thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#ad195c4cbdb413aa9c6d4144a3959e749">valstack_size</a>;</div>
<div class="line"><span class="lineno"> 1011</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1012</span>    entry_callstack_top = thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#aea2cca88da9187f43fb2b925ef7f5ee4">callstack_top</a>;</div>
<div class="line"><span class="lineno"> 1013</span>    entry_catchstack_top = thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#a52794290185255eb48736c942b07ae04">catchstack_top</a>;</div>
<div class="line"><span class="lineno"> 1014</span>    entry_call_recursion_depth = thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#a1c6d2e1f36b0b7011f0e52343ca5ed05">heap</a>-&gt;<a class="code hl_variable" href="structduk__heap.html#ab229eef9c6b0d7fcd267527a4b107fe5">call_recursion_depth</a>;</div>
<div class="line"><span class="lineno"> 1015</span>    entry_curr_thread = thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#a1c6d2e1f36b0b7011f0e52343ca5ed05">heap</a>-&gt;<a class="code hl_variable" href="structduk__heap.html#a1f913439bf8af92c753891bea8abda78">curr_thread</a>;  <span class="comment">/* Note: may be NULL if first call */</span></div>
<div class="line"><span class="lineno"> 1016</span>    entry_thread_state = thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#a4dc5dc48406aa6240185468557d154dc">state</a>;</div>
<div class="line"><span class="lineno"> 1017</span>    entry_ptr_curr_pc = thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#a9ceabe6e4ac27d8e61e8f33d4eab55a6">ptr_curr_pc</a>;  <span class="comment">/* may be NULL */</span></div>
<div class="line"><span class="lineno"> 1018</span> </div>
<div class="line"><span class="lineno"> 1019</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a6c3a2adb6e09294c7e65f69821e5e81a">DUK_DD</a>(<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#aa66ca9adc2b4187c5d549a9b117b03d3">DUK_DDPRINT</a>(<span class="stringliteral">&quot;duk_handle_call_protected: thr=%p, num_stack_args=%ld, &quot;</span></div>
<div class="line"><span class="lineno"> 1020</span>                       <span class="stringliteral">&quot;call_flags=0x%08lx (ignorerec=%ld, constructor=%ld), &quot;</span></div>
<div class="line"><span class="lineno"> 1021</span>                       <span class="stringliteral">&quot;valstack_top=%ld, idx_func=%ld, idx_args=%ld, rec_depth=%ld/%ld, &quot;</span></div>
<div class="line"><span class="lineno"> 1022</span>                       <span class="stringliteral">&quot;entry_valstack_bottom_index=%ld, entry_callstack_top=%ld, entry_catchstack_top=%ld, &quot;</span></div>
<div class="line"><span class="lineno"> 1023</span>                       <span class="stringliteral">&quot;entry_call_recursion_depth=%ld, entry_curr_thread=%p, entry_thread_state=%ld&quot;</span>,</div>
<div class="line"><span class="lineno"> 1024</span>                       (<span class="keywordtype">void</span> *) thr,</div>
<div class="line"><span class="lineno"> 1025</span>                       (<span class="keywordtype">long</span>) num_stack_args,</div>
<div class="line"><span class="lineno"> 1026</span>                       (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>) call_flags,</div>
<div class="line"><span class="lineno"> 1027</span>                       (<span class="keywordtype">long</span>) ((call_flags &amp; <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#afa9b99df5108fec08cd0dc85f30d70da">DUK_CALL_FLAG_IGNORE_RECLIMIT</a>) != 0 ? 1 : 0),</div>
<div class="line"><span class="lineno"> 1028</span>                       (long) ((call_flags &amp; <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a19a9d6a4b52e03c7f42e925cfe76992f">DUK_CALL_FLAG_CONSTRUCTOR_CALL</a>) != 0 ? 1 : 0),</div>
<div class="line"><span class="lineno"> 1029</span>                       (long) <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a8c8653fcd951809042c23c42e534c421">duk_get_top</a>(ctx),</div>
<div class="line"><span class="lineno"> 1030</span>                       (long) idx_func,</div>
<div class="line"><span class="lineno"> 1031</span>                       (long) (idx_func + 2),</div>
<div class="line"><span class="lineno"> 1032</span>                       (long) thr-&gt;heap-&gt;call_recursion_depth,</div>
<div class="line"><span class="lineno"> 1033</span>                       (long) thr-&gt;heap-&gt;call_recursion_limit,</div>
<div class="line"><span class="lineno"> 1034</span>                       (long) entry_valstack_bottom_index,</div>
<div class="line"><span class="lineno"> 1035</span>                       (long) entry_callstack_top,</div>
<div class="line"><span class="lineno"> 1036</span>                       (long) entry_catchstack_top,</div>
<div class="line"><span class="lineno"> 1037</span>                       (long) entry_call_recursion_depth,</div>
<div class="line"><span class="lineno"> 1038</span>                       (void *) entry_curr_thread,</div>
<div class="line"><span class="lineno"> 1039</span>                       (long) entry_thread_state));</div>
<div class="line"><span class="lineno"> 1040</span> </div>
<div class="line"><span class="lineno"> 1041</span>    old_jmpbuf_ptr = thr-&gt;heap-&gt;lj.jmpbuf_ptr;</div>
<div class="line"><span class="lineno"> 1042</span>    thr-&gt;heap-&gt;lj.jmpbuf_ptr = &amp;our_jmpbuf;</div>
<div class="line"><span class="lineno"> 1043</span> </div>
<div class="line"><span class="lineno"> 1044</span><span class="preprocessor">#if defined(DUK_USE_CPP_EXCEPTIONS)</span></div>
<div class="line"><span class="lineno"> 1045</span>    <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno"> 1046</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno"> 1047</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(thr-&gt;heap-&gt;lj.jmpbuf_ptr == &amp;our_jmpbuf);</div>
<div class="line"><span class="lineno"> 1048</span>    <span class="keywordflow">if</span> (<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a16d8b2e4e6566e43c4236e756d22708c">DUK_SETJMP</a>(our_jmpbuf.<a class="code hl_variable" href="structduk__jmpbuf.html#ad11371f3d85f3ca95db9d85285ea532f">jb</a>) == 0) {</div>
<div class="line"><span class="lineno"> 1049</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1050</span>        <span class="comment">/* Call handling and success path.  Success path exit cleans</span></div>
<div class="line"><span class="lineno"> 1051</span><span class="comment">         * up almost all state.</span></div>
<div class="line"><span class="lineno"> 1052</span><span class="comment">         */</span></div>
<div class="line"><span class="lineno"> 1053</span>        <a class="code hl_function" href="#a6f05358775a8df038c9b0850c9e3f8a9">duk__handle_call_inner</a>(thr, num_stack_args, call_flags, idx_func);</div>
<div class="line"><span class="lineno"> 1054</span> </div>
<div class="line"><span class="lineno"> 1055</span>        <span class="comment">/* Success path handles */</span></div>
<div class="line"><span class="lineno"> 1056</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(thr-&gt;heap-&gt;call_recursion_depth == entry_call_recursion_depth);</div>
<div class="line"><span class="lineno"> 1057</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(thr-&gt;ptr_curr_pc == entry_ptr_curr_pc);</div>
<div class="line"><span class="lineno"> 1058</span> </div>
<div class="line"><span class="lineno"> 1059</span>        <span class="comment">/* Longjmp state is kept clean in success path */</span></div>
<div class="line"><span class="lineno"> 1060</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(thr-&gt;heap-&gt;lj.type == <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a6af5993d9334f7a01bbc1219671ca5ea">DUK_LJ_TYPE_UNKNOWN</a>);</div>
<div class="line"><span class="lineno"> 1061</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(thr-&gt;heap-&gt;lj.iserror == 0);</div>
<div class="line"><span class="lineno"> 1062</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a3a3a2905176249b3cb6415b5ae814b31">DUK_TVAL_IS_UNDEFINED</a>(&amp;thr-&gt;heap-&gt;lj.value1));</div>
<div class="line"><span class="lineno"> 1063</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a3a3a2905176249b3cb6415b5ae814b31">DUK_TVAL_IS_UNDEFINED</a>(&amp;thr-&gt;heap-&gt;lj.value2));</div>
<div class="line"><span class="lineno"> 1064</span> </div>
<div class="line"><span class="lineno"> 1065</span>        thr-&gt;heap-&gt;lj.jmpbuf_ptr = old_jmpbuf_ptr;</div>
<div class="line"><span class="lineno"> 1066</span> </div>
<div class="line"><span class="lineno"> 1067</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8h.html#a7123906cbc5b26f0933e2d473383461a">DUK_EXEC_SUCCESS</a>;</div>
<div class="line"><span class="lineno"> 1068</span><span class="preprocessor">#if defined(DUK_USE_CPP_EXCEPTIONS)</span></div>
<div class="line"><span class="lineno"> 1069</span>    } <span class="keywordflow">catch</span> (duk_internal_exception &amp;exc) {</div>
<div class="line"><span class="lineno"> 1070</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno"> 1071</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1072</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1073</span>        <span class="comment">/* Error; error value is in heap-&gt;lj.value1. */</span></div>
<div class="line"><span class="lineno"> 1074</span> </div>
<div class="line"><span class="lineno"> 1075</span><span class="preprocessor">#if defined(DUK_USE_CPP_EXCEPTIONS)</span></div>
<div class="line"><span class="lineno"> 1076</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a9170138f330dbcaabfae9d2c59cc9684">DUK_UNREF</a>(exc);</div>
<div class="line"><span class="lineno"> 1077</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1078</span> </div>
<div class="line"><span class="lineno"> 1079</span>        <a class="code hl_function" href="#a728ed96bb1fd8bfc94187cd3cb49c369">duk__handle_call_error</a>(thr,</div>
<div class="line"><span class="lineno"> 1080</span>                               entry_valstack_bottom_index,</div>
<div class="line"><span class="lineno"> 1081</span>                               entry_valstack_end,</div>
<div class="line"><span class="lineno"> 1082</span>                               entry_catchstack_top,</div>
<div class="line"><span class="lineno"> 1083</span>                               entry_callstack_top,</div>
<div class="line"><span class="lineno"> 1084</span>                               entry_call_recursion_depth,</div>
<div class="line"><span class="lineno"> 1085</span>                               entry_curr_thread,</div>
<div class="line"><span class="lineno"> 1086</span>                               entry_thread_state,</div>
<div class="line"><span class="lineno"> 1087</span>                               entry_ptr_curr_pc,</div>
<div class="line"><span class="lineno"> 1088</span>                               idx_func,</div>
<div class="line"><span class="lineno"> 1089</span>                               old_jmpbuf_ptr);</div>
<div class="line"><span class="lineno"> 1090</span> </div>
<div class="line"><span class="lineno"> 1091</span>        <span class="comment">/* Longjmp state is cleaned up by error handling */</span></div>
<div class="line"><span class="lineno"> 1092</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(thr-&gt;heap-&gt;lj.type == <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a6af5993d9334f7a01bbc1219671ca5ea">DUK_LJ_TYPE_UNKNOWN</a>);</div>
<div class="line"><span class="lineno"> 1093</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(thr-&gt;heap-&gt;lj.iserror == 0);</div>
<div class="line"><span class="lineno"> 1094</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a3a3a2905176249b3cb6415b5ae814b31">DUK_TVAL_IS_UNDEFINED</a>(&amp;thr-&gt;heap-&gt;lj.value1));</div>
<div class="line"><span class="lineno"> 1095</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a3a3a2905176249b3cb6415b5ae814b31">DUK_TVAL_IS_UNDEFINED</a>(&amp;thr-&gt;heap-&gt;lj.value2));</div>
<div class="line"><span class="lineno"> 1096</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8h.html#ad03594743a742c4d13f298f7bebea22c">DUK_EXEC_ERROR</a>;</div>
<div class="line"><span class="lineno"> 1097</span>    }</div>
<div class="line"><span class="lineno"> 1098</span><span class="preprocessor">#if defined(DUK_USE_CPP_EXCEPTIONS)</span></div>
<div class="line"><span class="lineno"> 1099</span>    <span class="keywordflow">catch</span> (std::exception &amp;exc) {</div>
<div class="line"><span class="lineno"> 1100</span>        <span class="keyword">const</span> <span class="keywordtype">char</span> *what = exc.what();</div>
<div class="line"><span class="lineno"> 1101</span>        <span class="keywordflow">if</span> (!what) {</div>
<div class="line"><span class="lineno"> 1102</span>            what = <span class="stringliteral">&quot;unknown&quot;</span>;</div>
<div class="line"><span class="lineno"> 1103</span>        }</div>
<div class="line"><span class="lineno"> 1104</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a9e1528b8eb0a41bc4b37a09a77961e6c">DUK_D</a>(<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a50dbac8614f67a4a6d575791664ebc07">DUK_DPRINT</a>(<span class="stringliteral">&quot;unexpected c++ std::exception (perhaps thrown by user code)&quot;</span>));</div>
<div class="line"><span class="lineno"> 1105</span>        <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno"> 1106</span>            <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#af27bb9bfb183631e8c068865a8270012">DUK_ERROR_FMT1</a>(thr, <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8h.html#a7d71ae54be4b37d9b6d1141a51636a38">DUK_ERR_API_ERROR</a>, <span class="stringliteral">&quot;caught invalid c++ std::exception &#39;%s&#39; (perhaps thrown by user code)&quot;</span>, what);</div>
<div class="line"><span class="lineno"> 1107</span>        } <span class="keywordflow">catch</span> (duk_internal_exception exc) {</div>
<div class="line"><span class="lineno"> 1108</span>            <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a9e1528b8eb0a41bc4b37a09a77961e6c">DUK_D</a>(<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a50dbac8614f67a4a6d575791664ebc07">DUK_DPRINT</a>(<span class="stringliteral">&quot;caught api error thrown from unexpected c++ std::exception&quot;</span>));</div>
<div class="line"><span class="lineno"> 1109</span>            <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a9170138f330dbcaabfae9d2c59cc9684">DUK_UNREF</a>(exc);</div>
<div class="line"><span class="lineno"> 1110</span>            <a class="code hl_function" href="#a728ed96bb1fd8bfc94187cd3cb49c369">duk__handle_call_error</a>(thr,</div>
<div class="line"><span class="lineno"> 1111</span>                                   entry_valstack_bottom_index,</div>
<div class="line"><span class="lineno"> 1112</span>                                   entry_valstack_end,</div>
<div class="line"><span class="lineno"> 1113</span>                                   entry_catchstack_top,</div>
<div class="line"><span class="lineno"> 1114</span>                                   entry_callstack_top,</div>
<div class="line"><span class="lineno"> 1115</span>                                   entry_call_recursion_depth,</div>
<div class="line"><span class="lineno"> 1116</span>                                   entry_curr_thread,</div>
<div class="line"><span class="lineno"> 1117</span>                                   entry_thread_state,</div>
<div class="line"><span class="lineno"> 1118</span>                                   entry_ptr_curr_pc,</div>
<div class="line"><span class="lineno"> 1119</span>                                   idx_func,</div>
<div class="line"><span class="lineno"> 1120</span>                                   old_jmpbuf_ptr);</div>
<div class="line"><span class="lineno"> 1121</span>            <span class="keywordflow">return</span> <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8h.html#ad03594743a742c4d13f298f7bebea22c">DUK_EXEC_ERROR</a>;</div>
<div class="line"><span class="lineno"> 1122</span>        }</div>
<div class="line"><span class="lineno"> 1123</span>    } <span class="keywordflow">catch</span> (...) {</div>
<div class="line"><span class="lineno"> 1124</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a9e1528b8eb0a41bc4b37a09a77961e6c">DUK_D</a>(<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a50dbac8614f67a4a6d575791664ebc07">DUK_DPRINT</a>(<span class="stringliteral">&quot;unexpected c++ exception (perhaps thrown by user code)&quot;</span>));</div>
<div class="line"><span class="lineno"> 1125</span>        <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno"> 1126</span>            <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a5d7ecc05e08a0af8396793c7d6d9d916">DUK_ERROR_API</a>(thr, <span class="stringliteral">&quot;caught invalid c++ exception (perhaps thrown by user code)&quot;</span>);</div>
<div class="line"><span class="lineno"> 1127</span>        } <span class="keywordflow">catch</span> (duk_internal_exception exc) {</div>
<div class="line"><span class="lineno"> 1128</span>            <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a9e1528b8eb0a41bc4b37a09a77961e6c">DUK_D</a>(<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a50dbac8614f67a4a6d575791664ebc07">DUK_DPRINT</a>(<span class="stringliteral">&quot;caught api error thrown from unexpected c++ exception&quot;</span>));</div>
<div class="line"><span class="lineno"> 1129</span>            <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a9170138f330dbcaabfae9d2c59cc9684">DUK_UNREF</a>(exc);</div>
<div class="line"><span class="lineno"> 1130</span>            <a class="code hl_function" href="#a728ed96bb1fd8bfc94187cd3cb49c369">duk__handle_call_error</a>(thr,</div>
<div class="line"><span class="lineno"> 1131</span>                                   entry_valstack_bottom_index,</div>
<div class="line"><span class="lineno"> 1132</span>                                   entry_valstack_end,</div>
<div class="line"><span class="lineno"> 1133</span>                                   entry_catchstack_top,</div>
<div class="line"><span class="lineno"> 1134</span>                                   entry_callstack_top,</div>
<div class="line"><span class="lineno"> 1135</span>                                   entry_call_recursion_depth,</div>
<div class="line"><span class="lineno"> 1136</span>                                   entry_curr_thread,</div>
<div class="line"><span class="lineno"> 1137</span>                                   entry_thread_state,</div>
<div class="line"><span class="lineno"> 1138</span>                                   entry_ptr_curr_pc,</div>
<div class="line"><span class="lineno"> 1139</span>                                   idx_func,</div>
<div class="line"><span class="lineno"> 1140</span>                                   old_jmpbuf_ptr);</div>
<div class="line"><span class="lineno"> 1141</span>            <span class="keywordflow">return</span> <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8h.html#ad03594743a742c4d13f298f7bebea22c">DUK_EXEC_ERROR</a>;</div>
<div class="line"><span class="lineno"> 1142</span>        }</div>
<div class="line"><span class="lineno"> 1143</span>    }</div>
<div class="line"><span class="lineno"> 1144</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1145</span>}</div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duk__config_8h_html_a16d8b2e4e6566e43c4236e756d22708c"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a16d8b2e4e6566e43c4236e756d22708c">DUK_SETJMP</a></div><div class="ttdeci">#define DUK_SETJMP(jb)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duk__config_8h_source.html#l01917">duktape-1.5.2/src-noline/duk_config.h:1917</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_a3a3a2905176249b3cb6415b5ae814b31"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#a3a3a2905176249b3cb6415b5ae814b31">DUK_TVAL_IS_UNDEFINED</a></div><div class="ttdeci">#define DUK_TVAL_IS_UNDEFINED(tv)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l00793">duktape-1.5.2/src-noline/duktape.c:793</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8h_html_a7123906cbc5b26f0933e2d473383461a"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8h.html#a7123906cbc5b26f0933e2d473383461a">DUK_EXEC_SUCCESS</a></div><div class="ttdeci">#define DUK_EXEC_SUCCESS</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8h_source.html#l00365">duktape-1.5.2/src-noline/duktape.h:365</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8h_html_a7d71ae54be4b37d9b6d1141a51636a38"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8h.html#a7d71ae54be4b37d9b6d1141a51636a38">DUK_ERR_API_ERROR</a></div><div class="ttdeci">#define DUK_ERR_API_ERROR</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8h_source.html#l00336">duktape-1.5.2/src-noline/duktape.h:336</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8h_html_ad03594743a742c4d13f298f7bebea22c"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8h.html#ad03594743a742c4d13f298f7bebea22c">DUK_EXEC_ERROR</a></div><div class="ttdeci">#define DUK_EXEC_ERROR</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8h_source.html#l00366">duktape-1.5.2/src-noline/duktape.h:366</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-separate_2duk__js__call_8c_html_a0ee6d00b24673db60bd1f2df3700c1e2"><div class="ttname"><a href="#a0ee6d00b24673db60bd1f2df3700c1e2">duk__get_idx_func</a></div><div class="ttdeci">DUK_LOCAL duk_idx_t duk__get_idx_func(duk_hthread *thr, duk_idx_t num_stack_args)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-separate_2duk__js__call_8c_source.html#l00922">duktape-1.5.2/src-separate/duk_js_call.c:922</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-separate_2duk__js__call_8c_html_a6f05358775a8df038c9b0850c9e3f8a9"><div class="ttname"><a href="#a6f05358775a8df038c9b0850c9e3f8a9">duk__handle_call_inner</a></div><div class="ttdeci">DUK_LOCAL void duk__handle_call_inner(duk_hthread *thr, duk_idx_t num_stack_args, duk_small_uint_t call_flags, duk_idx_t idx_func)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-separate_2duk__js__call_8c_source.html#l01158">duktape-1.5.2/src-separate/duk_js_call.c:1158</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-separate_2duk__js__call_8c_html_a728ed96bb1fd8bfc94187cd3cb49c369"><div class="ttname"><a href="#a728ed96bb1fd8bfc94187cd3cb49c369">duk__handle_call_error</a></div><div class="ttdeci">DUK_LOCAL void duk__handle_call_error(duk_hthread *thr, duk_size_t entry_valstack_bottom_index, duk_size_t entry_valstack_end, duk_size_t entry_catchstack_top, duk_size_t entry_callstack_top, duk_int_t entry_call_recursion_depth, duk_hthread *entry_curr_thread, duk_uint_fast8_t entry_thread_state, duk_instr_t **entry_ptr_curr_pc, duk_idx_t idx_func, duk_jmpbuf *old_jmpbuf_ptr)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-separate_2duk__js__call_8c_source.html#l01733">duktape-1.5.2/src-separate/duk_js_call.c:1733</a></div></div>
<div class="ttc" id="astructduk__jmpbuf_html"><div class="ttname"><a href="structduk__jmpbuf.html">duk_jmpbuf</a></div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l00205">duktape-1.5.2/src-noline/duktape.c:205</a></div></div>
<div class="ttc" id="astructduk__jmpbuf_html_ad11371f3d85f3ca95db9d85285ea532f"><div class="ttname"><a href="structduk__jmpbuf.html#ad11371f3d85f3ca95db9d85285ea532f">duk_jmpbuf::jb</a></div><div class="ttdeci">DUK_JMPBUF_TYPE jb</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l00206">duktape-1.5.2/src-noline/duktape.c:206</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07050">duk_heap::call_recursion_depth</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07051">duk_heap::call_recursion_limit</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06235">duk_hthread::callstack</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06237">duk_hthread::callstack_top</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06241">duk_hthread::catchstack</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06243">duk_hthread::catchstack_top</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07044">duk_heap::curr_thread</a>, <a class="el" href="duktape-1_85_82_2src-separate_2duk__js__call_8c_source.html#l00922">duk__get_idx_func()</a>, <a class="el" href="duktape-1_85_82_2src-separate_2duk__js__call_8c_source.html#l01733">duk__handle_call_error()</a>, <a class="el" href="duktape-1_85_82_2src-separate_2duk__js__call_8c_source.html#l01158">duk__handle_call_inner()</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07755">DUK_ASSERT</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06106">DUK_ASSERT_CTX_VALID</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l08344">DUK_CALL_FLAG_CONSTRUCTOR_CALL</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l08343">DUK_CALL_FLAG_IGNORE_RECLIMIT</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07495">DUK_D</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07496">DUK_DD</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07508">DUK_DDPRINT</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07507">DUK_DPRINT</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8h_source.html#l00336">DUK_ERR_API_ERROR</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07869">DUK_ERROR_API</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07628">DUK_ERROR_FMT1</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8h_source.html#l00366">DUK_EXEC_ERROR</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8h_source.html#l00365">DUK_EXEC_SUCCESS</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l15204">duk_get_top()</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06701">DUK_LJ_TYPE_UNKNOWN</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h_source.html#l01917">DUK_SETJMP</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l00793">DUK_TVAL_IS_UNDEFINED</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h_source.html#l02494">DUK_UNREF</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06202">duk_hthread::heap</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06950">duk_ljstate::iserror</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l00206">duk_jmpbuf::jb</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06948">duk_ljstate::jmpbuf_ptr</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07035">duk_heap::lj</a>, <a class="el" href="gmacros_8h_source.html#l00924">NULL</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06199">duk_hthread::ptr_curr_pc</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06208">duk_hthread::state</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06949">duk_ljstate::type</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06226">duk_hthread::valstack</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06228">duk_hthread::valstack_bottom</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06227">duk_hthread::valstack_end</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06231">duk_hthread::valstack_size</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06951">duk_ljstate::value1</a>, and <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06952">duk_ljstate::value2</a>.</p>

</div>
</div>
<a id="a828d82423579a3d373d2154002fee4f2" name="a828d82423579a3d373d2154002fee4f2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a828d82423579a3d373d2154002fee4f2">&#9670;&#160;</a></span>duk_handle_call_unprotected()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a19032f251b36af6bfb17f4450b829521">DUK_INTERNAL</a> void duk_handle_call_unprotected </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structduk__hthread.html">duk_hthread</a> *</td>          <td class="paramname"><span class="paramname"><em>thr</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a3e3bb369382aab50155c1d18bdf73923">duk_idx_t</a></td>          <td class="paramname"><span class="paramname"><em>num_stack_args</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a2b7ba45bf826058a9b7720b5e258efc6">duk_small_uint_t</a></td>          <td class="paramname"><span class="paramname"><em>call_flags</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="duktape-1_85_82_2src-separate_2duk__js__call_8c_source.html#l01147">1147</a> of file <a class="el" href="duktape-1_85_82_2src-separate_2duk__js__call_8c_source.html">duktape-1.5.2/src-separate/duk_js_call.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1149</span>                                                                           {</div>
<div class="line"><span class="lineno"> 1150</span>    <a class="code hl_typedef" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a3e3bb369382aab50155c1d18bdf73923">duk_idx_t</a> idx_func;         <span class="comment">/* valstack index of &#39;func&#39; and retval (relative to entry valstack_bottom) */</span></div>
<div class="line"><span class="lineno"> 1151</span> </div>
<div class="line"><span class="lineno"> 1152</span>    <span class="comment">/* Argument validation and func/args offset. */</span></div>
<div class="line"><span class="lineno"> 1153</span>    idx_func = <a class="code hl_function" href="#a0ee6d00b24673db60bd1f2df3700c1e2">duk__get_idx_func</a>(thr, num_stack_args);</div>
<div class="line"><span class="lineno"> 1154</span> </div>
<div class="line"><span class="lineno"> 1155</span>    <a class="code hl_function" href="#a6f05358775a8df038c9b0850c9e3f8a9">duk__handle_call_inner</a>(thr, num_stack_args, call_flags, idx_func);</div>
<div class="line"><span class="lineno"> 1156</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="duktape-1_85_82_2src-separate_2duk__js__call_8c_source.html#l00922">duk__get_idx_func()</a>, and <a class="el" href="duktape-1_85_82_2src-separate_2duk__js__call_8c_source.html#l01158">duk__handle_call_inner()</a>.</p>

</div>
</div>
<a id="aec1da61a0d8f9fed5d5e08e0e950f69b" name="aec1da61a0d8f9fed5d5e08e0e950f69b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aec1da61a0d8f9fed5d5e08e0e950f69b">&#9670;&#160;</a></span>duk_handle_ecma_call_setup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a19032f251b36af6bfb17f4450b829521">DUK_INTERNAL</a> <a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#af32ca4c30431e819676401ce2b11c2e7">duk_bool_t</a> duk_handle_ecma_call_setup </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structduk__hthread.html">duk_hthread</a> *</td>          <td class="paramname"><span class="paramname"><em>thr</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a3e3bb369382aab50155c1d18bdf73923">duk_idx_t</a></td>          <td class="paramname"><span class="paramname"><em>num_stack_args</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a2b7ba45bf826058a9b7720b5e258efc6">duk_small_uint_t</a></td>          <td class="paramname"><span class="paramname"><em>call_flags</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="duktape-1_85_82_2src-separate_2duk__js__call_8c_source.html#l02290">2290</a> of file <a class="el" href="duktape-1_85_82_2src-separate_2duk__js__call_8c_source.html">duktape-1.5.2/src-separate/duk_js_call.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2292</span>                                                                                {</div>
<div class="line"><span class="lineno"> 2293</span>    <a class="code hl_struct" href="structduk__hthread.html">duk_context</a> *ctx = (<a class="code hl_struct" href="structduk__hthread.html">duk_context</a> *) thr;</div>
<div class="line"><span class="lineno"> 2294</span>    <a class="code hl_typedef" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#ab0a71934d59f38f195fea2f353032392">duk_size_t</a> entry_valstack_bottom_index;</div>
<div class="line"><span class="lineno"> 2295</span>    <a class="code hl_typedef" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a3e3bb369382aab50155c1d18bdf73923">duk_idx_t</a> idx_func;     <span class="comment">/* valstack index of &#39;func&#39; and retval (relative to entry valstack_bottom) */</span></div>
<div class="line"><span class="lineno"> 2296</span>    <a class="code hl_typedef" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a3e3bb369382aab50155c1d18bdf73923">duk_idx_t</a> idx_args;     <span class="comment">/* valstack index of start of args (arg1) (relative to entry valstack_bottom) */</span></div>
<div class="line"><span class="lineno"> 2297</span>    <a class="code hl_typedef" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a3e3bb369382aab50155c1d18bdf73923">duk_idx_t</a> nargs;        <span class="comment">/* # argument registers target function wants (&lt; 0 =&gt; never for ecma calls) */</span></div>
<div class="line"><span class="lineno"> 2298</span>    <a class="code hl_typedef" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a3e3bb369382aab50155c1d18bdf73923">duk_idx_t</a> nregs;        <span class="comment">/* # total registers target function wants on entry (&lt; 0 =&gt; never for ecma calls) */</span></div>
<div class="line"><span class="lineno"> 2299</span>    <a class="code hl_struct" href="structduk__hobject.html">duk_hobject</a> *func;      <span class="comment">/* &#39;func&#39; on stack (borrowed reference) */</span></div>
<div class="line"><span class="lineno"> 2300</span>    <a class="code hl_struct" href="structduk__tval__struct.html">duk_tval</a> *tv_func;      <span class="comment">/* duk_tval ptr for &#39;func&#39; on stack (borrowed reference) */</span></div>
<div class="line"><span class="lineno"> 2301</span>    <a class="code hl_struct" href="structduk__activation.html">duk_activation</a> *act;</div>
<div class="line"><span class="lineno"> 2302</span>    <a class="code hl_struct" href="structduk__hobject.html">duk_hobject</a> *env;</div>
<div class="line"><span class="lineno"> 2303</span>    <a class="code hl_typedef" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#af32ca4c30431e819676401ce2b11c2e7">duk_bool_t</a> use_tailcall;</div>
<div class="line"><span class="lineno"> 2304</span>    <a class="code hl_typedef" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a9231b6cd154afc387b6282e9bb8e0c6e">duk_instr_t</a> **entry_ptr_curr_pc;</div>
<div class="line"><span class="lineno"> 2305</span> </div>
<div class="line"><span class="lineno"> 2306</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(thr != <a class="code hl_define" href="gmacros_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><span class="lineno"> 2307</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(ctx != <a class="code hl_define" href="gmacros_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><span class="lineno"> 2308</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(!((call_flags &amp; <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a5d41683dbaef0b87ef339c9dde7f25d5">DUK_CALL_FLAG_IS_RESUME</a>) != 0 &amp;&amp; (call_flags &amp; <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a5ea271115bcee754393f93970eb705a8">DUK_CALL_FLAG_IS_TAILCALL</a>) != 0));</div>
<div class="line"><span class="lineno"> 2309</span> </div>
<div class="line"><span class="lineno"> 2310</span>    <span class="comment">/* XXX: assume these? */</span></div>
<div class="line"><span class="lineno"> 2311</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#a08f58ff5b9fa5927891c2e08712e3971">valstack</a> != <a class="code hl_define" href="gmacros_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><span class="lineno"> 2312</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#ac03631b2f8ff5bab23d409f0bb966579">callstack</a> != <a class="code hl_define" href="gmacros_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><span class="lineno"> 2313</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#af6ad1a5c8500ffe6443be8fec677a775">catchstack</a> != <a class="code hl_define" href="gmacros_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><span class="lineno"> 2314</span> </div>
<div class="line"><span class="lineno"> 2315</span>    <span class="comment">/* no need to handle thread state book-keeping here */</span></div>
<div class="line"><span class="lineno"> 2316</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>((call_flags &amp; <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a5d41683dbaef0b87ef339c9dde7f25d5">DUK_CALL_FLAG_IS_RESUME</a>) != 0 ||</div>
<div class="line"><span class="lineno"> 2317</span>               (thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#a4dc5dc48406aa6240185468557d154dc">state</a> == <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a82ed1e61fa4a768cbc65401274bfd89a">DUK_HTHREAD_STATE_RUNNING</a> &amp;&amp;</div>
<div class="line"><span class="lineno"> 2318</span>                thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#a1c6d2e1f36b0b7011f0e52343ca5ed05">heap</a>-&gt;<a class="code hl_variable" href="structduk__heap.html#a1f913439bf8af92c753891bea8abda78">curr_thread</a> == thr));</div>
<div class="line"><span class="lineno"> 2319</span> </div>
<div class="line"><span class="lineno"> 2320</span>    <span class="comment">/* If thr-&gt;ptr_curr_pc is set, sync curr_pc to act-&gt;pc.  Then NULL</span></div>
<div class="line"><span class="lineno"> 2321</span><span class="comment">     * thr-&gt;ptr_curr_pc so that it&#39;s not accidentally used with an incorrect</span></div>
<div class="line"><span class="lineno"> 2322</span><span class="comment">     * activation when side effects occur.  If we end up not making the</span></div>
<div class="line"><span class="lineno"> 2323</span><span class="comment">     * call we must restore the value.</span></div>
<div class="line"><span class="lineno"> 2324</span><span class="comment">     */</span></div>
<div class="line"><span class="lineno"> 2325</span>    entry_ptr_curr_pc = thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#a9ceabe6e4ac27d8e61e8f33d4eab55a6">ptr_curr_pc</a>;</div>
<div class="line"><span class="lineno"> 2326</span>    <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a8cee88ae1401c33134400aa455dd6754">duk_hthread_sync_and_null_currpc</a>(thr);</div>
<div class="line"><span class="lineno"> 2327</span> </div>
<div class="line"><span class="lineno"> 2328</span>    <span class="comment">/* if a tail call:</span></div>
<div class="line"><span class="lineno"> 2329</span><span class="comment">     *   - an Ecmascript activation must be on top of the callstack</span></div>
<div class="line"><span class="lineno"> 2330</span><span class="comment">     *   - there cannot be any active catchstack entries</span></div>
<div class="line"><span class="lineno"> 2331</span><span class="comment">     */</span></div>
<div class="line"><span class="lineno"> 2332</span><span class="preprocessor">#if defined(DUK_USE_ASSERTIONS)</span></div>
<div class="line"><span class="lineno"> 2333</span>    <span class="keywordflow">if</span> (call_flags &amp; <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a5ea271115bcee754393f93970eb705a8">DUK_CALL_FLAG_IS_TAILCALL</a>) {</div>
<div class="line"><span class="lineno"> 2334</span>        <a class="code hl_typedef" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#ab0a71934d59f38f195fea2f353032392">duk_size_t</a> our_callstack_index;</div>
<div class="line"><span class="lineno"> 2335</span>        <a class="code hl_typedef" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#ab0a71934d59f38f195fea2f353032392">duk_size_t</a> i;</div>
<div class="line"><span class="lineno"> 2336</span> </div>
<div class="line"><span class="lineno"> 2337</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#aea2cca88da9187f43fb2b925ef7f5ee4">callstack_top</a> &gt;= 1);</div>
<div class="line"><span class="lineno"> 2338</span>        our_callstack_index = thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#aea2cca88da9187f43fb2b925ef7f5ee4">callstack_top</a> - 1;</div>
<div class="line"><span class="lineno"> 2339</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a5b32dd67a8481ffa404a403c0cfac2a6">DUK_ASSERT_DISABLE</a>(our_callstack_index &gt;= 0);</div>
<div class="line"><span class="lineno"> 2340</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(our_callstack_index &lt; thr-&gt;callstack_size);</div>
<div class="line"><span class="lineno"> 2341</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#ac80b8c05792b926d22f8c540f947ebbe">DUK_ACT_GET_FUNC</a>(thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#ac03631b2f8ff5bab23d409f0bb966579">callstack</a> + our_callstack_index) != <a class="code hl_define" href="gmacros_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><span class="lineno"> 2342</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a3b446d4cd53f63e5e57b80041eb0d598">DUK_HOBJECT_IS_COMPILEDFUNCTION</a>(<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#ac80b8c05792b926d22f8c540f947ebbe">DUK_ACT_GET_FUNC</a>(thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#ac03631b2f8ff5bab23d409f0bb966579">callstack</a> + our_callstack_index)));</div>
<div class="line"><span class="lineno"> 2343</span> </div>
<div class="line"><span class="lineno"> 2344</span>        <span class="comment">/* No entry in the catchstack which would actually catch a</span></div>
<div class="line"><span class="lineno"> 2345</span><span class="comment">         * throw can refer to the callstack entry being reused.</span></div>
<div class="line"><span class="lineno"> 2346</span><span class="comment">         * There *can* be catchstack entries referring to the current</span></div>
<div class="line"><span class="lineno"> 2347</span><span class="comment">         * callstack entry as long as they don&#39;t catch (e.g. label sites).</span></div>
<div class="line"><span class="lineno"> 2348</span><span class="comment">         */</span></div>
<div class="line"><span class="lineno"> 2349</span> </div>
<div class="line"><span class="lineno"> 2350</span>        <span class="keywordflow">for</span> (i = 0; i &lt; thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#a52794290185255eb48736c942b07ae04">catchstack_top</a>; i++) {</div>
<div class="line"><span class="lineno"> 2351</span>            <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#af6ad1a5c8500ffe6443be8fec677a775">catchstack</a>[i].<a class="code hl_variable" href="structduk__catcher.html#a763bb99edea7d1d2eab211ae8385686e">callstack_index</a> &lt; our_callstack_index ||  <span class="comment">/* refer to callstack entries below current */</span></div>
<div class="line"><span class="lineno"> 2352</span>                       <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a1bd6d3ebc3d91f85beab0259b6041b93">DUK_CAT_GET_TYPE</a>(thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#af6ad1a5c8500ffe6443be8fec677a775">catchstack</a> + i) == <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#ad887c26e460c0a88e8d3c5112feee7b1">DUK_CAT_TYPE_LABEL</a>); <span class="comment">/* or a non-catching entry */</span></div>
<div class="line"><span class="lineno"> 2353</span>        }</div>
<div class="line"><span class="lineno"> 2354</span>    }</div>
<div class="line"><span class="lineno"> 2355</span><span class="preprocessor">#endif  </span><span class="comment">/* DUK_USE_ASSERTIONS */</span><span class="preprocessor"></span></div>
<div class="line"><span class="lineno"> 2356</span> </div>
<div class="line"><span class="lineno"> 2357</span>    entry_valstack_bottom_index = (<a class="code hl_typedef" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#ab0a71934d59f38f195fea2f353032392">duk_size_t</a>) (thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#ad39b6c03b81eb0f4d3eefda5083988d3">valstack_bottom</a> - thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#a08f58ff5b9fa5927891c2e08712e3971">valstack</a>);</div>
<div class="line"><span class="lineno"> 2358</span>    <span class="comment">/* XXX: rework */</span></div>
<div class="line"><span class="lineno"> 2359</span>    idx_func = <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a0e99de287978113056ce5b0a1984d49b">duk_normalize_index</a>(thr, -num_stack_args - 2);</div>
<div class="line"><span class="lineno"> 2360</span>    idx_args = idx_func + 2;</div>
<div class="line"><span class="lineno"> 2361</span> </div>
<div class="line"><span class="lineno"> 2362</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a6c3a2adb6e09294c7e65f69821e5e81a">DUK_DD</a>(<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#aa66ca9adc2b4187c5d549a9b117b03d3">DUK_DDPRINT</a>(<span class="stringliteral">&quot;handle_ecma_call_setup: thr=%p, &quot;</span></div>
<div class="line"><span class="lineno"> 2363</span>                       <span class="stringliteral">&quot;num_stack_args=%ld, call_flags=0x%08lx (resume=%ld, tailcall=%ld), &quot;</span></div>
<div class="line"><span class="lineno"> 2364</span>                       <span class="stringliteral">&quot;idx_func=%ld, idx_args=%ld, entry_valstack_bottom_index=%ld&quot;</span>,</div>
<div class="line"><span class="lineno"> 2365</span>                       (<span class="keywordtype">void</span> *) thr,</div>
<div class="line"><span class="lineno"> 2366</span>                       (<span class="keywordtype">long</span>) num_stack_args,</div>
<div class="line"><span class="lineno"> 2367</span>                       (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>) call_flags,</div>
<div class="line"><span class="lineno"> 2368</span>                       (<span class="keywordtype">long</span>) ((call_flags &amp; <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a5d41683dbaef0b87ef339c9dde7f25d5">DUK_CALL_FLAG_IS_RESUME</a>) != 0 ? 1 : 0),</div>
<div class="line"><span class="lineno"> 2369</span>                       (long) ((call_flags &amp; <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a5ea271115bcee754393f93970eb705a8">DUK_CALL_FLAG_IS_TAILCALL</a>) != 0 ? 1 : 0),</div>
<div class="line"><span class="lineno"> 2370</span>                       (long) idx_func,</div>
<div class="line"><span class="lineno"> 2371</span>                       (long) idx_args,</div>
<div class="line"><span class="lineno"> 2372</span>                       (long) entry_valstack_bottom_index));</div>
<div class="line"><span class="lineno"> 2373</span> </div>
<div class="line"><span class="lineno"> 2374</span>    <span class="keywordflow">if</span> (<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a6615c9d227b3ed8f7a543fd8e3c5e4c9">DUK_UNLIKELY</a>(idx_func &lt; 0 || idx_args &lt; 0)) {</div>
<div class="line"><span class="lineno"> 2375</span>        <span class="comment">/* XXX: assert? compiler is responsible for this never happening */</span></div>
<div class="line"><span class="lineno"> 2376</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a5d7ecc05e08a0af8396793c7d6d9d916">DUK_ERROR_API</a>(thr, <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a2ff85cd89ea1baf8ab0f8bb7e010d9a5">DUK_STR_INVALID_CALL_ARGS</a>);</div>
<div class="line"><span class="lineno"> 2377</span>    }</div>
<div class="line"><span class="lineno"> 2378</span> </div>
<div class="line"><span class="lineno"> 2379</span>    <span class="comment">/*</span></div>
<div class="line"><span class="lineno"> 2380</span><span class="comment">     *  Check the function type, handle bound function chains, and prepare</span></div>
<div class="line"><span class="lineno"> 2381</span><span class="comment">     *  parameters for the rest of the call handling.  Also figure out the</span></div>
<div class="line"><span class="lineno"> 2382</span><span class="comment">     *  effective &#39;this&#39; binding, which replaces the current value at</span></div>
<div class="line"><span class="lineno"> 2383</span><span class="comment">     *  idx_func + 1.</span></div>
<div class="line"><span class="lineno"> 2384</span><span class="comment">     *</span></div>
<div class="line"><span class="lineno"> 2385</span><span class="comment">     *  If the target function is a &#39;bound&#39; one, follow the chain of &#39;bound&#39;</span></div>
<div class="line"><span class="lineno"> 2386</span><span class="comment">     *  functions until a non-bound function is found.  During this process,</span></div>
<div class="line"><span class="lineno"> 2387</span><span class="comment">     *  bound arguments are &#39;prepended&#39; to existing ones, and the &quot;this&quot;</span></div>
<div class="line"><span class="lineno"> 2388</span><span class="comment">     *  binding is overridden.  See E5 Section 15.3.4.5.1.</span></div>
<div class="line"><span class="lineno"> 2389</span><span class="comment">     *</span></div>
<div class="line"><span class="lineno"> 2390</span><span class="comment">     *  If the final target function cannot be handled by an ecma-to-ecma</span></div>
<div class="line"><span class="lineno"> 2391</span><span class="comment">     *  call, return to the caller with a return value indicating this case.</span></div>
<div class="line"><span class="lineno"> 2392</span><span class="comment">     *  The bound chain is resolved and the caller can resume with a plain</span></div>
<div class="line"><span class="lineno"> 2393</span><span class="comment">     *  function call.</span></div>
<div class="line"><span class="lineno"> 2394</span><span class="comment">     */</span></div>
<div class="line"><span class="lineno"> 2395</span> </div>
<div class="line"><span class="lineno"> 2396</span>    func = <a class="code hl_function" href="#a0d5042617a44a3204d4839319683aeb2">duk__nonbound_func_lookup</a>(ctx, idx_func, &amp;num_stack_args, &amp;tv_func, call_flags);</div>
<div class="line"><span class="lineno"> 2397</span>    <span class="keywordflow">if</span> (func == <a class="code hl_define" href="gmacros_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> || !<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a3b446d4cd53f63e5e57b80041eb0d598">DUK_HOBJECT_IS_COMPILEDFUNCTION</a>(func)) {</div>
<div class="line"><span class="lineno"> 2398</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a2db20d2d3b36d8491ed171cf503488bb">DUK_DDD</a>(<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#aa6e5d41ceaba6832e5ede737f0a35fb9">DUK_DDDPRINT</a>(<span class="stringliteral">&quot;final target is a lightfunc/nativefunc, cannot do ecma-to-ecma call&quot;</span>));</div>
<div class="line"><span class="lineno"> 2399</span>        thr-&gt;ptr_curr_pc = entry_ptr_curr_pc;</div>
<div class="line"><span class="lineno"> 2400</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 2401</span>    }</div>
<div class="line"><span class="lineno"> 2402</span>    <span class="comment">/* XXX: tv_func is not actually needed */</span></div>
<div class="line"><span class="lineno"> 2403</span> </div>
<div class="line"><span class="lineno"> 2404</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(func != <a class="code hl_define" href="gmacros_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><span class="lineno"> 2405</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(!<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a1405011142963f5c45c82eb2a881e385">DUK_HOBJECT_HAS_BOUND</a>(func));</div>
<div class="line"><span class="lineno"> 2406</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a3b446d4cd53f63e5e57b80041eb0d598">DUK_HOBJECT_IS_COMPILEDFUNCTION</a>(func));</div>
<div class="line"><span class="lineno"> 2407</span> </div>
<div class="line"><span class="lineno"> 2408</span>    <a class="code hl_function" href="#a08825b479944b1b525fe432f83bbe57e">duk__coerce_effective_this_binding</a>(thr, func, idx_func + 1);</div>
<div class="line"><span class="lineno"> 2409</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a2db20d2d3b36d8491ed171cf503488bb">DUK_DDD</a>(<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#aa6e5d41ceaba6832e5ede737f0a35fb9">DUK_DDDPRINT</a>(<span class="stringliteral">&quot;effective &#39;this&#39; binding is: %!T&quot;</span>,</div>
<div class="line"><span class="lineno"> 2410</span>                         <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#afa34aa8c7f880082f9de613ef2bc3c58">duk_get_tval</a>(ctx, idx_func + 1)));</div>
<div class="line"><span class="lineno"> 2411</span> </div>
<div class="line"><span class="lineno"> 2412</span>    nargs = ((<a class="code hl_struct" href="structduk__hcompiledfunction.html">duk_hcompiledfunction</a> *) func)-&gt;nargs;</div>
<div class="line"><span class="lineno"> 2413</span>    nregs = ((<a class="code hl_struct" href="structduk__hcompiledfunction.html">duk_hcompiledfunction</a> *) func)-&gt;nregs;</div>
<div class="line"><span class="lineno"> 2414</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(nregs &gt;= nargs);</div>
<div class="line"><span class="lineno"> 2415</span> </div>
<div class="line"><span class="lineno"> 2416</span>    <span class="comment">/* [ ... func this arg1 ... argN ] */</span></div>
<div class="line"><span class="lineno"> 2417</span> </div>
<div class="line"><span class="lineno"> 2418</span>    <span class="comment">/*</span></div>
<div class="line"><span class="lineno"> 2419</span><span class="comment">     *  Preliminary activation record and valstack manipulation.</span></div>
<div class="line"><span class="lineno"> 2420</span><span class="comment">     *  The concrete actions depend on whether the we&#39;re dealing</span></div>
<div class="line"><span class="lineno"> 2421</span><span class="comment">     *  with a tail call (reuse an existing activation), a resume,</span></div>
<div class="line"><span class="lineno"> 2422</span><span class="comment">     *  or a normal call.</span></div>
<div class="line"><span class="lineno"> 2423</span><span class="comment">     *</span></div>
<div class="line"><span class="lineno"> 2424</span><span class="comment">     *  The basic actions, in varying order, are:</span></div>
<div class="line"><span class="lineno"> 2425</span><span class="comment">     *</span></div>
<div class="line"><span class="lineno"> 2426</span><span class="comment">     *    - Check stack size for call handling</span></div>
<div class="line"><span class="lineno"> 2427</span><span class="comment">     *    - Grow call stack if necessary (non-tail-calls)</span></div>
<div class="line"><span class="lineno"> 2428</span><span class="comment">     *    - Update current activation (idx_retval) if necessary</span></div>
<div class="line"><span class="lineno"> 2429</span><span class="comment">     *      (non-tail, non-resume calls)</span></div>
<div class="line"><span class="lineno"> 2430</span><span class="comment">     *    - Move start of args (idx_args) to valstack bottom</span></div>
<div class="line"><span class="lineno"> 2431</span><span class="comment">     *      (tail calls)</span></div>
<div class="line"><span class="lineno"> 2432</span><span class="comment">     *</span></div>
<div class="line"><span class="lineno"> 2433</span><span class="comment">     *  Don&#39;t touch valstack_bottom or valstack_top yet so that Duktape API</span></div>
<div class="line"><span class="lineno"> 2434</span><span class="comment">     *  calls work normally.</span></div>
<div class="line"><span class="lineno"> 2435</span><span class="comment">     */</span></div>
<div class="line"><span class="lineno"> 2436</span> </div>
<div class="line"><span class="lineno"> 2437</span>    <span class="comment">/* XXX: some overlapping code; cleanup */</span></div>
<div class="line"><span class="lineno"> 2438</span>    use_tailcall = call_flags &amp; <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a5ea271115bcee754393f93970eb705a8">DUK_CALL_FLAG_IS_TAILCALL</a>;</div>
<div class="line"><span class="lineno"> 2439</span><span class="preprocessor">#if !defined(DUK_USE_TAILCALL)</span></div>
<div class="line"><span class="lineno"> 2440</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(use_tailcall == 0);  <span class="comment">/* compiler ensures this */</span></div>
<div class="line"><span class="lineno"> 2441</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 2442</span>    <span class="keywordflow">if</span> (use_tailcall) {</div>
<div class="line"><span class="lineno"> 2443</span>        <span class="comment">/* tailcall cannot be flagged to resume calls, and a</span></div>
<div class="line"><span class="lineno"> 2444</span><span class="comment">         * previous frame must exist</span></div>
<div class="line"><span class="lineno"> 2445</span><span class="comment">         */</span></div>
<div class="line"><span class="lineno"> 2446</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(thr-&gt;callstack_top &gt;= 1);</div>
<div class="line"><span class="lineno"> 2447</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>((call_flags &amp; <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a5d41683dbaef0b87ef339c9dde7f25d5">DUK_CALL_FLAG_IS_RESUME</a>) == 0);</div>
<div class="line"><span class="lineno"> 2448</span> </div>
<div class="line"><span class="lineno"> 2449</span>        act = thr-&gt;callstack + thr-&gt;callstack_top - 1;</div>
<div class="line"><span class="lineno"> 2450</span>        <span class="keywordflow">if</span> (act-&gt;<a class="code hl_variable" href="structduk__activation.html#a05a11e283998d74a28767200b42d1bc1">flags</a> &amp; <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a0516cfba051919d12ec8a46e815b178f">DUK_ACT_FLAG_PREVENT_YIELD</a>) {</div>
<div class="line"><span class="lineno"> 2451</span>            <span class="comment">/* See: test-bug-tailcall-preventyield-assert.c. */</span></div>
<div class="line"><span class="lineno"> 2452</span>            <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a2db20d2d3b36d8491ed171cf503488bb">DUK_DDD</a>(<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#aa6e5d41ceaba6832e5ede737f0a35fb9">DUK_DDDPRINT</a>(<span class="stringliteral">&quot;tail call prevented by current activation having DUK_ACT_FLAG_PREVENTYIELD&quot;</span>));</div>
<div class="line"><span class="lineno"> 2453</span>            use_tailcall = 0;</div>
<div class="line"><span class="lineno"> 2454</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#ae8be8e30454cb5a9f16b588f30650e47">DUK_HOBJECT_HAS_NOTAIL</a>(func)) {</div>
<div class="line"><span class="lineno"> 2455</span>            <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a9e1528b8eb0a41bc4b37a09a77961e6c">DUK_D</a>(<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a50dbac8614f67a4a6d575791664ebc07">DUK_DPRINT</a>(<span class="stringliteral">&quot;tail call prevented by function having a notail flag&quot;</span>));</div>
<div class="line"><span class="lineno"> 2456</span>            use_tailcall = 0;</div>
<div class="line"><span class="lineno"> 2457</span>        }</div>
<div class="line"><span class="lineno"> 2458</span>    }</div>
<div class="line"><span class="lineno"> 2459</span> </div>
<div class="line"><span class="lineno"> 2460</span>    <span class="keywordflow">if</span> (use_tailcall) {</div>
<div class="line"><span class="lineno"> 2461</span>        <a class="code hl_struct" href="structduk__tval__struct.html">duk_tval</a> *tv1, *tv2;</div>
<div class="line"><span class="lineno"> 2462</span>        <a class="code hl_typedef" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#ab0a71934d59f38f195fea2f353032392">duk_size_t</a> cs_index;</div>
<div class="line"><span class="lineno"> 2463</span>        <a class="code hl_typedef" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a9dbc0fdd27e7326d21cbf56e6d40d8a5">duk_int_t</a> i_stk;  <span class="comment">/* must be signed for loop structure */</span></div>
<div class="line"><span class="lineno"> 2464</span>        <a class="code hl_typedef" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a3e3bb369382aab50155c1d18bdf73923">duk_idx_t</a> i_arg;</div>
<div class="line"><span class="lineno"> 2465</span> </div>
<div class="line"><span class="lineno"> 2466</span>        <span class="comment">/*</span></div>
<div class="line"><span class="lineno"> 2467</span><span class="comment">         *  Tailcall handling</span></div>
<div class="line"><span class="lineno"> 2468</span><span class="comment">         *</span></div>
<div class="line"><span class="lineno"> 2469</span><span class="comment">         *  Although the callstack entry is reused, we need to explicitly unwind</span></div>
<div class="line"><span class="lineno"> 2470</span><span class="comment">         *  the current activation (or simulate an unwind).  In particular, the</span></div>
<div class="line"><span class="lineno"> 2471</span><span class="comment">         *  current activation must be closed, otherwise something like</span></div>
<div class="line"><span class="lineno"> 2472</span><span class="comment">         *  test-bug-reduce-judofyr.js results.  Also catchstack needs be unwound</span></div>
<div class="line"><span class="lineno"> 2473</span><span class="comment">         *  because there may be non-error-catching label entries in valid tail calls.</span></div>
<div class="line"><span class="lineno"> 2474</span><span class="comment">         */</span></div>
<div class="line"><span class="lineno"> 2475</span> </div>
<div class="line"><span class="lineno"> 2476</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a2db20d2d3b36d8491ed171cf503488bb">DUK_DDD</a>(<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#aa6e5d41ceaba6832e5ede737f0a35fb9">DUK_DDDPRINT</a>(<span class="stringliteral">&quot;is tail call, reusing activation at callstack top, at index %ld&quot;</span>,</div>
<div class="line"><span class="lineno"> 2477</span>                             (<span class="keywordtype">long</span>) (thr-&gt;callstack_top - 1)));</div>
<div class="line"><span class="lineno"> 2478</span> </div>
<div class="line"><span class="lineno"> 2479</span>        <span class="comment">/* &#39;act&#39; already set above */</span></div>
<div class="line"><span class="lineno"> 2480</span> </div>
<div class="line"><span class="lineno"> 2481</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(!<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a1405011142963f5c45c82eb2a881e385">DUK_HOBJECT_HAS_BOUND</a>(func));</div>
<div class="line"><span class="lineno"> 2482</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(!<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a926cbbfc1c31a48c486b9bf4892f6f29">DUK_HOBJECT_HAS_NATIVEFUNCTION</a>(func));</div>
<div class="line"><span class="lineno"> 2483</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#af4939c11c36b867784c572c276549369">DUK_HOBJECT_HAS_COMPILEDFUNCTION</a>(func));</div>
<div class="line"><span class="lineno"> 2484</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>((act-&gt;<a class="code hl_variable" href="structduk__activation.html#a05a11e283998d74a28767200b42d1bc1">flags</a> &amp; <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a0516cfba051919d12ec8a46e815b178f">DUK_ACT_FLAG_PREVENT_YIELD</a>) == 0);</div>
<div class="line"><span class="lineno"> 2485</span> </div>
<div class="line"><span class="lineno"> 2486</span>        <span class="comment">/* Unwind catchstack entries referring to the callstack entry we&#39;re reusing */</span></div>
<div class="line"><span class="lineno"> 2487</span>        cs_index = thr-&gt;callstack_top - 1;</div>
<div class="line"><span class="lineno"> 2488</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(thr-&gt;catchstack_top &lt;= <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a48e45512fcecab8de9e5703d222e9ddf">DUK_INT_MAX</a>);  <span class="comment">/* catchstack limits */</span></div>
<div class="line"><span class="lineno"> 2489</span>        <span class="keywordflow">for</span> (i_stk = (<a class="code hl_typedef" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a9dbc0fdd27e7326d21cbf56e6d40d8a5">duk_int_t</a>) (thr-&gt;catchstack_top - 1); i_stk &gt;= 0; i_stk--) {</div>
<div class="line"><span class="lineno"> 2490</span>            <a class="code hl_struct" href="structduk__catcher.html">duk_catcher</a> *cat = thr-&gt;catchstack + i_stk;</div>
<div class="line"><span class="lineno"> 2491</span>            <span class="keywordflow">if</span> (cat-&gt;<a class="code hl_variable" href="structduk__catcher.html#a763bb99edea7d1d2eab211ae8385686e">callstack_index</a> != cs_index) {</div>
<div class="line"><span class="lineno"> 2492</span>                <span class="comment">/* &#39;i&#39; is the first entry we&#39;ll keep */</span></div>
<div class="line"><span class="lineno"> 2493</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2494</span>            }</div>
<div class="line"><span class="lineno"> 2495</span>        }</div>
<div class="line"><span class="lineno"> 2496</span>        <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a293c800100000f744f86bd30ddedaae3">duk_hthread_catchstack_unwind</a>(thr, i_stk + 1);</div>
<div class="line"><span class="lineno"> 2497</span> </div>
<div class="line"><span class="lineno"> 2498</span>        <span class="comment">/* Unwind the topmost callstack entry before reusing it */</span></div>
<div class="line"><span class="lineno"> 2499</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(thr-&gt;callstack_top &gt; 0);</div>
<div class="line"><span class="lineno"> 2500</span>        <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a6b0424c9d50c491ab32e7605cd9fdae2">duk_hthread_callstack_unwind</a>(thr, thr-&gt;callstack_top - 1);</div>
<div class="line"><span class="lineno"> 2501</span> </div>
<div class="line"><span class="lineno"> 2502</span>        <span class="comment">/* Then reuse the unwound activation; callstack was not shrunk so there is always space */</span></div>
<div class="line"><span class="lineno"> 2503</span>        thr-&gt;callstack_top++;</div>
<div class="line"><span class="lineno"> 2504</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(thr-&gt;callstack_top &lt;= thr-&gt;callstack_size);</div>
<div class="line"><span class="lineno"> 2505</span>        act = thr-&gt;callstack + thr-&gt;callstack_top - 1;</div>
<div class="line"><span class="lineno"> 2506</span> </div>
<div class="line"><span class="lineno"> 2507</span>        <span class="comment">/* Start filling in the activation */</span></div>
<div class="line"><span class="lineno"> 2508</span>        act-&gt;<a class="code hl_variable" href="structduk__activation.html#a6de02a28083672138fb33da69fbf701a">func</a> = func;  <span class="comment">/* don&#39;t want an intermediate exposed state with func == NULL */</span></div>
<div class="line"><span class="lineno"> 2509</span><span class="preprocessor">#if defined(DUK_USE_NONSTD_FUNC_CALLER_PROPERTY)</span></div>
<div class="line"><span class="lineno"> 2510</span>        act-&gt;prev_caller = <a class="code hl_define" href="gmacros_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><span class="lineno"> 2511</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 2512</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(func != <a class="code hl_define" href="gmacros_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><span class="lineno"> 2513</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#af4939c11c36b867784c572c276549369">DUK_HOBJECT_HAS_COMPILEDFUNCTION</a>(func));</div>
<div class="line"><span class="lineno"> 2514</span>        <span class="comment">/* don&#39;t want an intermediate exposed state with invalid pc */</span></div>
<div class="line"><span class="lineno"> 2515</span>        act-&gt;<a class="code hl_variable" href="structduk__activation.html#a19ed13846f28deb48700a005c10aba8c">curr_pc</a> = <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a108793d34c82fc91faeb744adf2ce722">DUK_HCOMPILEDFUNCTION_GET_CODE_BASE</a>(thr-&gt;heap, (<a class="code hl_struct" href="structduk__hcompiledfunction.html">duk_hcompiledfunction</a> *) func);</div>
<div class="line"><span class="lineno"> 2516</span><span class="preprocessor">#if defined(DUK_USE_DEBUGGER_SUPPORT)</span></div>
<div class="line"><span class="lineno"> 2517</span>        act-&gt;prev_line = 0;</div>
<div class="line"><span class="lineno"> 2518</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 2519</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a2730ed3b8ede880f25dd33ebb2270d09">DUK_TVAL_SET_OBJECT</a>(&amp;act-&gt;<a class="code hl_variable" href="structduk__activation.html#aee23fb32ca20b90a8c06cd785c61534b">tv_func</a>, func);  <span class="comment">/* borrowed, no refcount */</span></div>
<div class="line"><span class="lineno"> 2520</span><span class="preprocessor">#if defined(DUK_USE_REFERENCE_COUNTING)</span></div>
<div class="line"><span class="lineno"> 2521</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#ac6b106695c0dfa435ade88972d1e46b8">DUK_HOBJECT_INCREF</a>(thr, func);</div>
<div class="line"><span class="lineno"> 2522</span>        act = thr-&gt;callstack + thr-&gt;callstack_top - 1;  <span class="comment">/* side effects (currently none though) */</span></div>
<div class="line"><span class="lineno"> 2523</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 2524</span> </div>
<div class="line"><span class="lineno"> 2525</span><span class="preprocessor">#if defined(DUK_USE_NONSTD_FUNC_CALLER_PROPERTY)</span></div>
<div class="line"><span class="lineno"> 2526</span><span class="preprocessor">#if defined(DUK_USE_TAILCALL)</span></div>
<div class="line"><span class="lineno"> 2527</span><span class="preprocessor">#error incorrect options: tail calls enabled with function caller property</span></div>
<div class="line"><span class="lineno"> 2528</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 2529</span>        <span class="comment">/* XXX: this doesn&#39;t actually work properly for tail calls, so</span></div>
<div class="line"><span class="lineno"> 2530</span><span class="comment">         * tail calls are disabled when DUK_USE_NONSTD_FUNC_CALLER_PROPERTY</span></div>
<div class="line"><span class="lineno"> 2531</span><span class="comment">         * is in use.</span></div>
<div class="line"><span class="lineno"> 2532</span><span class="comment">         */</span></div>
<div class="line"><span class="lineno"> 2533</span>        duk__update_func_caller_prop(thr, func);</div>
<div class="line"><span class="lineno"> 2534</span>        act = thr-&gt;callstack + thr-&gt;callstack_top - 1;</div>
<div class="line"><span class="lineno"> 2535</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 2536</span> </div>
<div class="line"><span class="lineno"> 2537</span>        act-&gt;<a class="code hl_variable" href="structduk__activation.html#a05a11e283998d74a28767200b42d1bc1">flags</a> = (<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#ae5226f867ccd5073adc2df9140389ecb">DUK_HOBJECT_HAS_STRICT</a>(func) ?</div>
<div class="line"><span class="lineno"> 2538</span>                      <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a56d7614c6c54403b83c190449622328f">DUK_ACT_FLAG_STRICT</a> | <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a026dae50354d625bf4a48123411708af">DUK_ACT_FLAG_TAILCALLED</a> :</div>
<div class="line"><span class="lineno"> 2539</span>                      <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a026dae50354d625bf4a48123411708af">DUK_ACT_FLAG_TAILCALLED</a>);</div>
<div class="line"><span class="lineno"> 2540</span> </div>
<div class="line"><span class="lineno"> 2541</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#ac80b8c05792b926d22f8c540f947ebbe">DUK_ACT_GET_FUNC</a>(act) == func);      <span class="comment">/* already updated */</span></div>
<div class="line"><span class="lineno"> 2542</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(act-&gt;<a class="code hl_variable" href="structduk__activation.html#a92ea93909d22ddbd33cfc46f32726387">var_env</a> == <a class="code hl_define" href="gmacros_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);   <span class="comment">/* already NULLed (by unwind) */</span></div>
<div class="line"><span class="lineno"> 2543</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(act-&gt;<a class="code hl_variable" href="structduk__activation.html#a2e3041f6643f991adf53a6a8d55ea3c3">lex_env</a> == <a class="code hl_define" href="gmacros_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);   <span class="comment">/* already NULLed (by unwind) */</span></div>
<div class="line"><span class="lineno"> 2544</span>        act-&gt;<a class="code hl_variable" href="structduk__activation.html#a181b5225468a571c32b94317422e08f2">idx_bottom</a> = entry_valstack_bottom_index;  <span class="comment">/* tail call -&gt; reuse current &quot;frame&quot; */</span></div>
<div class="line"><span class="lineno"> 2545</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(nregs &gt;= 0);</div>
<div class="line"><span class="lineno"> 2546</span><span class="preprocessor">#if 0  </span><span class="comment">/* topmost activation idx_retval is considered garbage, no need to init */</span><span class="preprocessor"></span></div>
<div class="line"><span class="lineno"> 2547</span>        act-&gt;<a class="code hl_variable" href="structduk__activation.html#af82e168e163ea9e05c40281092e44347">idx_retval</a> = 0;</div>
<div class="line"><span class="lineno"> 2548</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 2549</span> </div>
<div class="line"><span class="lineno"> 2550</span>        <span class="comment">/*</span></div>
<div class="line"><span class="lineno"> 2551</span><span class="comment">         *  Manipulate valstack so that args are on the current bottom and the</span></div>
<div class="line"><span class="lineno"> 2552</span><span class="comment">         *  previous caller&#39;s &#39;this&#39; binding (which is the value preceding the</span></div>
<div class="line"><span class="lineno"> 2553</span><span class="comment">         *  current bottom) is replaced with the new &#39;this&#39; binding:</span></div>
<div class="line"><span class="lineno"> 2554</span><span class="comment">         *</span></div>
<div class="line"><span class="lineno"> 2555</span><span class="comment">         *       [ ... this_old | (crud) func this_new arg1 ... argN ]</span></div>
<div class="line"><span class="lineno"> 2556</span><span class="comment">         *  --&gt;  [ ... this_new | arg1 ... argN ]</span></div>
<div class="line"><span class="lineno"> 2557</span><span class="comment">         *</span></div>
<div class="line"><span class="lineno"> 2558</span><span class="comment">         *  For tail calling to work properly, the valstack bottom must not grow</span></div>
<div class="line"><span class="lineno"> 2559</span><span class="comment">         *  here; otherwise crud would accumulate on the valstack.</span></div>
<div class="line"><span class="lineno"> 2560</span><span class="comment">         */</span></div>
<div class="line"><span class="lineno"> 2561</span> </div>
<div class="line"><span class="lineno"> 2562</span>        tv1 = thr-&gt;valstack_bottom - 1;</div>
<div class="line"><span class="lineno"> 2563</span>        tv2 = thr-&gt;valstack_bottom + idx_func + 1;</div>
<div class="line"><span class="lineno"> 2564</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(tv1 &gt;= thr-&gt;valstack &amp;&amp; tv1 &lt; thr-&gt;valstack_top);  <span class="comment">/* tv1 is -below- valstack_bottom */</span></div>
<div class="line"><span class="lineno"> 2565</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(tv2 &gt;= thr-&gt;valstack_bottom &amp;&amp; tv2 &lt; thr-&gt;valstack_top);</div>
<div class="line"><span class="lineno"> 2566</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a707d3bb6b36563e69505b66a9b7335cf">DUK_TVAL_SET_TVAL_UPDREF</a>(thr, tv1, tv2);  <span class="comment">/* side effects */</span></div>
<div class="line"><span class="lineno"> 2567</span> </div>
<div class="line"><span class="lineno"> 2568</span>        <span class="keywordflow">for</span> (i_arg = 0; i_arg &lt; idx_args; i_arg++) {</div>
<div class="line"><span class="lineno"> 2569</span>            <span class="comment">/* XXX: block removal API primitive */</span></div>
<div class="line"><span class="lineno"> 2570</span>            <span class="comment">/* Note: &#39;func&#39; is popped from valstack here, but it is</span></div>
<div class="line"><span class="lineno"> 2571</span><span class="comment">             * already reachable from the activation.</span></div>
<div class="line"><span class="lineno"> 2572</span><span class="comment">             */</span></div>
<div class="line"><span class="lineno"> 2573</span>            <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52f537d78760f69d0d94d21728279b50">duk_remove</a>(ctx, 0);</div>
<div class="line"><span class="lineno"> 2574</span>        }</div>
<div class="line"><span class="lineno"> 2575</span>        idx_func = 0; <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a9170138f330dbcaabfae9d2c59cc9684">DUK_UNREF</a>(idx_func);  <span class="comment">/* really &#39;not applicable&#39; anymore, should not be referenced after this */</span></div>
<div class="line"><span class="lineno"> 2576</span>        idx_args = 0;</div>
<div class="line"><span class="lineno"> 2577</span> </div>
<div class="line"><span class="lineno"> 2578</span>        <span class="comment">/* [ ... this_new | arg1 ... argN ] */</span></div>
<div class="line"><span class="lineno"> 2579</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2580</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a2db20d2d3b36d8491ed171cf503488bb">DUK_DDD</a>(<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#aa6e5d41ceaba6832e5ede737f0a35fb9">DUK_DDDPRINT</a>(<span class="stringliteral">&quot;not a tail call, pushing a new activation to callstack, to index %ld&quot;</span>,</div>
<div class="line"><span class="lineno"> 2581</span>                             (<span class="keywordtype">long</span>) (thr-&gt;callstack_top)));</div>
<div class="line"><span class="lineno"> 2582</span> </div>
<div class="line"><span class="lineno"> 2583</span>        <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a0490bab9b44658a5ac4aad3bc88b0e4b">duk_hthread_callstack_grow</a>(thr);</div>
<div class="line"><span class="lineno"> 2584</span> </div>
<div class="line"><span class="lineno"> 2585</span>        <span class="keywordflow">if</span> (call_flags &amp; <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a5d41683dbaef0b87ef339c9dde7f25d5">DUK_CALL_FLAG_IS_RESUME</a>) {</div>
<div class="line"><span class="lineno"> 2586</span>            <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a2db20d2d3b36d8491ed171cf503488bb">DUK_DDD</a>(<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#aa6e5d41ceaba6832e5ede737f0a35fb9">DUK_DDDPRINT</a>(<span class="stringliteral">&quot;is resume -&gt; no update to current activation (may not even exist)&quot;</span>));</div>
<div class="line"><span class="lineno"> 2587</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2588</span>            <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a2db20d2d3b36d8491ed171cf503488bb">DUK_DDD</a>(<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#aa6e5d41ceaba6832e5ede737f0a35fb9">DUK_DDDPRINT</a>(<span class="stringliteral">&quot;update to current activation idx_retval&quot;</span>));</div>
<div class="line"><span class="lineno"> 2589</span>            <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(thr-&gt;callstack_top &lt; thr-&gt;callstack_size);</div>
<div class="line"><span class="lineno"> 2590</span>            <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(thr-&gt;callstack_top &gt;= 1);</div>
<div class="line"><span class="lineno"> 2591</span>            act = thr-&gt;callstack + thr-&gt;callstack_top - 1;</div>
<div class="line"><span class="lineno"> 2592</span>            <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#ac80b8c05792b926d22f8c540f947ebbe">DUK_ACT_GET_FUNC</a>(act) != <a class="code hl_define" href="gmacros_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><span class="lineno"> 2593</span>            <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a3b446d4cd53f63e5e57b80041eb0d598">DUK_HOBJECT_IS_COMPILEDFUNCTION</a>(<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#ac80b8c05792b926d22f8c540f947ebbe">DUK_ACT_GET_FUNC</a>(act)));</div>
<div class="line"><span class="lineno"> 2594</span>            act-&gt;<a class="code hl_variable" href="structduk__activation.html#af82e168e163ea9e05c40281092e44347">idx_retval</a> = entry_valstack_bottom_index + idx_func;</div>
<div class="line"><span class="lineno"> 2595</span>        }</div>
<div class="line"><span class="lineno"> 2596</span> </div>
<div class="line"><span class="lineno"> 2597</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(thr-&gt;callstack_top &lt; thr-&gt;callstack_size);</div>
<div class="line"><span class="lineno"> 2598</span>        act = thr-&gt;callstack + thr-&gt;callstack_top;</div>
<div class="line"><span class="lineno"> 2599</span>        thr-&gt;callstack_top++;</div>
<div class="line"><span class="lineno"> 2600</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(thr-&gt;callstack_top &lt;= thr-&gt;callstack_size);</div>
<div class="line"><span class="lineno"> 2601</span> </div>
<div class="line"><span class="lineno"> 2602</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(!<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a1405011142963f5c45c82eb2a881e385">DUK_HOBJECT_HAS_BOUND</a>(func));</div>
<div class="line"><span class="lineno"> 2603</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(!<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a926cbbfc1c31a48c486b9bf4892f6f29">DUK_HOBJECT_HAS_NATIVEFUNCTION</a>(func));</div>
<div class="line"><span class="lineno"> 2604</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#af4939c11c36b867784c572c276549369">DUK_HOBJECT_HAS_COMPILEDFUNCTION</a>(func));</div>
<div class="line"><span class="lineno"> 2605</span> </div>
<div class="line"><span class="lineno"> 2606</span>        act-&gt;<a class="code hl_variable" href="structduk__activation.html#a05a11e283998d74a28767200b42d1bc1">flags</a> = (<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#ae5226f867ccd5073adc2df9140389ecb">DUK_HOBJECT_HAS_STRICT</a>(func) ?</div>
<div class="line"><span class="lineno"> 2607</span>                      <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a56d7614c6c54403b83c190449622328f">DUK_ACT_FLAG_STRICT</a> :</div>
<div class="line"><span class="lineno"> 2608</span>                      0);</div>
<div class="line"><span class="lineno"> 2609</span>        act-&gt;<a class="code hl_variable" href="structduk__activation.html#a6de02a28083672138fb33da69fbf701a">func</a> = func;</div>
<div class="line"><span class="lineno"> 2610</span>        act-&gt;<a class="code hl_variable" href="structduk__activation.html#a92ea93909d22ddbd33cfc46f32726387">var_env</a> = <a class="code hl_define" href="gmacros_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><span class="lineno"> 2611</span>        act-&gt;<a class="code hl_variable" href="structduk__activation.html#a2e3041f6643f991adf53a6a8d55ea3c3">lex_env</a> = <a class="code hl_define" href="gmacros_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><span class="lineno"> 2612</span><span class="preprocessor">#if defined(DUK_USE_NONSTD_FUNC_CALLER_PROPERTY)</span></div>
<div class="line"><span class="lineno"> 2613</span>        act-&gt;prev_caller = <a class="code hl_define" href="gmacros_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><span class="lineno"> 2614</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 2615</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(func != <a class="code hl_define" href="gmacros_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><span class="lineno"> 2616</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#af4939c11c36b867784c572c276549369">DUK_HOBJECT_HAS_COMPILEDFUNCTION</a>(func));</div>
<div class="line"><span class="lineno"> 2617</span>        act-&gt;<a class="code hl_variable" href="structduk__activation.html#a19ed13846f28deb48700a005c10aba8c">curr_pc</a> = <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a108793d34c82fc91faeb744adf2ce722">DUK_HCOMPILEDFUNCTION_GET_CODE_BASE</a>(thr-&gt;heap, (<a class="code hl_struct" href="structduk__hcompiledfunction.html">duk_hcompiledfunction</a> *) func);</div>
<div class="line"><span class="lineno"> 2618</span><span class="preprocessor">#if defined(DUK_USE_DEBUGGER_SUPPORT)</span></div>
<div class="line"><span class="lineno"> 2619</span>        act-&gt;prev_line = 0;</div>
<div class="line"><span class="lineno"> 2620</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 2621</span>        act-&gt;<a class="code hl_variable" href="structduk__activation.html#a181b5225468a571c32b94317422e08f2">idx_bottom</a> = entry_valstack_bottom_index + idx_args;</div>
<div class="line"><span class="lineno"> 2622</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(nregs &gt;= 0);</div>
<div class="line"><span class="lineno"> 2623</span><span class="preprocessor">#if 0  </span><span class="comment">/* topmost activation idx_retval is considered garbage, no need to init */</span><span class="preprocessor"></span></div>
<div class="line"><span class="lineno"> 2624</span>        act-&gt;<a class="code hl_variable" href="structduk__activation.html#af82e168e163ea9e05c40281092e44347">idx_retval</a> = 0;</div>
<div class="line"><span class="lineno"> 2625</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 2626</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a2730ed3b8ede880f25dd33ebb2270d09">DUK_TVAL_SET_OBJECT</a>(&amp;act-&gt;<a class="code hl_variable" href="structduk__activation.html#aee23fb32ca20b90a8c06cd785c61534b">tv_func</a>, func);  <span class="comment">/* borrowed, no refcount */</span></div>
<div class="line"><span class="lineno"> 2627</span> </div>
<div class="line"><span class="lineno"> 2628</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#ac6b106695c0dfa435ade88972d1e46b8">DUK_HOBJECT_INCREF</a>(thr, func);  <span class="comment">/* act-&gt;func */</span></div>
<div class="line"><span class="lineno"> 2629</span> </div>
<div class="line"><span class="lineno"> 2630</span><span class="preprocessor">#if defined(DUK_USE_NONSTD_FUNC_CALLER_PROPERTY)</span></div>
<div class="line"><span class="lineno"> 2631</span>        duk__update_func_caller_prop(thr, func);</div>
<div class="line"><span class="lineno"> 2632</span>        act = thr-&gt;callstack + thr-&gt;callstack_top - 1;</div>
<div class="line"><span class="lineno"> 2633</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 2634</span>    }</div>
<div class="line"><span class="lineno"> 2635</span> </div>
<div class="line"><span class="lineno"> 2636</span>    <span class="comment">/* [ ... func this arg1 ... argN ]  (not tail call)</span></div>
<div class="line"><span class="lineno"> 2637</span><span class="comment">     * [ this | arg1 ... argN ]         (tail call)</span></div>
<div class="line"><span class="lineno"> 2638</span><span class="comment">     *</span></div>
<div class="line"><span class="lineno"> 2639</span><span class="comment">     * idx_args updated to match</span></div>
<div class="line"><span class="lineno"> 2640</span><span class="comment">     */</span></div>
<div class="line"><span class="lineno"> 2641</span> </div>
<div class="line"><span class="lineno"> 2642</span>    <span class="comment">/*</span></div>
<div class="line"><span class="lineno"> 2643</span><span class="comment">     *  Environment record creation and &#39;arguments&#39; object creation.</span></div>
<div class="line"><span class="lineno"> 2644</span><span class="comment">     *  Named function expression name binding is handled by the</span></div>
<div class="line"><span class="lineno"> 2645</span><span class="comment">     *  compiler; the compiled function&#39;s parent env will contain</span></div>
<div class="line"><span class="lineno"> 2646</span><span class="comment">     *  the (immutable) binding already.</span></div>
<div class="line"><span class="lineno"> 2647</span><span class="comment">     *</span></div>
<div class="line"><span class="lineno"> 2648</span><span class="comment">     *  Delayed creation (on demand) is handled in duk_js_var.c.</span></div>
<div class="line"><span class="lineno"> 2649</span><span class="comment">     */</span></div>
<div class="line"><span class="lineno"> 2650</span> </div>
<div class="line"><span class="lineno"> 2651</span>    <span class="comment">/* XXX: unify handling with native call. */</span></div>
<div class="line"><span class="lineno"> 2652</span> </div>
<div class="line"><span class="lineno"> 2653</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(!<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a1405011142963f5c45c82eb2a881e385">DUK_HOBJECT_HAS_BOUND</a>(func));  <span class="comment">/* bound function chain has already been resolved */</span></div>
<div class="line"><span class="lineno"> 2654</span> </div>
<div class="line"><span class="lineno"> 2655</span>    <span class="keywordflow">if</span> (!<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#abc40e3d6cc4e2c0c659abdb0bd5ab78b">DUK_HOBJECT_HAS_NEWENV</a>(func)) {</div>
<div class="line"><span class="lineno"> 2656</span>        <span class="comment">/* use existing env (e.g. for non-strict eval); cannot have</span></div>
<div class="line"><span class="lineno"> 2657</span><span class="comment">         * an own &#39;arguments&#39; object (but can refer to the existing one)</span></div>
<div class="line"><span class="lineno"> 2658</span><span class="comment">         */</span></div>
<div class="line"><span class="lineno"> 2659</span> </div>
<div class="line"><span class="lineno"> 2660</span>        <a class="code hl_function" href="#a208a38260dcc44fddbc4658759b71f08">duk__handle_oldenv_for_call</a>(thr, func, act);</div>
<div class="line"><span class="lineno"> 2661</span> </div>
<div class="line"><span class="lineno"> 2662</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(act-&gt;<a class="code hl_variable" href="structduk__activation.html#a2e3041f6643f991adf53a6a8d55ea3c3">lex_env</a> != <a class="code hl_define" href="gmacros_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><span class="lineno"> 2663</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(act-&gt;<a class="code hl_variable" href="structduk__activation.html#a92ea93909d22ddbd33cfc46f32726387">var_env</a> != <a class="code hl_define" href="gmacros_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><span class="lineno"> 2664</span>        <span class="keywordflow">goto</span> env_done;</div>
<div class="line"><span class="lineno"> 2665</span>    }</div>
<div class="line"><span class="lineno"> 2666</span> </div>
<div class="line"><span class="lineno"> 2667</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#abc40e3d6cc4e2c0c659abdb0bd5ab78b">DUK_HOBJECT_HAS_NEWENV</a>(func));</div>
<div class="line"><span class="lineno"> 2668</span> </div>
<div class="line"><span class="lineno"> 2669</span>    <span class="keywordflow">if</span> (!<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a405107c06eacfb0b9b6e82aaaa609b9d">DUK_HOBJECT_HAS_CREATEARGS</a>(func)) {</div>
<div class="line"><span class="lineno"> 2670</span>        <span class="comment">/* no need to create environment record now; leave as NULL */</span></div>
<div class="line"><span class="lineno"> 2671</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(act-&gt;<a class="code hl_variable" href="structduk__activation.html#a2e3041f6643f991adf53a6a8d55ea3c3">lex_env</a> == <a class="code hl_define" href="gmacros_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><span class="lineno"> 2672</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(act-&gt;<a class="code hl_variable" href="structduk__activation.html#a92ea93909d22ddbd33cfc46f32726387">var_env</a> == <a class="code hl_define" href="gmacros_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><span class="lineno"> 2673</span>        <span class="keywordflow">goto</span> env_done;</div>
<div class="line"><span class="lineno"> 2674</span>    }</div>
<div class="line"><span class="lineno"> 2675</span> </div>
<div class="line"><span class="lineno"> 2676</span>    <span class="comment">/* third arg: absolute index (to entire valstack) of idx_bottom of new activation */</span></div>
<div class="line"><span class="lineno"> 2677</span>    env = <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a2c84775718b9520a875530d3f92b4b5b">duk_create_activation_environment_record</a>(thr, func, act-&gt;<a class="code hl_variable" href="structduk__activation.html#a181b5225468a571c32b94317422e08f2">idx_bottom</a>);</div>
<div class="line"><span class="lineno"> 2678</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(env != <a class="code hl_define" href="gmacros_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><span class="lineno"> 2679</span> </div>
<div class="line"><span class="lineno"> 2680</span>    <span class="comment">/* [ ... arg1 ... argN envobj ] */</span></div>
<div class="line"><span class="lineno"> 2681</span> </div>
<div class="line"><span class="lineno"> 2682</span>    <span class="comment">/* original input stack before nargs/nregs handling must be</span></div>
<div class="line"><span class="lineno"> 2683</span><span class="comment">     * intact for &#39;arguments&#39; object</span></div>
<div class="line"><span class="lineno"> 2684</span><span class="comment">     */</span></div>
<div class="line"><span class="lineno"> 2685</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a405107c06eacfb0b9b6e82aaaa609b9d">DUK_HOBJECT_HAS_CREATEARGS</a>(func));</div>
<div class="line"><span class="lineno"> 2686</span>    <a class="code hl_function" href="#a988107c9c80890ed0641244b749a1969">duk__handle_createargs_for_call</a>(thr, func, env, num_stack_args);</div>
<div class="line"><span class="lineno"> 2687</span> </div>
<div class="line"><span class="lineno"> 2688</span>    <span class="comment">/* [ ... arg1 ... argN envobj ] */</span></div>
<div class="line"><span class="lineno"> 2689</span> </div>
<div class="line"><span class="lineno"> 2690</span>    act = thr-&gt;callstack + thr-&gt;callstack_top - 1;</div>
<div class="line"><span class="lineno"> 2691</span>    act-&gt;<a class="code hl_variable" href="structduk__activation.html#a2e3041f6643f991adf53a6a8d55ea3c3">lex_env</a> = env;</div>
<div class="line"><span class="lineno"> 2692</span>    act-&gt;<a class="code hl_variable" href="structduk__activation.html#a92ea93909d22ddbd33cfc46f32726387">var_env</a> = env;</div>
<div class="line"><span class="lineno"> 2693</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#ac6b106695c0dfa435ade88972d1e46b8">DUK_HOBJECT_INCREF</a>(thr, act-&gt;<a class="code hl_variable" href="structduk__activation.html#a2e3041f6643f991adf53a6a8d55ea3c3">lex_env</a>);</div>
<div class="line"><span class="lineno"> 2694</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#ac6b106695c0dfa435ade88972d1e46b8">DUK_HOBJECT_INCREF</a>(thr, act-&gt;<a class="code hl_variable" href="structduk__activation.html#a92ea93909d22ddbd33cfc46f32726387">var_env</a>);</div>
<div class="line"><span class="lineno"> 2695</span>    <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#ac8da334e24a5f42f252271161d2116fb">duk_pop</a>(ctx);</div>
<div class="line"><span class="lineno"> 2696</span> </div>
<div class="line"><span class="lineno"> 2697</span> env_done:</div>
<div class="line"><span class="lineno"> 2698</span>    <span class="comment">/* [ ... arg1 ... argN ] */</span></div>
<div class="line"><span class="lineno"> 2699</span> </div>
<div class="line"><span class="lineno"> 2700</span>    <span class="comment">/*</span></div>
<div class="line"><span class="lineno"> 2701</span><span class="comment">     *  Setup value stack: clamp to &#39;nargs&#39;, fill up to &#39;nregs&#39;</span></div>
<div class="line"><span class="lineno"> 2702</span><span class="comment">     */</span></div>
<div class="line"><span class="lineno"> 2703</span> </div>
<div class="line"><span class="lineno"> 2704</span>    <a class="code hl_function" href="#a24504a6bbcf7c2ac1bbcf078f0313652">duk__adjust_valstack_and_top</a>(thr,</div>
<div class="line"><span class="lineno"> 2705</span>                                 num_stack_args,</div>
<div class="line"><span class="lineno"> 2706</span>                                 idx_args,</div>
<div class="line"><span class="lineno"> 2707</span>                                 nregs,</div>
<div class="line"><span class="lineno"> 2708</span>                                 nargs,</div>
<div class="line"><span class="lineno"> 2709</span>                                 func);</div>
<div class="line"><span class="lineno"> 2710</span> </div>
<div class="line"><span class="lineno"> 2711</span>    <span class="comment">/*</span></div>
<div class="line"><span class="lineno"> 2712</span><span class="comment">     *  Shift to new valstack_bottom.</span></div>
<div class="line"><span class="lineno"> 2713</span><span class="comment">     */</span></div>
<div class="line"><span class="lineno"> 2714</span> </div>
<div class="line"><span class="lineno"> 2715</span>    thr-&gt;valstack_bottom = thr-&gt;valstack_bottom + idx_args;</div>
<div class="line"><span class="lineno"> 2716</span>    <span class="comment">/* keep current valstack_top */</span></div>
<div class="line"><span class="lineno"> 2717</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(thr-&gt;valstack_bottom &gt;= thr-&gt;valstack);</div>
<div class="line"><span class="lineno"> 2718</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(thr-&gt;valstack_top &gt;= thr-&gt;valstack_bottom);</div>
<div class="line"><span class="lineno"> 2719</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(thr-&gt;valstack_end &gt;= thr-&gt;valstack_top);</div>
<div class="line"><span class="lineno"> 2720</span> </div>
<div class="line"><span class="lineno"> 2721</span>    <span class="comment">/*</span></div>
<div class="line"><span class="lineno"> 2722</span><span class="comment">     *  Return to bytecode executor, which will resume execution from</span></div>
<div class="line"><span class="lineno"> 2723</span><span class="comment">     *  the topmost activation.</span></div>
<div class="line"><span class="lineno"> 2724</span><span class="comment">     */</span></div>
<div class="line"><span class="lineno"> 2725</span> </div>
<div class="line"><span class="lineno"> 2726</span>    <span class="keywordflow">return</span> 1;</div>
<div class="line"><span class="lineno"> 2727</span>}</div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duk__config_8h_html_a48e45512fcecab8de9e5703d222e9ddf"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a48e45512fcecab8de9e5703d222e9ddf">DUK_INT_MAX</a></div><div class="ttdeci">#define DUK_INT_MAX</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duk__config_8h_source.html#l01788">duktape-1.5.2/src-noline/duk_config.h:1788</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_a026dae50354d625bf4a48123411708af"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#a026dae50354d625bf4a48123411708af">DUK_ACT_FLAG_TAILCALLED</a></div><div class="ttdeci">#define DUK_ACT_FLAG_TAILCALLED</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l05988">duktape-1.5.2/src-noline/duktape.c:5988</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_a0e99de287978113056ce5b0a1984d49b"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#a0e99de287978113056ce5b0a1984d49b">duk_normalize_index</a></div><div class="ttdeci">DUK_EXTERNAL duk_idx_t duk_normalize_index(duk_context *ctx, duk_idx_t index)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l15056">duktape-1.5.2/src-noline/duktape.c:15056</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_a1bd6d3ebc3d91f85beab0259b6041b93"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#a1bd6d3ebc3d91f85beab0259b6041b93">DUK_CAT_GET_TYPE</a></div><div class="ttdeci">#define DUK_CAT_GET_TYPE(c)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06022">duktape-1.5.2/src-noline/duktape.c:6022</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_a5b32dd67a8481ffa404a403c0cfac2a6"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#a5b32dd67a8481ffa404a403c0cfac2a6">DUK_ASSERT_DISABLE</a></div><div class="ttdeci">#define DUK_ASSERT_DISABLE(x)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07764">duktape-1.5.2/src-noline/duktape.c:7764</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_a5d41683dbaef0b87ef339c9dde7f25d5"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#a5d41683dbaef0b87ef339c9dde7f25d5">DUK_CALL_FLAG_IS_RESUME</a></div><div class="ttdeci">#define DUK_CALL_FLAG_IS_RESUME</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l08345">duktape-1.5.2/src-noline/duktape.c:8345</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_a5ea271115bcee754393f93970eb705a8"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#a5ea271115bcee754393f93970eb705a8">DUK_CALL_FLAG_IS_TAILCALL</a></div><div class="ttdeci">#define DUK_CALL_FLAG_IS_TAILCALL</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l08346">duktape-1.5.2/src-noline/duktape.c:8346</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_ac80b8c05792b926d22f8c540f947ebbe"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#ac80b8c05792b926d22f8c540f947ebbe">DUK_ACT_GET_FUNC</a></div><div class="ttdeci">#define DUK_ACT_GET_FUNC(act)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l05994">duktape-1.5.2/src-noline/duktape.c:5994</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_ad887c26e460c0a88e8d3c5112feee7b1"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#ad887c26e460c0a88e8d3c5112feee7b1">DUK_CAT_TYPE_LABEL</a></div><div class="ttdeci">#define DUK_CAT_TYPE_LABEL</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06020">duktape-1.5.2/src-noline/duktape.c:6020</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-noline_2duktape_8c_html_ae8be8e30454cb5a9f16b588f30650e47"><div class="ttname"><a href="duktape-1_85_82_2src-noline_2duktape_8c.html#ae8be8e30454cb5a9f16b588f30650e47">DUK_HOBJECT_HAS_NOTAIL</a></div><div class="ttdeci">#define DUK_HOBJECT_HAS_NOTAIL(h)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l04812">duktape-1.5.2/src-noline/duktape.c:4812</a></div></div>
<div class="ttc" id="astructduk__catcher_html"><div class="ttname"><a href="structduk__catcher.html">duk_catcher</a></div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06181">duktape-1.5.2/src-noline/duktape.c:6181</a></div></div>
<div class="ttc" id="astructduk__catcher_html_a763bb99edea7d1d2eab211ae8385686e"><div class="ttname"><a href="structduk__catcher.html#a763bb99edea7d1d2eab211ae8385686e">duk_catcher::callstack_index</a></div><div class="ttdeci">duk_size_t callstack_index</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06185">duktape-1.5.2/src-noline/duktape.c:6185</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06235">duk_hthread::callstack</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06185">duk_catcher::callstack_index</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06236">duk_hthread::callstack_size</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06237">duk_hthread::callstack_top</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06241">duk_hthread::catchstack</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06243">duk_hthread::catchstack_top</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06141">duk_activation::curr_pc</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07044">duk_heap::curr_thread</a>, <a class="el" href="duktape-1_85_82_2src-separate_2duk__js__call_8c_source.html#l00782">duk__adjust_valstack_and_top()</a>, <a class="el" href="duktape-1_85_82_2src-separate_2duk__js__call_8c_source.html#l00665">duk__coerce_effective_this_binding()</a>, <a class="el" href="duktape-1_85_82_2src-separate_2duk__js__call_8c_source.html#l00360">duk__handle_createargs_for_call()</a>, <a class="el" href="duktape-1_85_82_2src-separate_2duk__js__call_8c_source.html#l00523">duk__handle_oldenv_for_call()</a>, <a class="el" href="duktape-1_85_82_2src-separate_2duk__js__call_8c_source.html#l00717">duk__nonbound_func_lookup()</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l05990">DUK_ACT_FLAG_PREVENT_YIELD</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l05987">DUK_ACT_FLAG_STRICT</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l05988">DUK_ACT_FLAG_TAILCALLED</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l05994">DUK_ACT_GET_FUNC</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07755">DUK_ASSERT</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07764">DUK_ASSERT_DISABLE</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l08345">DUK_CALL_FLAG_IS_RESUME</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l08346">DUK_CALL_FLAG_IS_TAILCALL</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06022">DUK_CAT_GET_TYPE</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06020">DUK_CAT_TYPE_LABEL</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l71582">duk_create_activation_environment_record()</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07495">DUK_D</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07496">DUK_DD</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07497">DUK_DDD</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07509">DUK_DDDPRINT</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07508">DUK_DDPRINT</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07507">DUK_DPRINT</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07869">DUK_ERROR_API</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l15121">duk_get_tval()</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l05603">DUK_HCOMPILEDFUNCTION_GET_CODE_BASE</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l04805">DUK_HOBJECT_HAS_BOUND</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l04806">DUK_HOBJECT_HAS_COMPILEDFUNCTION</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l04815">DUK_HOBJECT_HAS_CREATEARGS</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l04807">DUK_HOBJECT_HAS_NATIVEFUNCTION</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l04813">DUK_HOBJECT_HAS_NEWENV</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l04812">DUK_HOBJECT_HAS_NOTAIL</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l04811">DUK_HOBJECT_HAS_STRICT</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l03822">DUK_HOBJECT_INCREF</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l04774">DUK_HOBJECT_IS_COMPILEDFUNCTION</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l54177">duk_hthread_callstack_grow()</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l54255">duk_hthread_callstack_unwind()</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l54560">duk_hthread_catchstack_unwind()</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06077">DUK_HTHREAD_STATE_RUNNING</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l54139">duk_hthread_sync_and_null_currpc()</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h_source.html#l01788">DUK_INT_MAX</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l15056">duk_normalize_index()</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l19146">duk_pop()</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l15820">duk_remove()</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l02279">DUK_STR_INVALID_CALL_ARGS</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l00739">DUK_TVAL_SET_OBJECT</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l04029">DUK_TVAL_SET_TVAL_UPDREF</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h_source.html#l02518">DUK_UNLIKELY</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h_source.html#l02494">DUK_UNREF</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06145">duk_activation::flags</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06131">duk_activation::func</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06202">duk_hthread::heap</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06159">duk_activation::idx_bottom</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06171">duk_activation::idx_retval</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06133">duk_activation::lex_env</a>, <a class="el" href="gmacros_8h_source.html#l00924">NULL</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06199">duk_hthread::ptr_curr_pc</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06208">duk_hthread::state</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06130">duk_activation::tv_func</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06226">duk_hthread::valstack</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06228">duk_hthread::valstack_bottom</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06227">duk_hthread::valstack_end</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06229">duk_hthread::valstack_top</a>, and <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06132">duk_activation::var_env</a>.</p>

</div>
</div>
<a id="a242a34ede062c530655f09f768b456b6" name="a242a34ede062c530655f09f768b456b6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a242a34ede062c530655f09f768b456b6">&#9670;&#160;</a></span>duk_handle_safe_call()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a19032f251b36af6bfb17f4450b829521">DUK_INTERNAL</a> <a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a9dbc0fdd27e7326d21cbf56e6d40d8a5">duk_int_t</a> duk_handle_safe_call </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structduk__hthread.html">duk_hthread</a> *</td>          <td class="paramname"><span class="paramname"><em>thr</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="duktape-1_85_82_2src-noline_2duktape_8h.html#af73ef474ce4eaa5f69994410c81c33db">duk_safe_call_function</a></td>          <td class="paramname"><span class="paramname"><em>func</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a3e3bb369382aab50155c1d18bdf73923">duk_idx_t</a></td>          <td class="paramname"><span class="paramname"><em>num_stack_args</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a3e3bb369382aab50155c1d18bdf73923">duk_idx_t</a></td>          <td class="paramname"><span class="paramname"><em>num_stack_rets</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="duktape-1_85_82_2src-separate_2duk__js__call_8c_source.html#l01872">1872</a> of file <a class="el" href="duktape-1_85_82_2src-separate_2duk__js__call_8c_source.html">duktape-1.5.2/src-separate/duk_js_call.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1875</span>                                                                      {</div>
<div class="line"><span class="lineno"> 1876</span>    <a class="code hl_struct" href="structduk__hthread.html">duk_context</a> *ctx = (<a class="code hl_struct" href="structduk__hthread.html">duk_context</a> *) thr;</div>
<div class="line"><span class="lineno"> 1877</span>    <a class="code hl_typedef" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#ab0a71934d59f38f195fea2f353032392">duk_size_t</a> entry_valstack_bottom_index;</div>
<div class="line"><span class="lineno"> 1878</span>    <a class="code hl_typedef" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#ab0a71934d59f38f195fea2f353032392">duk_size_t</a> entry_callstack_top;</div>
<div class="line"><span class="lineno"> 1879</span>    <a class="code hl_typedef" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#ab0a71934d59f38f195fea2f353032392">duk_size_t</a> entry_catchstack_top;</div>
<div class="line"><span class="lineno"> 1880</span>    <a class="code hl_typedef" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a9dbc0fdd27e7326d21cbf56e6d40d8a5">duk_int_t</a> entry_call_recursion_depth;</div>
<div class="line"><span class="lineno"> 1881</span>    <a class="code hl_struct" href="structduk__hthread.html">duk_hthread</a> *entry_curr_thread;</div>
<div class="line"><span class="lineno"> 1882</span>    <a class="code hl_typedef" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a7ce35d12b12e3eea5f8d46c6195650d1">duk_uint_fast8_t</a> entry_thread_state;</div>
<div class="line"><span class="lineno"> 1883</span>    <a class="code hl_typedef" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a9231b6cd154afc387b6282e9bb8e0c6e">duk_instr_t</a> **entry_ptr_curr_pc;</div>
<div class="line"><span class="lineno"> 1884</span>    <a class="code hl_struct" href="structduk__jmpbuf.html">duk_jmpbuf</a> *old_jmpbuf_ptr = <a class="code hl_define" href="gmacros_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><span class="lineno"> 1885</span>    <a class="code hl_struct" href="structduk__jmpbuf.html">duk_jmpbuf</a> our_jmpbuf;</div>
<div class="line"><span class="lineno"> 1886</span>    <a class="code hl_typedef" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a3e3bb369382aab50155c1d18bdf73923">duk_idx_t</a> idx_retbase;</div>
<div class="line"><span class="lineno"> 1887</span>    <a class="code hl_typedef" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a9dbc0fdd27e7326d21cbf56e6d40d8a5">duk_int_t</a> retval;</div>
<div class="line"><span class="lineno"> 1888</span> </div>
<div class="line"><span class="lineno"> 1889</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(thr != <a class="code hl_define" href="gmacros_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><span class="lineno"> 1890</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(ctx != <a class="code hl_define" href="gmacros_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><span class="lineno"> 1891</span> </div>
<div class="line"><span class="lineno"> 1892</span>    <span class="comment">/* Note: careful with indices like &#39;-x&#39;; if &#39;x&#39; is zero, it refers to bottom */</span></div>
<div class="line"><span class="lineno"> 1893</span>    entry_valstack_bottom_index = (<a class="code hl_typedef" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#ab0a71934d59f38f195fea2f353032392">duk_size_t</a>) (thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#ad39b6c03b81eb0f4d3eefda5083988d3">valstack_bottom</a> - thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#a08f58ff5b9fa5927891c2e08712e3971">valstack</a>);</div>
<div class="line"><span class="lineno"> 1894</span>    entry_callstack_top = thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#aea2cca88da9187f43fb2b925ef7f5ee4">callstack_top</a>;</div>
<div class="line"><span class="lineno"> 1895</span>    entry_catchstack_top = thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#a52794290185255eb48736c942b07ae04">catchstack_top</a>;</div>
<div class="line"><span class="lineno"> 1896</span>    entry_call_recursion_depth = thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#a1c6d2e1f36b0b7011f0e52343ca5ed05">heap</a>-&gt;<a class="code hl_variable" href="structduk__heap.html#ab229eef9c6b0d7fcd267527a4b107fe5">call_recursion_depth</a>;</div>
<div class="line"><span class="lineno"> 1897</span>    entry_curr_thread = thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#a1c6d2e1f36b0b7011f0e52343ca5ed05">heap</a>-&gt;<a class="code hl_variable" href="structduk__heap.html#a1f913439bf8af92c753891bea8abda78">curr_thread</a>;  <span class="comment">/* Note: may be NULL if first call */</span></div>
<div class="line"><span class="lineno"> 1898</span>    entry_thread_state = thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#a4dc5dc48406aa6240185468557d154dc">state</a>;</div>
<div class="line"><span class="lineno"> 1899</span>    entry_ptr_curr_pc = thr-&gt;<a class="code hl_variable" href="structduk__hthread.html#a9ceabe6e4ac27d8e61e8f33d4eab55a6">ptr_curr_pc</a>;  <span class="comment">/* may be NULL */</span></div>
<div class="line"><span class="lineno"> 1900</span>    idx_retbase = <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a8c8653fcd951809042c23c42e534c421">duk_get_top</a>(ctx) - num_stack_args;  <span class="comment">/* Note: not a valid stack index if num_stack_args == 0 */</span></div>
<div class="line"><span class="lineno"> 1901</span> </div>
<div class="line"><span class="lineno"> 1902</span>    <span class="comment">/* Note: cannot portably debug print a function pointer, hence &#39;func&#39; not printed! */</span></div>
<div class="line"><span class="lineno"> 1903</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a6c3a2adb6e09294c7e65f69821e5e81a">DUK_DD</a>(<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#aa66ca9adc2b4187c5d549a9b117b03d3">DUK_DDPRINT</a>(<span class="stringliteral">&quot;duk_handle_safe_call: thr=%p, num_stack_args=%ld, num_stack_rets=%ld, &quot;</span></div>
<div class="line"><span class="lineno"> 1904</span>                       <span class="stringliteral">&quot;valstack_top=%ld, idx_retbase=%ld, rec_depth=%ld/%ld, &quot;</span></div>
<div class="line"><span class="lineno"> 1905</span>                       <span class="stringliteral">&quot;entry_valstack_bottom_index=%ld, entry_callstack_top=%ld, entry_catchstack_top=%ld, &quot;</span></div>
<div class="line"><span class="lineno"> 1906</span>                       <span class="stringliteral">&quot;entry_call_recursion_depth=%ld, entry_curr_thread=%p, entry_thread_state=%ld&quot;</span>,</div>
<div class="line"><span class="lineno"> 1907</span>                       (<span class="keywordtype">void</span> *) thr,</div>
<div class="line"><span class="lineno"> 1908</span>                       (<span class="keywordtype">long</span>) num_stack_args,</div>
<div class="line"><span class="lineno"> 1909</span>                       (<span class="keywordtype">long</span>) num_stack_rets,</div>
<div class="line"><span class="lineno"> 1910</span>                       (<span class="keywordtype">long</span>) <a class="code hl_function" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a8c8653fcd951809042c23c42e534c421">duk_get_top</a>(ctx),</div>
<div class="line"><span class="lineno"> 1911</span>                       (<span class="keywordtype">long</span>) idx_retbase,</div>
<div class="line"><span class="lineno"> 1912</span>                       (<span class="keywordtype">long</span>) thr-&gt;heap-&gt;call_recursion_depth,</div>
<div class="line"><span class="lineno"> 1913</span>                       (<span class="keywordtype">long</span>) thr-&gt;heap-&gt;call_recursion_limit,</div>
<div class="line"><span class="lineno"> 1914</span>                       (<span class="keywordtype">long</span>) entry_valstack_bottom_index,</div>
<div class="line"><span class="lineno"> 1915</span>                       (<span class="keywordtype">long</span>) entry_callstack_top,</div>
<div class="line"><span class="lineno"> 1916</span>                       (<span class="keywordtype">long</span>) entry_catchstack_top,</div>
<div class="line"><span class="lineno"> 1917</span>                       (<span class="keywordtype">long</span>) entry_call_recursion_depth,</div>
<div class="line"><span class="lineno"> 1918</span>                       (<span class="keywordtype">void</span> *) entry_curr_thread,</div>
<div class="line"><span class="lineno"> 1919</span>                       (<span class="keywordtype">long</span>) entry_thread_state));</div>
<div class="line"><span class="lineno"> 1920</span> </div>
<div class="line"><span class="lineno"> 1921</span>    <span class="keywordflow">if</span> (idx_retbase &lt; 0) {</div>
<div class="line"><span class="lineno"> 1922</span>        <span class="comment">/* Since stack indices are not reliable, we can&#39;t do anything useful</span></div>
<div class="line"><span class="lineno"> 1923</span><span class="comment">         * here.  Invoke the existing setjmp catcher, or if it doesn&#39;t exist,</span></div>
<div class="line"><span class="lineno"> 1924</span><span class="comment">         * call the fatal error handler.</span></div>
<div class="line"><span class="lineno"> 1925</span><span class="comment">         */</span></div>
<div class="line"><span class="lineno"> 1926</span> </div>
<div class="line"><span class="lineno"> 1927</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a5d7ecc05e08a0af8396793c7d6d9d916">DUK_ERROR_API</a>(thr, <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a2ff85cd89ea1baf8ab0f8bb7e010d9a5">DUK_STR_INVALID_CALL_ARGS</a>);</div>
<div class="line"><span class="lineno"> 1928</span>    }</div>
<div class="line"><span class="lineno"> 1929</span> </div>
<div class="line"><span class="lineno"> 1930</span>    <span class="comment">/* setjmp catchpoint setup */</span></div>
<div class="line"><span class="lineno"> 1931</span> </div>
<div class="line"><span class="lineno"> 1932</span>    old_jmpbuf_ptr = thr-&gt;heap-&gt;lj.jmpbuf_ptr;</div>
<div class="line"><span class="lineno"> 1933</span>    thr-&gt;heap-&gt;lj.jmpbuf_ptr = &amp;our_jmpbuf;</div>
<div class="line"><span class="lineno"> 1934</span> </div>
<div class="line"><span class="lineno"> 1935</span><span class="preprocessor">#if defined(DUK_USE_CPP_EXCEPTIONS)</span></div>
<div class="line"><span class="lineno"> 1936</span>    <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno"> 1937</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno"> 1938</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(thr-&gt;heap-&gt;lj.jmpbuf_ptr == &amp;our_jmpbuf);</div>
<div class="line"><span class="lineno"> 1939</span>    <span class="keywordflow">if</span> (<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a16d8b2e4e6566e43c4236e756d22708c">DUK_SETJMP</a>(our_jmpbuf.<a class="code hl_variable" href="structduk__jmpbuf.html#ad11371f3d85f3ca95db9d85285ea532f">jb</a>) == 0) {</div>
<div class="line"><span class="lineno"> 1940</span>        <span class="comment">/* Success path. */</span></div>
<div class="line"><span class="lineno"> 1941</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1942</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a2db20d2d3b36d8491ed171cf503488bb">DUK_DDD</a>(<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#aa6e5d41ceaba6832e5ede737f0a35fb9">DUK_DDDPRINT</a>(<span class="stringliteral">&quot;safe_call setjmp catchpoint setup complete&quot;</span>));</div>
<div class="line"><span class="lineno"> 1943</span> </div>
<div class="line"><span class="lineno"> 1944</span>        <a class="code hl_function" href="#ad89d6a1dfcd3eeaa30276a032d922f93">duk__handle_safe_call_inner</a>(thr,</div>
<div class="line"><span class="lineno"> 1945</span>                                    func,</div>
<div class="line"><span class="lineno"> 1946</span>                                    idx_retbase,</div>
<div class="line"><span class="lineno"> 1947</span>                                    num_stack_rets,</div>
<div class="line"><span class="lineno"> 1948</span>                                    entry_valstack_bottom_index,</div>
<div class="line"><span class="lineno"> 1949</span>                                    entry_callstack_top,</div>
<div class="line"><span class="lineno"> 1950</span>                                    entry_catchstack_top);</div>
<div class="line"><span class="lineno"> 1951</span> </div>
<div class="line"><span class="lineno"> 1952</span>        <span class="comment">/* Longjmp state is kept clean in success path */</span></div>
<div class="line"><span class="lineno"> 1953</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(thr-&gt;heap-&gt;lj.type == <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a6af5993d9334f7a01bbc1219671ca5ea">DUK_LJ_TYPE_UNKNOWN</a>);</div>
<div class="line"><span class="lineno"> 1954</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(thr-&gt;heap-&gt;lj.iserror == 0);</div>
<div class="line"><span class="lineno"> 1955</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a3a3a2905176249b3cb6415b5ae814b31">DUK_TVAL_IS_UNDEFINED</a>(&amp;thr-&gt;heap-&gt;lj.value1));</div>
<div class="line"><span class="lineno"> 1956</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a3a3a2905176249b3cb6415b5ae814b31">DUK_TVAL_IS_UNDEFINED</a>(&amp;thr-&gt;heap-&gt;lj.value2));</div>
<div class="line"><span class="lineno"> 1957</span> </div>
<div class="line"><span class="lineno"> 1958</span>        <span class="comment">/* Note: either pointer may be NULL (at entry), so don&#39;t assert */</span></div>
<div class="line"><span class="lineno"> 1959</span>        thr-&gt;heap-&gt;lj.jmpbuf_ptr = old_jmpbuf_ptr;</div>
<div class="line"><span class="lineno"> 1960</span> </div>
<div class="line"><span class="lineno"> 1961</span>        retval = <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8h.html#a7123906cbc5b26f0933e2d473383461a">DUK_EXEC_SUCCESS</a>;</div>
<div class="line"><span class="lineno"> 1962</span><span class="preprocessor">#if defined(DUK_USE_CPP_EXCEPTIONS)</span></div>
<div class="line"><span class="lineno"> 1963</span>    } <span class="keywordflow">catch</span> (duk_internal_exception &amp;exc) {</div>
<div class="line"><span class="lineno"> 1964</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a9170138f330dbcaabfae9d2c59cc9684">DUK_UNREF</a>(exc);</div>
<div class="line"><span class="lineno"> 1965</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno"> 1966</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1967</span>        <span class="comment">/* Error path. */</span></div>
<div class="line"><span class="lineno"> 1968</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1969</span>        <a class="code hl_function" href="#a64be23b7667a71988e004d51b0bc692f">duk__handle_safe_call_error</a>(thr,</div>
<div class="line"><span class="lineno"> 1970</span>                                    idx_retbase,</div>
<div class="line"><span class="lineno"> 1971</span>                                    num_stack_rets,</div>
<div class="line"><span class="lineno"> 1972</span>                                    entry_valstack_bottom_index,</div>
<div class="line"><span class="lineno"> 1973</span>                                    entry_callstack_top,</div>
<div class="line"><span class="lineno"> 1974</span>                                    entry_catchstack_top,</div>
<div class="line"><span class="lineno"> 1975</span>                                    old_jmpbuf_ptr);</div>
<div class="line"><span class="lineno"> 1976</span> </div>
<div class="line"><span class="lineno"> 1977</span>        <span class="comment">/* Longjmp state is cleaned up by error handling */</span></div>
<div class="line"><span class="lineno"> 1978</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(thr-&gt;heap-&gt;lj.type == <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a6af5993d9334f7a01bbc1219671ca5ea">DUK_LJ_TYPE_UNKNOWN</a>);</div>
<div class="line"><span class="lineno"> 1979</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(thr-&gt;heap-&gt;lj.iserror == 0);</div>
<div class="line"><span class="lineno"> 1980</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a3a3a2905176249b3cb6415b5ae814b31">DUK_TVAL_IS_UNDEFINED</a>(&amp;thr-&gt;heap-&gt;lj.value1));</div>
<div class="line"><span class="lineno"> 1981</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a3a3a2905176249b3cb6415b5ae814b31">DUK_TVAL_IS_UNDEFINED</a>(&amp;thr-&gt;heap-&gt;lj.value2));</div>
<div class="line"><span class="lineno"> 1982</span> </div>
<div class="line"><span class="lineno"> 1983</span>        retval = <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8h.html#ad03594743a742c4d13f298f7bebea22c">DUK_EXEC_ERROR</a>;</div>
<div class="line"><span class="lineno"> 1984</span>    }</div>
<div class="line"><span class="lineno"> 1985</span><span class="preprocessor">#if defined(DUK_USE_CPP_EXCEPTIONS)</span></div>
<div class="line"><span class="lineno"> 1986</span>    <span class="keywordflow">catch</span> (std::exception &amp;exc) {</div>
<div class="line"><span class="lineno"> 1987</span>        <span class="keyword">const</span> <span class="keywordtype">char</span> *what = exc.what();</div>
<div class="line"><span class="lineno"> 1988</span>        <span class="keywordflow">if</span> (!what) {</div>
<div class="line"><span class="lineno"> 1989</span>            what = <span class="stringliteral">&quot;unknown&quot;</span>;</div>
<div class="line"><span class="lineno"> 1990</span>        }</div>
<div class="line"><span class="lineno"> 1991</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a9e1528b8eb0a41bc4b37a09a77961e6c">DUK_D</a>(<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a50dbac8614f67a4a6d575791664ebc07">DUK_DPRINT</a>(<span class="stringliteral">&quot;unexpected c++ std::exception (perhaps thrown by user code)&quot;</span>));</div>
<div class="line"><span class="lineno"> 1992</span>        <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno"> 1993</span>            <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#af27bb9bfb183631e8c068865a8270012">DUK_ERROR_FMT1</a>(thr, <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8h.html#a7d71ae54be4b37d9b6d1141a51636a38">DUK_ERR_API_ERROR</a>, <span class="stringliteral">&quot;caught invalid c++ std::exception &#39;%s&#39; (perhaps thrown by user code)&quot;</span>, what);</div>
<div class="line"><span class="lineno"> 1994</span>        } <span class="keywordflow">catch</span> (duk_internal_exception exc) {</div>
<div class="line"><span class="lineno"> 1995</span>            <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a9e1528b8eb0a41bc4b37a09a77961e6c">DUK_D</a>(<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a50dbac8614f67a4a6d575791664ebc07">DUK_DPRINT</a>(<span class="stringliteral">&quot;caught api error thrown from unexpected c++ std::exception&quot;</span>));</div>
<div class="line"><span class="lineno"> 1996</span>            <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a9170138f330dbcaabfae9d2c59cc9684">DUK_UNREF</a>(exc);</div>
<div class="line"><span class="lineno"> 1997</span>            <a class="code hl_function" href="#a64be23b7667a71988e004d51b0bc692f">duk__handle_safe_call_error</a>(thr,</div>
<div class="line"><span class="lineno"> 1998</span>                                        idx_retbase,</div>
<div class="line"><span class="lineno"> 1999</span>                                        num_stack_rets,</div>
<div class="line"><span class="lineno"> 2000</span>                                        entry_valstack_bottom_index,</div>
<div class="line"><span class="lineno"> 2001</span>                                        entry_callstack_top,</div>
<div class="line"><span class="lineno"> 2002</span>                                        entry_catchstack_top,</div>
<div class="line"><span class="lineno"> 2003</span>                                        old_jmpbuf_ptr);</div>
<div class="line"><span class="lineno"> 2004</span>            retval = <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8h.html#ad03594743a742c4d13f298f7bebea22c">DUK_EXEC_ERROR</a>;</div>
<div class="line"><span class="lineno"> 2005</span>        }</div>
<div class="line"><span class="lineno"> 2006</span>    } <span class="keywordflow">catch</span> (...) {</div>
<div class="line"><span class="lineno"> 2007</span>        <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a9e1528b8eb0a41bc4b37a09a77961e6c">DUK_D</a>(<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a50dbac8614f67a4a6d575791664ebc07">DUK_DPRINT</a>(<span class="stringliteral">&quot;unexpected c++ exception (perhaps thrown by user code)&quot;</span>));</div>
<div class="line"><span class="lineno"> 2008</span>        <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno"> 2009</span>            <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a5d7ecc05e08a0af8396793c7d6d9d916">DUK_ERROR_API</a>(thr, <span class="stringliteral">&quot;caught invalid c++ exception (perhaps thrown by user code)&quot;</span>);</div>
<div class="line"><span class="lineno"> 2010</span>        } <span class="keywordflow">catch</span> (duk_internal_exception exc) {</div>
<div class="line"><span class="lineno"> 2011</span>            <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a9e1528b8eb0a41bc4b37a09a77961e6c">DUK_D</a>(<a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a50dbac8614f67a4a6d575791664ebc07">DUK_DPRINT</a>(<span class="stringliteral">&quot;caught api error thrown from unexpected c++ exception&quot;</span>));</div>
<div class="line"><span class="lineno"> 2012</span>            <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duk__config_8h.html#a9170138f330dbcaabfae9d2c59cc9684">DUK_UNREF</a>(exc);</div>
<div class="line"><span class="lineno"> 2013</span>            <a class="code hl_function" href="#a64be23b7667a71988e004d51b0bc692f">duk__handle_safe_call_error</a>(thr,</div>
<div class="line"><span class="lineno"> 2014</span>                                        idx_retbase,</div>
<div class="line"><span class="lineno"> 2015</span>                                        num_stack_rets,</div>
<div class="line"><span class="lineno"> 2016</span>                                        entry_valstack_bottom_index,</div>
<div class="line"><span class="lineno"> 2017</span>                                        entry_callstack_top,</div>
<div class="line"><span class="lineno"> 2018</span>                                        entry_catchstack_top,</div>
<div class="line"><span class="lineno"> 2019</span>                                        old_jmpbuf_ptr);</div>
<div class="line"><span class="lineno"> 2020</span>            retval = <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8h.html#ad03594743a742c4d13f298f7bebea22c">DUK_EXEC_ERROR</a>;</div>
<div class="line"><span class="lineno"> 2021</span>        }</div>
<div class="line"><span class="lineno"> 2022</span>    }</div>
<div class="line"><span class="lineno"> 2023</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 2024</span> </div>
<div class="line"><span class="lineno"> 2025</span>    <a class="code hl_define" href="duktape-1_85_82_2src-noline_2duktape_8c.html#a52bc112231cf556000de414bca74c712">DUK_ASSERT</a>(thr-&gt;heap-&gt;lj.jmpbuf_ptr == old_jmpbuf_ptr);  <span class="comment">/* success/error path both do this */</span></div>
<div class="line"><span class="lineno"> 2026</span> </div>
<div class="line"><span class="lineno"> 2027</span>    <a class="code hl_function" href="#a76056ac76a6e7dee82dbff39c88a3213">duk__handle_safe_call_shared</a>(thr,</div>
<div class="line"><span class="lineno"> 2028</span>                                 idx_retbase,</div>
<div class="line"><span class="lineno"> 2029</span>                                 num_stack_rets,</div>
<div class="line"><span class="lineno"> 2030</span>                                 entry_call_recursion_depth,</div>
<div class="line"><span class="lineno"> 2031</span>                                 entry_curr_thread,</div>
<div class="line"><span class="lineno"> 2032</span>                                 entry_thread_state,</div>
<div class="line"><span class="lineno"> 2033</span>                                 entry_ptr_curr_pc);</div>
<div class="line"><span class="lineno"> 2034</span> </div>
<div class="line"><span class="lineno"> 2035</span>    <span class="keywordflow">return</span> retval;</div>
<div class="line"><span class="lineno"> 2036</span>}</div>
<div class="ttc" id="aduktape-1_85_82_2src-separate_2duk__js__call_8c_html_a64be23b7667a71988e004d51b0bc692f"><div class="ttname"><a href="#a64be23b7667a71988e004d51b0bc692f">duk__handle_safe_call_error</a></div><div class="ttdeci">DUK_LOCAL void duk__handle_safe_call_error(duk_hthread *thr, duk_idx_t idx_retbase, duk_idx_t num_stack_rets, duk_size_t entry_valstack_bottom_index, duk_size_t entry_callstack_top, duk_size_t entry_catchstack_top, duk_jmpbuf *old_jmpbuf_ptr)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-separate_2duk__js__call_8c_source.html#l02147">duktape-1.5.2/src-separate/duk_js_call.c:2147</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-separate_2duk__js__call_8c_html_a76056ac76a6e7dee82dbff39c88a3213"><div class="ttname"><a href="#a76056ac76a6e7dee82dbff39c88a3213">duk__handle_safe_call_shared</a></div><div class="ttdeci">DUK_LOCAL void duk__handle_safe_call_shared(duk_hthread *thr, duk_idx_t idx_retbase, duk_idx_t num_stack_rets, duk_int_t entry_call_recursion_depth, duk_hthread *entry_curr_thread, duk_uint_fast8_t entry_thread_state, duk_instr_t **entry_ptr_curr_pc)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-separate_2duk__js__call_8c_source.html#l02218">duktape-1.5.2/src-separate/duk_js_call.c:2218</a></div></div>
<div class="ttc" id="aduktape-1_85_82_2src-separate_2duk__js__call_8c_html_ad89d6a1dfcd3eeaa30276a032d922f93"><div class="ttname"><a href="#ad89d6a1dfcd3eeaa30276a032d922f93">duk__handle_safe_call_inner</a></div><div class="ttdeci">DUK_LOCAL void duk__handle_safe_call_inner(duk_hthread *thr, duk_safe_call_function func, duk_idx_t idx_retbase, duk_idx_t num_stack_rets, duk_size_t entry_valstack_bottom_index, duk_size_t entry_callstack_top, duk_size_t entry_catchstack_top)</div><div class="ttdef"><b>Definition</b> <a href="duktape-1_85_82_2src-separate_2duk__js__call_8c_source.html#l02038">duktape-1.5.2/src-separate/duk_js_call.c:2038</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07050">duk_heap::call_recursion_depth</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07051">duk_heap::call_recursion_limit</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06237">duk_hthread::callstack_top</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06243">duk_hthread::catchstack_top</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07044">duk_heap::curr_thread</a>, <a class="el" href="duktape-1_85_82_2src-separate_2duk__js__call_8c_source.html#l02147">duk__handle_safe_call_error()</a>, <a class="el" href="duktape-1_85_82_2src-separate_2duk__js__call_8c_source.html#l02038">duk__handle_safe_call_inner()</a>, <a class="el" href="duktape-1_85_82_2src-separate_2duk__js__call_8c_source.html#l02218">duk__handle_safe_call_shared()</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07755">DUK_ASSERT</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07495">DUK_D</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07496">DUK_DD</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07497">DUK_DDD</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07509">DUK_DDDPRINT</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07508">DUK_DDPRINT</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07507">DUK_DPRINT</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8h_source.html#l00336">DUK_ERR_API_ERROR</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07869">DUK_ERROR_API</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07628">DUK_ERROR_FMT1</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8h_source.html#l00366">DUK_EXEC_ERROR</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8h_source.html#l00365">DUK_EXEC_SUCCESS</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l15204">duk_get_top()</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06701">DUK_LJ_TYPE_UNKNOWN</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h_source.html#l01917">DUK_SETJMP</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l02279">DUK_STR_INVALID_CALL_ARGS</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l00793">DUK_TVAL_IS_UNDEFINED</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duk__config_8h_source.html#l02494">DUK_UNREF</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06202">duk_hthread::heap</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06950">duk_ljstate::iserror</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l00206">duk_jmpbuf::jb</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06948">duk_ljstate::jmpbuf_ptr</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l07035">duk_heap::lj</a>, <a class="el" href="gmacros_8h_source.html#l00924">NULL</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06199">duk_hthread::ptr_curr_pc</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06208">duk_hthread::state</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06949">duk_ljstate::type</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06226">duk_hthread::valstack</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06228">duk_hthread::valstack_bottom</a>, <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06951">duk_ljstate::value1</a>, and <a class="el" href="duktape-1_85_82_2src-noline_2duktape_8c_source.html#l06952">duk_ljstate::value2</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_1e03628437b642463b7b6eb98fac43e1.html">vendor</a></li><li class="navelem"><a class="el" href="dir_84591d08937a968859b7757c3b203700.html">civetweb</a></li><li class="navelem"><a class="el" href="dir_34c971402fa1824d9c500953fc75cb63.html">third_party</a></li><li class="navelem"><a class="el" href="dir_463c33e0ae291ddbfec061ad19861570.html">duktape-1.5.2</a></li><li class="navelem"><a class="el" href="dir_e6ae68e9a9f72807e14f61863ae5cc0a.html">src-separate</a></li><li class="navelem"><a class="el" href="duktape-1_85_82_2src-separate_2duk__js__call_8c.html">duk_js_call.c</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0 </li>
  </ul>
</div>
</body>
</html>
